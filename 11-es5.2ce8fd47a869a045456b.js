function _get(t,i,e){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,i,e){var n=_superPropBase(t,i);if(n){var o=Object.getOwnPropertyDescriptor(n,i);return o.get?o.get.call(e):o.value}})(t,i,e||t)}function _superPropBase(t,i){for(;!Object.prototype.hasOwnProperty.call(t,i)&&null!==(t=_getPrototypeOf(t)););return t}function _createSuper(t){return function(){var i,e=_getPrototypeOf(t);if(_isNativeReflectConstruct()){var n=_getPrototypeOf(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(t,i){return!i||"object"!=typeof i&&"function"!=typeof i?_assertThisInitialized(t):i}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&_setPrototypeOf(t,i)}function _setPrototypeOf(t,i){return(_setPrototypeOf=Object.setPrototypeOf||function(t,i){return t.__proto__=i,t})(t,i)}function _slicedToArray(t,i){return _arrayWithHoles(t)||_iterableToArrayLimit(t,i)||_unsupportedIterableToArray(t,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,i){if(t){if("string"==typeof t)return _arrayLikeToArray(t,i);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(e):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,i):void 0}}function _arrayLikeToArray(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=new Array(i);e<i;e++)n[e]=t[e];return n}function _iterableToArrayLimit(t,i){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var e=[],n=!0,o=!1,c=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(e.push(a.value),!i||e.length!==i);n=!0);}catch(r){o=!0,c=r}finally{try{n||null==s.return||s.return()}finally{if(o)throw c}}return e}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,i,e){return i&&_defineProperties(t.prototype,i),e&&_defineProperties(t,e),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{fx87:function(t,i,e){"use strict";e.r(i);var n,o=e("quSY"),c=e("itXk"),a=e("pLZG"),s=e("vkgz"),r=e("lJxs"),u=e("eIep"),l=e("a+Vh"),d=e("SLWe"),p=e("eApZ"),b=e("v3IF"),f=e("bU05"),m=e("OMSe"),v=e("9H/N"),_=e("wd/R"),h=e("wxx3"),S=e("8Y7J"),R=e("AytR"),g=e("JIr8"),y=e("LRne"),C=e("3Ym9"),I=e("IheW"),k=e("v98y"),A=((n=function(){function t(i,e){_classCallCheck(this,t),this.http=i,this.errorHandlerService=e}return _createClass(t,[{key:"getImpositions",value:function(t){var i=this,e="".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.getImpositions),n={acuerdo:(+t).toString(),estadoImposicion:"TODAS",codigoEntidad:"1508",subacuerdo:"0"};return this.http.get(e,{params:n}).pipe(Object(r.a)((function(t){var i,e,n,o;return null===(o=null===(n=null===(e=null===(i=t)||void 0===i?void 0:i.data[0])||void 0===e?void 0:e.EE_O_ConsultaImposicionesBE)||void 0===n?void 0:n.Respuesta)||void 0===o?void 0:o.ListaImposicionesCliente})),Object(g.a)((function(t){return t.errorCode===C.a.IMP_NOT_FOUND?Object(y.a)([]):i.errorHandlerService.redirectErrorPage(t)})))}},{key:"createImposition",value:function(t){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.createImposition),t)}},{key:"refundImposition",value:function(t){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.refund),t)}},{key:"generateCreateImpositionOTP",value:function(t){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.createImpositionOTP),t)}},{key:"generateRefundImpositionOTP",value:function(t){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.refundOTP),t)}},{key:"getPdfImposition",value:function(t,i){return this.http.get("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.getPdfImposition),{params:{acuerdo:t,subacuerdo:i}}).pipe(Object(r.a)((function(t){var i,e;return null===(e=null===(i=t.data)||void 0===i?void 0:i[0])||void 0===e?void 0:e.strMessage})))}},{key:"getRequiredDoc",value:function(){return this.http.get("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.getRequiredDoc))}}]),t}()).\u0275fac=function(t){return new(t||n)(S.Wb(I.b),S.Wb(k.a))},n.\u0275prov=S.Ib({token:n,factory:n.\u0275fac,providedIn:"root"}),n),E=e("vHNk"),w=e("2PZR"),O=e("LqlI"),P=e("iInd"),j=e("Gy/1"),M=e("9yxR"),D=e("SVse"),T=e("0rpK"),F=e("YonX"),G=e("TSSN");function N(t,i){if(1&t&&(S.Sb(0,"div",7),S.Sb(1,"p"),S.Ec(2),S.dc(3,"translate"),S.Rb(),S.Sb(4,"p"),S.Ec(5),S.Rb(),S.Rb()),2&t){var e=S.cc(2);S.Ab(2),S.Fc(S.ec(3,2,"deposit_imposition_detail_number")),S.Ab(3),S.Fc(null==e.imposition?null:e.imposition.subacuerdo)}}function B(t,i){if(1&t&&(S.Sb(0,"div",7),S.Sb(1,"p"),S.Ec(2),S.dc(3,"translate"),S.Rb(),S.Sb(4,"p"),S.Ec(5),S.dc(6,"date"),S.Rb(),S.Rb()),2&t){var e=S.cc(2);S.Ab(2),S.Fc(S.ec(3,2,"deposit_imposition_detail_expiration")),S.Ab(3),S.Fc(S.fc(6,4,null==e.imposition?null:e.imposition.fechaVencimiento,"dd/MM/yyyy"))}}function x(t,i){if(1&t&&(S.Sb(0,"div",7),S.Sb(1,"p"),S.Ec(2),S.dc(3,"translate"),S.Rb(),S.Sb(4,"p"),S.Ec(5),S.dc(6,"number"),S.Rb(),S.Rb()),2&t){var e=S.cc(2);S.Ab(2),S.Fc(S.ec(3,2,"deposit_imposition_detail_interest")),S.Ab(3),S.Gc("",S.fc(6,4,null==e.imposition?null:e.imposition.tin,"1.2-4")," %")}}function L(t,i){if(1&t&&(S.Sb(0,"div",7),S.Sb(1,"p"),S.Ec(2),S.dc(3,"translate"),S.Rb(),S.Sb(4,"p"),S.Ec(5),S.dc(6,"date"),S.Rb(),S.Rb()),2&t){var e=S.cc(2);S.Ab(2),S.Fc(S.ec(3,2,"deposit_imposition_detail_liquidation")),S.Ab(3),S.Fc(S.fc(6,4,null==e.imposition?null:e.imposition.fechaProximaLiquidacion,"dd/MM/yyyy"))}}function $(t,i){if(1&t){var e=S.Tb();S.Sb(0,"button",9),S.ac("click",(function(){return S.wc(e),S.cc(2).refundImposition()})),S.Ec(1),S.dc(2,"translate"),S.Rb()}2&t&&(S.Ab(1),S.Gc(" ",S.ec(2,1,"deposit_cancel_imposition_button")," "))}function H(t,i){if(1&t){var e=S.Tb();S.Sb(0,"button",9),S.ac("click",(function(){S.wc(e);var t=S.cc(2);return t.showReceipt.emit(t.imposition)})),S.Ec(1),S.dc(2,"translate"),S.Rb()}2&t&&(S.Ab(1),S.Gc(" ",S.ec(2,1,"deposit_show_imposition_receipt_button")," "))}function q(t,i){if(1&t&&(S.Sb(0,"div",5),S.Cc(1,N,6,4,"div",6),S.Cc(2,B,7,7,"div",6),S.Cc(3,x,7,7,"div",6),S.Cc(4,L,7,7,"div",6),S.Sb(5,"div",7),S.Cc(6,$,3,3,"button",8),S.Cc(7,H,3,3,"button",8),S.Rb(),S.Rb()),2&t){var e=S.cc();S.Ab(1),S.jc("ngIf",null==e.imposition?null:e.imposition.subacuerdo),S.Ab(1),S.jc("ngIf",null==e.imposition?null:e.imposition.fechaVencimiento),S.Ab(1),S.jc("ngIf",null==e.imposition?null:e.imposition.tin),S.Ab(1),S.jc("ngIf",null==e.imposition?null:e.imposition.fechaProximaLiquidacion),S.Ab(2),S.jc("ngIf",e.isActive&&e.canRefundImposition),S.Ab(1),S.jc("ngIf",e.isActive)}}var U,z=function(t){return{term:t}},Q=((U=function(){function t(){_classCallCheck(this,t),this.askRefundImposition=new S.n,this.waitToRefundImposition=new S.n,this.showReceipt=new S.n,this.showDetails=!1}return _createClass(t,[{key:"toggleDetails",value:function(){this.showDetails=!this.showDetails}},{key:"refundImposition",value:function(){_().isSame(_(this.imposition.fechaValor),"day")?this.waitToRefundImposition.emit():this.askRefundImposition.emit(this.imposition)}},{key:"canRefundImposition",get:function(){var t=_(this.imposition.fechaVencimiento),i=this.clientType===h.a.Employee;return i||!i&&_().isSameOrAfter(t)}},{key:"isActive",get:function(){var t;return(null===(t=this.imposition)||void 0===t?void 0:t.descripcionEstadoImposicion)===d.d.Activo}}]),t}()).\u0275fac=function(t){return new(t||U)},U.\u0275cmp=S.Gb({type:U,selectors:[["app-imposition-item"]],inputs:{imposition:"imposition",clientType:"clientType"},outputs:{askRefundImposition:"askRefundImposition",waitToRefundImposition:"waitToRefundImposition",showReceipt:"showReceipt"},decls:19,vars:20,consts:[[1,"table__body__row",3,"ngClass","click"],[1,"table__body__title"],[1,"table__body__title__group"],[1,"table__body__title__group__col"],["class","table__body__detail",4,"ngIf"],[1,"table__body__detail"],["class","table__body__detail__row",4,"ngIf"],[1,"table__body__detail__row"],[3,"click",4,"ngIf"],[3,"click"]],template:function(t,i){1&t&&(S.Sb(0,"div",0),S.ac("click",(function(){return i.toggleDetails()})),S.Sb(1,"div",1),S.Sb(2,"div",2),S.Sb(3,"p",3),S.Ec(4),S.dc(5,"date"),S.Rb(),S.Rb(),S.Sb(6,"div",2),S.Sb(7,"p",3),S.Ec(8),S.dc(9,"translate"),S.dc(10,"lowercase"),S.Rb(),S.Sb(11,"p",3),S.Ec(12),S.dc(13,"translate"),S.Rb(),S.Rb(),S.Sb(14,"div",2),S.Sb(15,"p",3),S.Ec(16),S.dc(17,"currency"),S.Rb(),S.Rb(),S.Rb(),S.Cc(18,q,8,6,"div",4),S.Rb()),2&t&&(S.jc("ngClass",i.isActive?"active":"inactive"),S.Ab(4),S.Gc(" ",S.fc(5,6,null==i.imposition?null:i.imposition.fechaValor,"dd/MM/yyyy")," "),S.Ab(4),S.Gc(" ",S.ec(9,9,S.ec(10,11,"deposit_imposition_detail_status_"+(null==i.imposition?null:i.imposition.descripcionEstadoImposicion)))," "),S.Ab(4),S.Gc(" ",S.fc(13,13,"deposit_imposition_detail_term_web",S.nc(18,z,(null==i.imposition?null:i.imposition.duracion)||0))," "),S.Ab(4),S.Gc(" ",S.ec(17,16,null==i.imposition?null:i.imposition.importeNominal)," "),S.Ab(2),S.jc("ngIf",i.showDetails))},directives:[D.n,D.p],pipes:[D.f,G.d,D.m,D.d,D.g],styles:[""],changeDetection:0}),U),W=e("PQaN"),V=e("d2bA"),J=e("zcjR"),K=e("tepA"),X=e("nxmR"),Y=e("kktJ"),Z=["refundOtpModal"],tt=["confirmRefundModal"],it=["confirmCancelDepositModal"],et=["invalidCancelationModal"],nt=["successCancelDeposit"];function ot(t,i){if(1&t){var e=S.Tb();S.Sb(0,"button",30),S.ac("click",(function(){S.wc(e);var t=S.cc(2).ngIf;return S.cc().askCancelDeposit(null==t?null:t.impositions)})),S.Ec(1),S.dc(2,"translate"),S.Rb()}2&t&&(S.Ab(1),S.Gc(" ",S.ec(2,1,"deposit_cancel_deposit")," "))}function ct(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-imposition-item",36),S.ac("askRefundImposition",(function(t){return S.wc(e),S.cc(5).askRefundImposition(t)}))("waitToRefundImposition",(function(){S.wc(e),S.cc(4);var t=S.tc(12);return S.cc().openModal(t)}))("showReceipt",(function(t){S.wc(e);var i=S.cc(4).ngIf;return S.cc().onShowReceipt(null==i?null:i.deposit,t)})),S.Rb()}if(2&t){var n=i.$implicit,o=S.cc(4).ngIf;S.jc("imposition",n)("clientType",null==o?null:null==o.currentCustomer?null:null==o.currentCustomer.DatosPersonales?null:o.currentCustomer.DatosPersonales.clientType)}}function at(t,i){if(1&t&&(S.Sb(0,"div",33),S.Sb(1,"p",34),S.Ec(2),S.dc(3,"date"),S.Rb(),S.Cc(4,ct,1,2,"app-imposition-item",35),S.Rb()),2&t){var e=i.$implicit;S.Ab(2),S.Gc(" ",S.fc(3,2,e.key,"dd/MM/yyyy")," "),S.Ab(2),S.jc("ngForOf",e.value)}}function st(t,i){if(1&t&&(S.Sb(0,"div",31),S.Cc(1,at,5,5,"div",32),S.dc(2,"sortBy"),S.dc(3,"keyvalue"),S.dc(4,"groupBy"),S.Rb()),2&t){var e=S.cc(2).ngIf,n=S.cc();S.Ab(1),S.jc("ngForOf",S.gc(2,2,S.ec(3,6,S.fc(4,8,e.impositions,"fechaValor")),"desc","key"))("ngForTrackBy",n.trackByDates)}}function rt(t,i){1&t&&(S.Sb(0,"div",31),S.Sb(1,"div",37),S.Sb(2,"p",38),S.Ec(3),S.dc(4,"translate"),S.Rb(),S.Rb(),S.Rb()),2&t&&(S.Ab(3),S.Gc(" ",S.ec(4,1,"deposit_empty_impositions_list_message")," "))}function ut(t,i){if(1&t&&(S.Sb(0,"div",15),S.Sb(1,"div",16),S.Sb(2,"div",17),S.Sb(3,"div",18),S.Sb(4,"div",19),S.Sb(5,"h1"),S.Ec(6),S.dc(7,"translate"),S.Rb(),S.Sb(8,"p"),S.Ec(9),S.dc(10,"formatIban"),S.Rb(),S.Rb(),S.Sb(11,"div",19),S.Sb(12,"p"),S.Ec(13),S.dc(14,"translate"),S.Rb(),S.Sb(15,"h1"),S.Ec(16),S.dc(17,"currency"),S.Rb(),S.Rb(),S.Rb(),S.Sb(18,"div",20),S.Sb(19,"button",21),S.Ec(20),S.dc(21,"translate"),S.Rb(),S.Cc(22,ot,3,3,"button",22),S.Rb(),S.Rb(),S.Sb(23,"div",23),S.Sb(24,"div",24),S.Sb(25,"h1"),S.Ec(26),S.dc(27,"currency"),S.Rb(),S.Sb(28,"a",25),S.Ec(29),S.dc(30,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(31,"div",26),S.Sb(32,"div",27),S.Sb(33,"div",28),S.Sb(34,"p"),S.Ec(35),S.dc(36,"translate"),S.Rb(),S.Sb(37,"p"),S.Ec(38),S.dc(39,"translate"),S.Rb(),S.Sb(40,"p"),S.Ec(41),S.dc(42,"translate"),S.Rb(),S.Sb(43,"p"),S.Ec(44),S.dc(45,"translate"),S.Rb(),S.Rb(),S.Cc(46,st,5,11,"div",29),S.Cc(47,rt,5,3,"div",29),S.Rb(),S.Rb(),S.Rb()),2&t){var e=S.cc().ngIf,n=S.cc();S.Ab(6),S.Fc(S.ec(7,14,"deposit_title")),S.Ab(3),S.Fc(S.ec(10,16,null==e.deposit?null:e.deposit.IBAN)),S.Ab(4),S.Fc(S.ec(14,18,"deposit_balance")),S.Ab(3),S.Fc(S.ec(17,20,null==e.deposit?null:e.deposit.Balance)),S.Ab(4),S.Gc(" ",S.ec(21,22,"deposit_new_imposition_title")," "),S.Ab(2),S.jc("ngIf",n.canShowCancelDeposit(null==e?null:e.impositions,null==e?null:null==e.currentCustomer?null:null==e.currentCustomer.DatosPersonales?null:e.currentCustomer.DatosPersonales.clientType)),S.Ab(4),S.Fc(S.ec(27,24,null==e.deposit?null:e.deposit.Balance)),S.Ab(3),S.Fc(S.ec(30,26,"deposit_go_to_asociated_account")),S.Ab(6),S.Fc(S.ec(36,28,"deposit_imposition_date")),S.Ab(3),S.Fc(S.ec(39,30,"deposit_imposition_description")),S.Ab(3),S.Fc(S.ec(42,32,"deposit_imposition_term")),S.Ab(3),S.Fc(S.ec(45,34,"deposit_imposition_amount")),S.Ab(2),S.jc("ngIf",!n.emptyImpositions(e.impositions)),S.Ab(1),S.jc("ngIf",n.emptyImpositions(e.impositions))}}function lt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"button",39),S.ac("click",(function(){S.wc(e);var t=S.cc().ngIf;return S.cc().askCancelDeposit(null==t?null:t.impositions)})),S.Ec(1),S.dc(2,"translate"),S.Rb()}2&t&&(S.Ab(1),S.Gc(" ",S.ec(2,1,"deposit_cancel_deposit")," "))}function dt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-info-modal",40),S.ac("hide",(function(){return S.wc(e),S.cc(2).closeModal()})),S.Rb()}}function pt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-info-modal",41),S.ac("hide",(function(){return S.wc(e),S.cc(2).closeModal()})),S.Rb()}}function bt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-info-modal",42),S.ac("hide",(function(){return S.wc(e),S.cc(2).closeModal()})),S.Rb()}}function ft(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-confirm-modal",43),S.ac("confirm",(function(t){S.wc(e);var i=S.cc().ngIf;return S.cc().onCancelDeposit(t,null==i?null:i.deposit)})),S.Rb()}}function mt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-confirm-modal",44),S.ac("confirm",(function(t){S.wc(e);var i=S.cc().ngIf;return S.cc().confirmRefundImposition(t,i.deposit.Acuerdo)})),S.Rb()}}function vt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-otp-form",45),S.ac("repeat",(function(){S.wc(e);var t=S.cc().ngIf;return S.cc().generateRefundOtp(t.deposit.Acuerdo)}))("send",(function(t){S.wc(e);var i=S.cc().ngIf;return S.cc().refundImposition(t,i.deposit.Acuerdo)}))("hide",(function(){return S.wc(e),S.cc(2).closeModal()})),S.Rb()}if(2&t){var n=S.cc(2);S.jc("invalidCode",n.invalidRefundOtpCode)}}function _t(t,i){if(1&t&&(S.Qb(0),S.Sb(1,"div",1),S.Sb(2,"div",2),S.Cc(3,ut,48,36,"div",3),S.Sb(4,"div",4),S.Nb(5,"app-aside-banner",5),S.Rb(),S.Rb(),S.Rb(),S.Sb(6,"div",6),S.Cc(7,lt,3,3,"button",7),S.Sb(8,"button",8),S.Ec(9),S.dc(10,"translate"),S.Rb(),S.Rb(),S.Cc(11,dt,1,0,"ng-template",null,9,S.Dc),S.Cc(13,pt,1,0,"ng-template",null,10,S.Dc),S.Cc(15,bt,1,0,"ng-template",null,11,S.Dc),S.Cc(17,ft,1,0,"ng-template",null,12,S.Dc),S.Cc(19,mt,1,0,"ng-template",null,13,S.Dc),S.Cc(21,vt,1,1,"ng-template",null,14,S.Dc),S.Pb()),2&t){var e=i.ngIf,n=S.cc();S.Ab(3),S.jc("ngIf",e.globalPosition),S.Ab(1),S.jc("appBannerBackground",n.banners.deposit),S.Ab(1),S.jc("globalPosition",e.globalPosition),S.Ab(2),S.jc("ngIf",n.canShowCancelDeposit(null==e?null:e.impositions,null==e?null:null==e.currentCustomer?null:null==e.currentCustomer.DatosPersonales?null:e.currentCustomer.DatosPersonales.clientType)),S.Ab(2),S.Gc(" ",S.ec(10,5,"deposit_new_imposition_title")," ")}}var ht,St,Rt=((ht=function(){function t(i,e,n,c,a,s,r,u,l,d){_classCallCheck(this,t),this.depositService=i,this.headerService=e,this.globalPositionService=n,this.modalService=c,this.errorHandler=a,this.router=s,this.activatedRoute=r,this.caseService=u,this.accountService=l,this.banners=d,this.state$=this.createStateStream(),this.invalidRefundOtpCode=!1,this.subs=new o.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.headerService.updateTitle("menu_deposits_web"),this.globalPositionService.fetchGlobalPosition()}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe(),this.closeModal()}},{key:"openModal",value:function(t){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(t))}},{key:"closeModal",value:function(){var t;null===(t=this.modalRef)||void 0===t||t.hide()}},{key:"askCancelDeposit",value:function(t){var i,e=null===(i=t)||void 0===i?void 0:i.filter((function(t){return t.descripcionEstadoImposicion===d.d.Activo})).length;this.openModal(0===e?this.confirmCancelDepositModal:this.invalidCancelationModal)}},{key:"onCancelDeposit",value:function(t,i){this.closeModal(),t&&this.cancelDeposit(i)}},{key:"askRefundImposition",value:function(t){this.selectedImposition=t,this.openModal(this.confirmRefundModal)}},{key:"onShowReceipt",value:function(t,i){var e,n,o=this,c="imposition-receipt-".concat(t.Acuerdo,"-").concat(i.subacuerdo,".pdf");this.subs.add(this.depositService.getPdfImposition(null===(e=t)||void 0===e?void 0:e.Acuerdo,null===(n=i)||void 0===n?void 0:n.subacuerdo).pipe(Object(m.a)()).subscribe((function(t){var i=document.createElement("a");i.href=URL.createObjectURL(t),i.download=c,i.click()}),(function(t){o.errorHandler.showError(t)})))}},{key:"confirmRefundImposition",value:function(t,i){this.closeModal(),t&&this.generateRefundOtp(i)}},{key:"generateRefundOtp",value:function(t){var i,e,n=this;this.invalidRefundOtpCode=!1,this.refundOtpId=null,this.subs.add(this.depositService.generateRefundImpositionOTP({depositAgreement:t,impositionAgreement:null===(i=this.selectedImposition)||void 0===i?void 0:i.subacuerdo,nominalAmount:String(parseFloat(null===(e=this.selectedImposition)||void 0===e?void 0:e.importeNominal))}).subscribe((function(t){var i=t.otpId;n.openModal(n.refundOtpModal),n.refundOtpId=i}),(function(t){n.errorHandler.showError(t)})))}},{key:"refundImposition",value:function(t,i){var e,n,o=this;this.subs.add(this.depositService.refundImposition({depositAgreement:i,impositionAgreement:null===(e=this.selectedImposition)||void 0===e?void 0:e.subacuerdo,nominalAmount:null===(n=this.selectedImposition)||void 0===n?void 0:n.importeNominal,otp:{otpId:this.refundOtpId,secretKey:t}}).subscribe((function(){var t;o.closeModal(),o.router.navigate(["./refund-success"],{queryParams:{importeNominal:null===(t=o.selectedImposition)||void 0===t?void 0:t.importeNominal},skipLocationChange:!0,relativeTo:o.activatedRoute})}),(function(t){Object(l.j)(t)?o.invalidRefundOtpCode=!0:(o.closeModal(),o.errorHandler.showError(t))})))}},{key:"onConfirmRefundSuccessModal",value:function(){this.globalPositionService.fetchGlobalPosition(),this.closeModal()}},{key:"trackByDates",value:function(t){return t.date}},{key:"trackByImposition",value:function(t){return t.subacuerdo}},{key:"emptyImpositions",value:function(t){return t&&0===t.length}},{key:"canShowCancelDeposit",value:function(t,i){var e,n=null===(e=t)||void 0===e?void 0:e.map((function(t){return _(t.fechaVencimiento)})),o=_.max(n),c=i===h.a.Employee;return c||!c&&_().isSameOrAfter(o)}},{key:"cancelDeposit",value:function(t){var i,e=this,n=new p.a;n.type=b.a.TOTAL_CANCELLATION_OF_THE_TERM_DEPOSIT,n.recordTypeDeveloperName=f.a.CANCELLATIONS,n.description="Cancelaci\xf3n de dep\xf3sito",n.subject="Cancelaci\xf3n de dep\xf3sito",n.newIBAN=null===(i=t)||void 0===i?void 0:i.IBAN,this.subs.add(this.caseService.createCase({caseList:[n]}).subscribe((function(){e.closeModal(),e.openModal(e.successCancelDepositModal)}),(function(t){e.errorHandler.showError(t)})))}},{key:"createStateStream",value:function(){var t=this,i=this.globalPositionService.globalPosition$.pipe(Object(a.a)((function(t){return!!t})));return Object(c.a)([i,i.pipe(Object(l.e)()).pipe(Object(s.a)((function(i){i||t.router.navigate(["./hire"],{relativeTo:t.activatedRoute})}))),i.pipe(Object(l.d)()),this.createImpositionsStream(),this.accountService.currentCustomer$]).pipe(Object(r.a)((function(t){var i=_slicedToArray(t,5);return{globalPosition:i[0],deposit:i[1],account:i[2],impositions:i[3],currentCustomer:i[4]}})))}},{key:"createImpositionsStream",value:function(){var t=this;return this.globalPositionService.globalPosition$.pipe(Object(l.e)(),Object(a.a)((function(t){var i;return!!(null===(i=t)||void 0===i?void 0:i.Acuerdo)})),Object(u.a)((function(i){var e;return t.depositService.getImpositions(null===(e=i)||void 0===e?void 0:e.Acuerdo)})))}}]),t}()).\u0275fac=function(t){return new(t||ht)(S.Mb(A),S.Mb(E.a),S.Mb(w.a),S.Mb(O.b),S.Mb(k.a),S.Mb(P.d),S.Mb(P.a),S.Mb(j.a),S.Mb(M.a),S.Mb(v.a))},ht.\u0275cmp=S.Gb({type:ht,selectors:[["app-deposit"]],viewQuery:function(t,i){var e;1&t&&(S.Ic(Z,!0),S.Ic(tt,!0),S.Ic(it,!0),S.Ic(et,!0),S.Ic(nt,!0)),2&t&&(S.sc(e=S.bc())&&(i.refundOtpModal=e.first),S.sc(e=S.bc())&&(i.confirmRefundModal=e.first),S.sc(e=S.bc())&&(i.confirmCancelDepositModal=e.first),S.sc(e=S.bc())&&(i.invalidCancelationModal=e.first),S.sc(e=S.bc())&&(i.successCancelDepositModal=e.first))},decls:2,vars:3,consts:[[4,"ngIf"],[1,"max-size","deposit"],[1,"main"],["class","main-col",4,"ngIf"],[1,"aside-col",3,"appBannerBackground"],[3,"globalPosition"],[1,"main__button","group-button"],["type","button","class","btn--secondary",3,"click",4,"ngIf"],["type","button","routerLink","./new-imposition",1,"btn--primary"],["waitToRefundModal",""],["invalidCancelationModal",""],["successCancelDeposit",""],["confirmCancelDepositModal",""],["confirmRefundModal",""],["refundOtpModal",""],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__header__buttons"],["type","button","routerLink","./new-imposition",1,"btn--primary-small"],["type","button","class","btn--terciary-small",3,"click",4,"ngIf"],[1,"main__header__mobile"],[1,"main__header__mobile__col"],["href","javascript:;","routerLink","../../transactions"],[1,"main__body"],[1,"table"],[1,"table__header"],["class","table__body",4,"ngIf"],["type","button",1,"btn--terciary-small",3,"click"],[1,"table__body"],["class","table__body__section",4,"ngFor","ngForOf","ngForTrackBy"],[1,"table__body__section"],[1,"table__body__section__date"],[3,"imposition","clientType","askRefundImposition","waitToRefundImposition","showReceipt",4,"ngFor","ngForOf"],[3,"imposition","clientType","askRefundImposition","waitToRefundImposition","showReceipt"],[1,"table__body__title"],[1,"table__body__title__group__col"],["type","button",1,"btn--secondary",3,"click"],["head","deposit_cancel_imposition_title","description","deposit_cancel_imposition_wait_text","type","warning",3,"hide"],["head","deposit_cancel_title","description","deposit_cancel_subtitle","type","warning",3,"hide"],["head","deposit_cancel_success_title","description","deposit_cancel_success_description","type","success",3,"hide"],["description","deposit_cancel2_subtitle_web",3,"confirm"],["description","deposit_cancel_imposition_text_web",3,"confirm"],[3,"invalidCode","repeat","send","hide"]],template:function(t,i){1&t&&(S.Cc(0,_t,23,7,"ng-container",0),S.dc(1,"async")),2&t&&S.jc("ngIf",S.ec(1,1,i.state$))},directives:[D.p,T.a,F.a,P.e,P.g,D.o,Q,W.a,V.a,J.a],pipes:[D.b,G.d,K.a,D.d,X.a,D.i,Y.a,D.f],encapsulation:2,changeDetection:0}),ht),gt=e("1uah"),yt=e("i9jL"),Ct=((St=function(){function t(i,e,n){_classCallCheck(this,t),this.depositService=i,this.globalPositionService=e,this.dictionaryService=n,this.state$=this.createState(),this.impositionConditions$=this.dictionaryService.getImpositionConditions(),this.subs=new o.a}return _createClass(t,[{key:"initImposition",value:function(t){this.imposition=t}},{key:"fetchGlobalPosition",value:function(){this.globalPositionService.fetchGlobalPosition()}},{key:"generateOtp",value:function(t,i){var e=this;this.referenceOTP=null;this.subs.add(this.state$.pipe(Object(u.a)((function(t){var i,n,o;return o=Object.assign(Object.assign({},e.imposition),{depositAgreement:null===(n=null===(i=t)||void 0===i?void 0:i.deposit)||void 0===n?void 0:n.Acuerdo}),e.depositService.generateCreateImpositionOTP(Object.assign({},o))}))).subscribe((function(i){var n,o=i.otpId;e.referenceOTP=o,null===(n=t)||void 0===n||n()}),(function(t){var e;return null===(e=i)||void 0===e?void 0:e(t)})))}},{key:"createImposition",value:function(t,i,e){var n=this;this.subs.add(this.state$.pipe(Object(u.a)((function(i){var e;return n.depositService.createImposition(Object.assign(Object.assign({},n.imposition),{depositAgreement:null===(e=i)||void 0===e?void 0:e.deposit.Acuerdo,otp:{secretKey:t,otpId:n.referenceOTP}}))}))).subscribe((function(){var t;null===(t=i)||void 0===t||t()}),(function(t){var i;null===(i=e)||void 0===i||i(t)})))}},{key:"destroy",value:function(){this.subs.unsubscribe()}},{key:"createState",value:function(){return Object(gt.a)(this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(l.e)()),this.globalPositionService.globalPosition$.pipe(Object(l.d)())).pipe(Object(r.a)((function(t){var i=_slicedToArray(t,3);return{globalPosition:i[0],deposit:i[1],account:i[2]}})))}}]),t}()).\u0275fac=function(t){return new(t||St)(S.Wb(A),S.Wb(w.a),S.Wb(yt.a))},St.\u0275prov=S.Ib({token:St,factory:St.\u0275fac}),St),It=e("s7LF"),kt=e("dZRt");function At(t){var i,e,n=t.get("impositionCondition"),o=t.get("amount"),c=n.value,a=Object(kt.b)(o.value);return c?(null===(i=c)||void 0===i?void 0:i.maximum)<a?{maxImposition:!0}:(null===(e=c)||void 0===e?void 0:e.minimum)>a?{minImposition:!0}:null:null}var Et=R.a.applications.documents,wt={impositionConditions:"".concat(Et,"/documentacion-legal/condiciones-imposicion-RenaultBank.pdf"),particularConditions:"".concat(Et,"/documentacion-legal/informacion-precontractual-deposito-RenaultBank.pdf")},Ot={impositionConditions:"".concat(Et,"/documentacion-legal/condiciones-imposicion-publico-RenaultBank.pdf"),particularConditions:"".concat(Et,"/documentacion-legal/informacion-precontractual-deposito-publico-RenaultBank.pdf")},Pt=new S.q("EXTERNAL_DOCUMENTS",{providedIn:"root",factory:function(){var t,i;return(null===(i=null===(t=Object(S.T)(M.a).currentCustomer)||void 0===t?void 0:t.DatosPersonales)||void 0===i?void 0:i.clientType)===h.a.Employee?wt:Ot}}),jt=e("wTG2");function Mt(t,i){1&t&&(S.Sb(0,"p",19),S.Nb(1,"span",20),S.Ec(2),S.dc(3,"translate"),S.Rb()),2&t&&(S.Ab(2),S.Gc(" ",S.ec(3,1,"deposit_hire_amount_account_insufficient")," "))}var Dt=function(t){return{amount:t}};function Tt(t,i){if(1&t&&(S.Sb(0,"p",19),S.Nb(1,"span",20),S.Ec(2),S.dc(3,"translate"),S.dc(4,"currency"),S.Rb()),2&t){var e=S.cc(2);S.Ab(2),S.Gc(" ",S.fc(3,1,"deposit_hire_minnimum_import_web",S.nc(6,Dt,S.ec(4,4,null==e.impositionCondition?null:e.impositionCondition.minimum)))," ")}}function Ft(t,i){if(1&t&&(S.Sb(0,"p",19),S.Nb(1,"span",20),S.Ec(2),S.dc(3,"translate"),S.dc(4,"currency"),S.Rb()),2&t){var e=S.cc(2);S.Ab(2),S.Gc(" ",S.fc(3,1,"deposit_hire_maximum_import_web",S.nc(6,Dt,S.ec(4,4,null==e.impositionCondition?null:e.impositionCondition.maximum)))," ")}}var Gt=function(t){return{time:t}};function Nt(t,i){1&t&&(S.Ec(0),S.dc(1,"translate")),2&t&&S.Gc(" ",S.fc(1,1,"deposit_time_options_web",S.nc(4,Gt,i.item.duration))," ")}function Bt(t,i){1&t&&(S.Sb(0,"p",19),S.Nb(1,"span",20),S.Ec(2),S.dc(3,"translate"),S.Rb()),2&t&&(S.Ab(2),S.Gc("",S.ec(3,1,"deposit_new_imposition_must_read_conditions")," "))}var xt=function(t){return{error:t}};function Lt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"form",2),S.ac("submit",(function(){return S.wc(e),S.cc().onSubmit()})),S.Sb(1,"div",3),S.Sb(2,"label"),S.Ec(3),S.dc(4,"translate"),S.Rb(),S.Sb(5,"p",4),S.Ec(6),S.dc(7,"formatIban"),S.Rb(),S.Rb(),S.Sb(8,"div",3),S.Sb(9,"label"),S.Ec(10),S.dc(11,"translate"),S.Rb(),S.Sb(12,"p",4),S.Ec(13),S.dc(14,"formatIban"),S.Rb(),S.Rb(),S.Sb(15,"div",3),S.Sb(16,"label"),S.Ec(17),S.dc(18,"translate"),S.Rb(),S.Sb(19,"p",4),S.Ec(20),S.dc(21,"number"),S.Rb(),S.Rb(),S.Sb(22,"div",3),S.Sb(23,"label"),S.Ec(24),S.dc(25,"translate"),S.Rb(),S.Nb(26,"input",5),S.Cc(27,Mt,4,3,"p",6),S.Cc(28,Tt,5,8,"p",6),S.Cc(29,Ft,5,8,"p",6),S.Rb(),S.Sb(30,"div",7),S.Sb(31,"label"),S.Ec(32),S.dc(33,"translate"),S.Rb(),S.Sb(34,"ng-select",8),S.dc(35,"translate"),S.Cc(36,Nt,2,6,"ng-template",9),S.Rb(),S.Rb(),S.Sb(37,"div",10),S.Nb(38,"input",11),S.Sb(39,"label",12),S.Ec(40),S.dc(41,"translate"),S.Sb(42,"a",13),S.ac("click",(function(){return S.wc(e),S.cc().readConditions()})),S.Ec(43),S.dc(44,"translate"),S.Rb(),S.Rb(),S.Nb(45,"span",14),S.Cc(46,Bt,4,3,"p",6),S.Rb(),S.Sb(47,"div",15),S.Sb(48,"button",16),S.Ec(49),S.dc(50,"translate"),S.Rb(),S.Sb(51,"button",17),S.Ec(52),S.dc(53,"translate"),S.Rb(),S.Rb(),S.Sb(54,"div",18),S.Sb(55,"button",17),S.Ec(56),S.dc(57,"translate"),S.Rb(),S.Sb(58,"button",16),S.Ec(59),S.dc(60,"translate"),S.Rb(),S.Rb(),S.Rb()}if(2&t){var n=S.cc();S.jc("formGroup",n.form),S.Ab(3),S.Fc(S.ec(4,27,"deposit_sender_account")),S.Ab(3),S.Fc(S.ec(7,29,null==n.account?null:n.account.IBAN)),S.Ab(4),S.Fc(S.ec(11,31,"deposit_receiver_account")),S.Ab(3),S.Fc(S.ec(14,33,null==n.deposit?null:n.deposit.IBAN)),S.Ab(4),S.Fc(S.ec(18,35,"deposit_new_imposition_account_balance")),S.Ab(3),S.Fc(S.fc(21,37,(null==n.account?null:n.account.Balance)||0,"1.2-2")),S.Ab(4),S.Fc(S.ec(25,40,"deposit_amount")),S.Ab(2),S.jc("allowDecimal",!1)("ngClass",S.nc(58,xt,n.hasError(n.form.get("amount"))||n.hasMaxAmountError||n.hasMinAmountError)),S.Ab(1),S.jc("ngIf",n.hasBalanceError&&!n.hasMinAmountError&&!n.hasMaxAmountError),S.Ab(1),S.jc("ngIf",n.hasMinAmountError),S.Ab(1),S.jc("ngIf",n.hasMaxAmountError),S.Ab(3),S.Fc(S.ec(33,42,"deposit_time")),S.Ab(2),S.jc("items",n.impositionConditions)("placeholder",S.ec(35,44,"deposit_time_election"))("ngClass",S.nc(60,xt,n.hasError(n.form.get("impositionCondition"))))("searchable",!1)("clearable",!1),S.Ab(4),S.jc("ngClass",S.nc(62,xt,n.hasError(n.form.get("conditions")))),S.Ab(2),S.Gc("",S.ec(41,46,"deposit_new_imposition_condition_1_web"),"\xa0 "),S.Ab(3),S.Gc(" ",S.ec(44,48,"deposit_new_imposition_condition_2_web"),""),S.Ab(3),S.jc("ngIf",!n.conditionsRead&&n.submitted),S.Ab(3),S.Gc(" ",S.ec(50,50,"generic_continue_button")," "),S.Ab(3),S.Gc(" ",S.ec(53,52,"deposit_cancel")," "),S.Ab(4),S.Gc(" ",S.ec(57,54,"deposit_cancel")," "),S.Ab(3),S.Gc(" ",S.ec(60,56,"deposit_continue")," ")}}var $t=function(t){return{term:t}};function Ht(t,i){if(1&t){var e=S.Tb();S.Sb(0,"div",21),S.Sb(1,"div",3),S.Sb(2,"label"),S.Ec(3),S.dc(4,"translate"),S.Rb(),S.Sb(5,"p"),S.Ec(6),S.dc(7,"formatIban"),S.Rb(),S.Rb(),S.Sb(8,"div",3),S.Sb(9,"label"),S.Ec(10),S.dc(11,"translate"),S.Rb(),S.Sb(12,"p"),S.Ec(13),S.dc(14,"formatIban"),S.Rb(),S.Rb(),S.Sb(15,"div",3),S.Sb(16,"label"),S.Ec(17),S.dc(18,"translate"),S.Rb(),S.Sb(19,"p"),S.Ec(20),S.dc(21,"currency"),S.Rb(),S.Rb(),S.Sb(22,"div",3),S.Sb(23,"label"),S.Ec(24),S.dc(25,"translate"),S.Rb(),S.Sb(26,"p"),S.Ec(27),S.dc(28,"translate"),S.dc(29,"number"),S.Rb(),S.Rb(),S.Sb(30,"div",3),S.Sb(31,"label"),S.Ec(32),S.dc(33,"translate"),S.Rb(),S.Sb(34,"p"),S.Ec(35,"0,00 %"),S.Rb(),S.Rb(),S.Sb(36,"div",15),S.Sb(37,"button",22),S.ac("click",(function(){S.wc(e);var t=S.cc();return t.makeImposition.emit(t.imposition)})),S.Ec(38),S.dc(39,"translate"),S.Rb(),S.Rb(),S.Sb(40,"div",23),S.Sb(41,"button",24),S.ac("click",(function(){S.wc(e);var t=S.cc();return t.makeImposition.emit(t.imposition)})),S.Ec(42),S.dc(43,"translate"),S.Rb(),S.Rb(),S.Rb()}if(2&t){var n=S.cc();S.Ab(3),S.Fc(S.ec(4,11,"deposit_sender_account")),S.Ab(3),S.Fc(S.ec(7,13,null==n.account?null:n.account.IBAN)),S.Ab(4),S.Fc(S.ec(11,15,"deposit_receiver_account")),S.Ab(3),S.Fc(S.ec(14,17,null==n.deposit?null:n.deposit.IBAN)),S.Ab(4),S.Fc(S.ec(18,19,"deposit_new_impositon_amount")),S.Ab(3),S.Fc(S.ec(21,21,null==n.imposition?null:n.imposition.nominalAmount)),S.Ab(4),S.Fc(S.ec(25,23,"deposit_imposition_term")),S.Ab(3),S.Gc(" ",S.fc(28,25,"deposit_new_imposition_term_value_web",S.nc(36,$t,S.ec(29,28,null==n.impositionCondition?null:n.impositionCondition.duration)))," "),S.Ab(5),S.Fc(S.ec(33,30,"deposit_new_imposition_fee")),S.Ab(6),S.Gc(" ",S.ec(39,32,"generic_confirm_button")," "),S.Ab(4),S.Gc(" ",S.ec(43,34,"generic_confirm_button")," ")}}var qt,Ut=((qt=function(){function t(i,e){_classCallCheck(this,t),this.fb=i,this.externalDocuments=e,this.makeImposition=new S.n,this.submitted=!1,this.showConfirm=!1,this.conditionsRead=!1}return _createClass(t,[{key:"ngOnInit",value:function(){this.createForm()}},{key:"onSubmit",value:function(){var t,i;if(this.submitted=!0,this.form.markAllAsTouched(),this.form.valid&&this.conditionsRead){var e=this.form.value.impositionCondition;this.imposition={nominalAmount:Object(kt.b)(this.form.value.amount).toString(),duration:null===(t=e)||void 0===t?void 0:t.duration,frecuency:null===(i=e)||void 0===i?void 0:i.settFrequency},this.showConfirm=!0}}},{key:"hasError",value:function(t){return t.touched&&t.invalid}},{key:"readConditions",value:function(){var t;this.conditionsRead=!0,null===(t=window)||void 0===t||t.open(this.externalDocuments.impositionConditions)}},{key:"createForm",value:function(){var t,i;this.form=this.fb.group({amount:["",[It.r.required,(i=null===(t=this.account)||void 0===t?void 0:t.Balance,function(t){var e;return Object(kt.b)(null===(e=t)||void 0===e?void 0:e.value)>i?{balanceError:!0}:null})]],impositionCondition:[null,It.r.required],conditions:[!1,[It.r.requiredTrue]]},{validators:At})}},{key:"hasBalanceError",get:function(){var t=this.form.get("amount");return this.hasError(t)&&t.hasError("balanceError")}},{key:"hasMinAmountError",get:function(){return this.form.hasError("minImposition")}},{key:"hasMaxAmountError",get:function(){return this.form.hasError("maxImposition")}},{key:"impositionCondition",get:function(){var t;return null===(t=this.form)||void 0===t?void 0:t.get("impositionCondition").value}}]),t}()).\u0275fac=function(t){return new(t||qt)(S.Mb(It.c),S.Mb(Pt))},qt.\u0275cmp=S.Gb({type:qt,selectors:[["app-new-imposition-form"]],inputs:{impositionConditions:"impositionConditions",account:"account",deposit:"deposit"},outputs:{makeImposition:"makeImposition"},decls:3,vars:2,consts:[[3,"formGroup","submit",4,"ngIf","ngIfElse"],["confirm",""],[3,"formGroup","submit"],[1,"group-input"],[1,"input"],["formControlName","amount","type","text","appParseCurrency","","maxlength","10",3,"allowDecimal","ngClass"],["class","error-text",4,"ngIf"],[1,"group-input","input-select"],["formControlName","impositionCondition",3,"items","placeholder","ngClass","searchable","clearable"],["ng-label-tmp","","ng-option-tmp",""],[1,"group-input","input-checkbox"],["type","checkbox","formControlName","conditions","id","conditions",3,"ngClass"],["for","conditions"],["href","javascript:;",3,"click"],[1,"check","ico-check-2"],[1,"group-button"],["type","submit",1,"btn--primary"],["routerLink","../..","type","button",1,"btn--secondary"],[1,"main__button","group-button"],[1,"error-text"],[1,"ico-alert"],[1,"deposit-confirm"],["type","button",1,"btn--primary",3,"click"],[1,"main__button"],["type","submit",1,"btn--primary",3,"click"]],template:function(t,i){if(1&t&&(S.Cc(0,Lt,61,64,"form",0),S.Cc(1,Ht,44,38,"ng-template",null,1,S.Dc)),2&t){var e=S.tc(2);S.jc("ngIf",!i.showConfirm)("ngIfElse",e)}},directives:[D.p,It.s,It.o,It.g,It.b,It.n,It.f,kt.a,It.i,D.n,jt.a,jt.d,jt.c,It.a,P.e],pipes:[G.d,K.a,D.g,D.d],encapsulation:2,changeDetection:0}),qt),zt=["otpModal"];function Qt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"div",3),S.Sb(1,"div",4),S.Sb(2,"div",5),S.Sb(3,"div",6),S.Sb(4,"div",7),S.Sb(5,"div",8),S.Sb(6,"div",9),S.Sb(7,"h1"),S.Ec(8),S.dc(9,"translate"),S.Rb(),S.Sb(10,"p"),S.Ec(11),S.dc(12,"formatIban"),S.Rb(),S.Rb(),S.Sb(13,"div",9),S.Sb(14,"p"),S.Ec(15),S.dc(16,"translate"),S.Rb(),S.Sb(17,"h1"),S.Ec(18),S.dc(19,"currency"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(20,"div",10),S.Sb(21,"app-new-imposition-form",11),S.ac("makeImposition",(function(t){return S.wc(e),S.cc(2).onMakeImposition(t)})),S.dc(22,"async"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb()}if(2&t){var n=S.cc().ngIf,o=S.cc();S.Ab(8),S.Fc(S.ec(9,7,"deposit_new_imposition_title")),S.Ab(3),S.Fc(S.ec(12,9,null==n.deposit?null:n.deposit.IBAN)),S.Ab(4),S.Fc(S.ec(16,11,"deposit_new_imposition_account_balance")),S.Ab(3),S.Fc(S.ec(19,13,null==n.account?null:n.account.Balance)),S.Ab(3),S.jc("account",null==n?null:n.account)("deposit",null==n?null:n.deposit)("impositionConditions",S.ec(22,15,o.impositionConditions$))}}function Wt(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-otp-form",12),S.ac("send",(function(t){return S.wc(e),S.cc(2).createImposition(t)}))("repeat",(function(){return S.wc(e),S.cc(2).generateOtp()}))("hide",(function(){return S.wc(e),S.cc(2).closeModal()})),S.Rb()}if(2&t){var n=S.cc(2);S.jc("invalidCode",n.invalidImpositionOtpCode)}}function Vt(t,i){if(1&t&&(S.Qb(0),S.Cc(1,Qt,23,17,"div",1),S.Cc(2,Wt,1,1,"ng-template",null,2,S.Dc),S.Pb()),2&t){var e=i.ngIf;S.Ab(1),S.jc("ngIf",e.globalPosition)}}var Jt,Kt=((Jt=function(){function t(i,e,n,o,c){_classCallCheck(this,t),this.modalService=i,this.router=e,this.route=n,this.errorHandler=o,this.impositionService=c,this.state$=this.impositionService.state$,this.impositionConditions$=this.impositionService.impositionConditions$,this.invalidImpositionOtpCode=!1}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){this.closeModal(),this.impositionService.destroy()}},{key:"openModal",value:function(t){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(t))}},{key:"closeModal",value:function(){var t;null===(t=this.modalRef)||void 0===t||t.hide()}},{key:"onMakeImposition",value:function(t){this.impositionService.initImposition(t),this.generateOtp()}},{key:"generateOtp",value:function(){var t=this;this.invalidImpositionOtpCode=!1,this.impositionService.generateOtp((function(){t.openModal(t.otpModal)}),(function(i){t.errorHandler.showError(i)}))}},{key:"createImposition",value:function(t){var i=this;this.impositionService.createImposition(t,(function(){i.closeModal(),i.navigateToSuccessPage()}),(function(t){Object(l.j)(t)?i.invalidImpositionOtpCode=!0:(i.closeModal(),i.errorHandler.showError(t))}))}},{key:"navigateToSuccessPage",value:function(){this.router.navigate(["../new-imposition-success"],{skipLocationChange:!0,relativeTo:this.route})}}]),t}()).\u0275fac=function(t){return new(t||Jt)(S.Mb(O.b),S.Mb(P.d),S.Mb(P.a),S.Mb(k.a),S.Mb(Ct,2))},Jt.\u0275cmp=S.Gb({type:Jt,selectors:[["app-new-imposition"]],viewQuery:function(t,i){var e;1&t&&S.Ic(zt,!0),2&t&&S.sc(e=S.bc())&&(i.otpModal=e.first)},features:[S.zb([Ct])],decls:2,vars:3,consts:[[4,"ngIf"],["class","max-size deposit-form",4,"ngIf"],["otpModal",""],[1,"max-size","deposit-form"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[3,"account","deposit","impositionConditions","makeImposition"],[3,"invalidCode","send","repeat","hide"]],template:function(t,i){1&t&&(S.Cc(0,Vt,4,1,"ng-container",0),S.dc(1,"async")),2&t&&S.jc("ngIf",S.ec(1,1,i.state$))},directives:[D.p,Ut,J.a],pipes:[D.b,G.d,K.a,D.d],encapsulation:2,changeDetection:0}),Jt),Xt=e("mrSG"),Yt=e("z6cu"),Zt=e("wO+i"),ti=e("aGrj"),ii=e("nYR2"),ei=e("5+tZ"),ni=e("3E0/"),oi=e("XNiG"),ci=e("l7GE"),ai=e("ZUHj");function si(t){return function(i){return i.lift(new li(t,i))}}var ri,ui,li=function(){function t(i,e){_classCallCheck(this,t),this.notifier=i,this.source=e}return _createClass(t,[{key:"call",value:function(t,i){return i.subscribe(new di(t,this.notifier,this.source))}}]),t}(),di=function(t){_inherits(e,t);var i=_createSuper(e);function e(t,n,o){var c;return _classCallCheck(this,e),(c=i.call(this,t)).notifier=n,c.source=o,c}return _createClass(e,[{key:"error",value:function(t){if(!this.isStopped){var i=this.errors,n=this.retries,o=this.retriesSubscription;if(n)this.errors=null,this.retriesSubscription=null;else{i=new oi.a;try{n=(0,this.notifier)(i)}catch(c){return _get(_getPrototypeOf(e.prototype),"error",this).call(this,c)}o=Object(ai.a)(this,n)}this._unsubscribeAndRecycle(),this.errors=i,this.retries=n,this.retriesSubscription=o,i.next(t)}}},{key:"_unsubscribe",value:function(){var t=this.errors,i=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=null),i&&(i.unsubscribe(),this.retriesSubscription=null),this.retries=null}},{key:"notifyNext",value:function(t,i,e,n,o){var c=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=c,this.source.subscribe(this)}}]),e}(ci.a),pi=((ri=function(){function t(i){_classCallCheck(this,t),this.http=i}return _createClass(t,[{key:"newHiring",value:function(t){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.newHiring),null,{params:{productid:t}})}},{key:"getPdfContract",value:function(){return this.http.get("".concat(R.a.apiBasePath).concat(R.a.endpoints.deposit.getPdfContract))}},{key:"startSignProcessSubmit",value:function(){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.sign.startSignProcessSubmit),null).pipe(Object(r.a)((function(t){var i,e,n,o,c;if((null===(i=t)||void 0===i?void 0:i.code)===C.a.ERROR_SUBMIT)throw{errorCode:null===(e=t)||void 0===e?void 0:e.code,message:null===(n=t)||void 0===n?void 0:n.code};return null===(c=null===(o=t)||void 0===o?void 0:o.data[0])||void 0===c?void 0:c.uniqueId})))}},{key:"startSignProcessBulkSign",value:function(){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.sign.startSignProcessBulkSign),null).pipe(Object(r.a)((function(t){var i,e,n,o,c;if((null===(i=t)||void 0===i?void 0:i.code)===C.a.ERROR_BULKSIGN||(null===(e=t)||void 0===e?void 0:e.code)===C.a.ERROR_BULKSIGN_REQUESTNEWSUBMIT)throw{errorCode:null===(n=t)||void 0===n?void 0:n.code,message:null===(o=t)||void 0===o?void 0:o.code};return null===(c=t)||void 0===c?void 0:c.data[0]})))}},{key:"querySignProcess",value:function(){return this.http.post("".concat(R.a.apiBasePath).concat(R.a.endpoints.sign.querySignProcess),null)}}]),t}()).\u0275fac=function(t){return new(t||ri)(S.Wb(I.b))},ri.\u0275prov=S.Ib({token:ri,factory:ri.\u0275fac,providedIn:"root"}),ri),bi=e("/BtI"),fi=((ui=function(){function t(){_classCallCheck(this,t),this.step=0}return _createClass(t,[{key:"firstStepClass",get:function(){return{completed:this.step>0,active:0===this.step}}},{key:"secondStepClass",get:function(){return{completed:this.step>1,active:1===this.step}}},{key:"thirdStepClass",get:function(){return{completed:this.step>2,active:2===this.step}}},{key:"lineClass",get:function(){return{partial:1===this.step,completed:this.step>1}}}]),t}()).\u0275fac=function(t){return new(t||ui)},ui.\u0275cmp=S.Gb({type:ui,selectors:[["app-hire-deposit-status-bar"]],inputs:{step:"step"},decls:26,vars:13,consts:[[1,"status-bar"],[1,"step",3,"ngClass"],[1,"step__circle"],[1,"step__number"],[1,"step__icon","ico-check-2"],[1,"line","partial",3,"ngClass"]],template:function(t,i){1&t&&(S.Sb(0,"div",0),S.Sb(1,"div",1),S.Sb(2,"div",2),S.Sb(3,"span",3),S.Ec(4,"1"),S.Rb(),S.Nb(5,"span",4),S.Rb(),S.Sb(6,"p"),S.Ec(7),S.dc(8,"translate"),S.Rb(),S.Rb(),S.Sb(9,"div",1),S.Sb(10,"div",2),S.Sb(11,"span",3),S.Ec(12,"2"),S.Rb(),S.Nb(13,"span",4),S.Rb(),S.Sb(14,"p"),S.Ec(15),S.dc(16,"translate"),S.Rb(),S.Rb(),S.Sb(17,"div",1),S.Sb(18,"div",2),S.Sb(19,"span",3),S.Ec(20,"3"),S.Rb(),S.Nb(21,"span",4),S.Rb(),S.Sb(22,"p"),S.Ec(23),S.dc(24,"translate"),S.Rb(),S.Rb(),S.Nb(25,"div",5),S.Rb()),2&t&&(S.Ab(1),S.jc("ngClass",i.firstStepClass),S.Ab(6),S.Fc(S.ec(8,7,"deposit_hire_step_one")),S.Ab(2),S.jc("ngClass",i.secondStepClass),S.Ab(6),S.Fc(S.ec(16,9,"deposit_hire_step_two")),S.Ab(2),S.jc("ngClass",i.thirdStepClass),S.Ab(6),S.Fc(S.ec(24,11,"deposit_hire_step_three")),S.Ab(2),S.jc("ngClass",i.lineClass))},directives:[D.n],pipes:[G.d],encapsulation:2,changeDetection:0}),ui);function mi(t,i){1&t&&(S.Sb(0,"p",13),S.Nb(1,"span",14),S.Ec(2),S.dc(3,"translate"),S.Rb()),2&t&&(S.Ab(2),S.Gc("",S.ec(3,1,"hire_deposit_must_read_particular_conditions")," "))}var vi,_i=function(t){return{error:t}},hi=((vi=function(){function t(i,e){_classCallCheck(this,t),this.formBuilder=i,this.externalDocuments=e,this.hireDeposit=new S.n,this.submitted=!1,this.readPdf={particularConditions:!1}}return _createClass(t,[{key:"ngOnInit",value:function(){this.createForm()}},{key:"onSubmit",value:function(){this.submitted=!0,this.form.markAllAsTouched(),this.form.valid&&this.readPdf.particularConditions&&this.hireDeposit.emit()}},{key:"readParticularConditions",value:function(){var t;this.readPdf.particularConditions=!0,null===(t=window)||void 0===t||t.open(this.externalDocuments.particularConditions)}},{key:"hasError",value:function(t){return t.touched&&t.invalid}},{key:"createForm",value:function(){this.form=this.formBuilder.group({particularConditions:[!1,[It.r.requiredTrue]]})}}]),t}()).\u0275fac=function(t){return new(t||vi)(S.Mb(It.c),S.Mb(Pt))},vi.\u0275cmp=S.Gb({type:vi,selectors:[["app-hire-deposit-form"]],inputs:{account:"account"},outputs:{hireDeposit:"hireDeposit"},decls:30,vars:26,consts:[[3,"formGroup","submit"],[1,"group-input"],[1,"input"],[1,"description"],[1,"group-input","input-checkbox"],["type","checkbox","formControlName","particularConditions","id","particularConditions",3,"ngClass"],["for","particularConditions"],["href","javascript:;",3,"click"],[1,"check","ico-check-2"],["class","error-text",4,"ngIf"],[1,"group-button"],["type","submit",1,"btn--primary"],[1,"main__button"],[1,"error-text"],[1,"ico-alert"]],template:function(t,i){1&t&&(S.Sb(0,"form",0),S.ac("submit",(function(){return i.onSubmit()})),S.Sb(1,"div",1),S.Sb(2,"label"),S.Ec(3),S.dc(4,"translate"),S.Rb(),S.Sb(5,"p",2),S.Ec(6),S.dc(7,"formatIban"),S.Rb(),S.Rb(),S.Sb(8,"div",3),S.Sb(9,"label"),S.Ec(10),S.dc(11,"translate"),S.Rb(),S.Rb(),S.Sb(12,"div",4),S.Nb(13,"input",5),S.Sb(14,"label",6),S.Ec(15),S.dc(16,"translate"),S.Sb(17,"a",7),S.ac("click",(function(){return i.readParticularConditions()})),S.Ec(18),S.dc(19,"translate"),S.Rb(),S.Rb(),S.Nb(20,"span",8),S.Cc(21,mi,4,3,"p",9),S.Rb(),S.Sb(22,"div",10),S.Sb(23,"button",11),S.Ec(24),S.dc(25,"translate"),S.Rb(),S.Rb(),S.Sb(26,"div",12),S.Sb(27,"button",11),S.Ec(28),S.dc(29,"translate"),S.Rb(),S.Rb(),S.Rb()),2&t&&(S.jc("formGroup",i.form),S.Ab(3),S.Fc(S.ec(4,10,"transfer_sender_account")),S.Ab(3),S.Fc(S.ec(7,12,null==i.account?null:i.account.IBAN)),S.Ab(4),S.Fc(S.ec(11,14,"deposit_hire_conditions_description")),S.Ab(3),S.jc("ngClass",S.nc(24,_i,i.hasError(i.form.get("particularConditions")))),S.Ab(2),S.Gc("",S.ec(16,16,"deposit_hire_conditions_web")," "),S.Ab(3),S.Gc(" ",S.ec(19,18,"deposit_hire_particular_conditions_web"),""),S.Ab(3),S.jc("ngIf",!i.readPdf.particularConditions&&i.submitted),S.Ab(3),S.Gc(" ",S.ec(25,20,"deposit_continue")," "),S.Ab(4),S.Gc(" ",S.ec(29,22,"deposit_continue")," "))},directives:[It.s,It.o,It.g,It.a,It.n,It.f,D.n,D.p],pipes:[G.d,K.a],encapsulation:2}),vi);function Si(t,i){1&t&&(S.Sb(0,"p",13),S.Ec(1),S.dc(2,"translate"),S.Rb()),2&t&&(S.Ab(1),S.Gc(" ",S.ec(2,1,"deposit_hire_loading_contract_response")," "))}function Ri(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-hire-deposit-form",14),S.ac("hireDeposit",(function(){return S.wc(e),S.cc(3).onHireDeposit()})),S.Rb()}if(2&t){var n=S.cc(2).ngIf;S.jc("account",n.account)}}function gi(t,i){if(1&t&&(S.Sb(0,"div",2),S.Sb(1,"div",3),S.Sb(2,"div",4),S.Sb(3,"div",5),S.Sb(4,"div",6),S.Sb(5,"div",7),S.Sb(6,"div",8),S.Sb(7,"h1"),S.Ec(8),S.dc(9,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(10,"div",9),S.Cc(11,Si,3,3,"p",10),S.Cc(12,Ri,1,1,"app-hire-deposit-form",11),S.Rb(),S.Rb(),S.Sb(13,"div",12),S.Nb(14,"app-hire-deposit-status-bar"),S.Rb(),S.Rb(),S.Rb()),2&t){var e=S.cc(2);S.Ab(8),S.Fc(S.ec(9,3,"deposit_hire_title")),S.Ab(3),S.jc("ngIf",e.isWorking),S.Ab(1),S.jc("ngIf",!e.isWorking)}}function yi(t,i){if(1&t&&(S.Qb(0),S.Cc(1,gi,15,5,"div",1),S.Pb()),2&t){var e=i.ngIf;S.Ab(1),S.jc("ngIf",e.globalPosition)}}var Ci,Ii=((Ci=function(){function t(i,e,n,c,a,s,r){_classCallCheck(this,t),this.document=i,this.globalPositionService=e,this.hireDepositService=n,this.errorHandler=c,this.dictionaryService=a,this.activatedRoute=s,this.loadingService=r,this.state$=this.createState(),this.isWorking=!1,this.subs=new o.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.checkPendingHiring()}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}},{key:"onHireDeposit",value:function(){this.hiringProcess(this.availablePodructId)}},{key:"checkPendingHiring",value:function(){return Object(Xt.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(i=this.activatedRoute.snapshot.queryParams.id)){t.next=5;break}this.availablePodructId=i,t.next=14;break;case 5:return t.prev=5,t.next=8,this.getProductId();case 8:this.availablePodructId=t.sent,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(5),this.errorHandler.redirectErrorPage(t.t0);case 14:case"end":return t.stop()}}),t,this,[[5,11]])})))}},{key:"getProductId",value:function(){return Object(Xt.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.globalPositionService.pendingHirings().pipe(Object(r.a)((function(t){var i,e,n;return null===(n=null===(e=null===(i=t.data)||void 0===i?void 0:i[0])||void 0===e?void 0:e.RCI_Product__r)||void 0===n?void 0:n.ProductCode}))).toPromise();case 2:if(i=t.sent,t.t0=i,t.t0){t.next=8;break}return t.next=7,this.getProducts().pipe(Object(Zt.a)("externalId")).toPromise();case 7:i=t.sent;case 8:return t.abrupt("return",i);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"createState",value:function(){return Object(gt.a)(this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(l.d)())).pipe(Object(r.a)((function(t){var i=_slicedToArray(t,2);return{globalPosition:i[0],account:i[1]}})))}},{key:"hiringProcess",value:function(t){var i=this;this.loadingService.show(),this.isWorking=!0,this.subs.add(this.hireDepositService.newHiring(t).pipe(Object(ti.a)(this.hireDepositService.getPdfContract()),Object(ti.a)(this.signDeposit())).pipe(Object(ii.a)((function(){i.loadingService.hide(),i.isWorking=!1}))).subscribe((function(t){i.handleSignResponse(t)}),(function(t){i.errorHandler.showError(t)})))}},{key:"handleSignResponse",value:function(t){var i;try{var e=new URL(null===(i=t)||void 0===i?void 0:i.url);this.document.location.href=e.href}catch(n){console.error(n)}}},{key:"getProducts",value:function(){return this.dictionaryService.getProducts().pipe(Object(r.a)((function(t){var i;return null===(i=t.productList)||void 0===i?void 0:i[0]})))}},{key:"signDeposit",value:function(){var t=this;return this.hireDepositService.querySignProcess().pipe(Object(r.a)((function(t){var i;return null===(i=t)||void 0===i?void 0:i.data})),Object(a.a)((function(t){var i;return!t||0===(null===(i=t)||void 0===i?void 0:i.length)})),Object(ei.a)((function(){return t.hireDepositService.startSignProcessSubmit()})),Object(ni.a)(5e3),Object(ei.a)((function(){return t.hireDepositService.startSignProcessBulkSign().pipe((i=3,function(t){return t.pipe(si((function(t){return t.pipe(Object(ei.a)((function(t){var e;return(null===(e=t)||void 0===e?void 0:e.errorCode)===C.a.KO_RETRY?i-- >0?Object(y.a)(t).pipe(Object(ni.a)(5e3)):Object(Yt.a)({errorCode:"MAX_RETRIES_EXCEEDED"}):(i=5,Object(Yt.a)(t))})))})))}));var i})))}}]),t}()).\u0275fac=function(t){return new(t||Ci)(S.Mb(D.e),S.Mb(w.a),S.Mb(pi),S.Mb(k.a),S.Mb(yt.a),S.Mb(P.a),S.Mb(bi.a))},Ci.\u0275cmp=S.Gb({type:Ci,selectors:[["app-hire-deposit"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","max-size deposit-form",4,"ngIf"],[1,"max-size","deposit-form"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],["class","info-text",4,"ngIf"],[3,"account","hireDeposit",4,"ngIf"],[1,"aside-col"],[1,"info-text"],[3,"account","hireDeposit"]],template:function(t,i){1&t&&(S.Cc(0,yi,2,1,"ng-container",0),S.dc(1,"async")),2&t&&S.jc("ngIf",S.ec(1,1,i.state$))},directives:[D.p,fi,hi],pipes:[D.b,G.d],encapsulation:2}),Ci),ki=function(){return[".."]};function Ai(t,i){if(1&t&&(S.Sb(0,"div",5),S.Sb(1,"div",6),S.Sb(2,"div",7),S.Sb(3,"div",8),S.Sb(4,"div",9),S.Sb(5,"div",10),S.Sb(6,"h1"),S.Ec(7),S.dc(8,"translate"),S.Rb(),S.Sb(9,"p"),S.Ec(10),S.dc(11,"formatIban"),S.Rb(),S.Rb(),S.Sb(12,"div",10),S.Sb(13,"p"),S.Ec(14),S.dc(15,"translate"),S.Rb(),S.Sb(16,"h1"),S.Ec(17),S.dc(18,"currency"),S.dc(19,"async"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(20,"div",11),S.Sb(21,"div",12),S.Nb(22,"span",13),S.Sb(23,"h2"),S.Ec(24),S.dc(25,"translate"),S.Rb(),S.Sb(26,"h2"),S.Ec(27),S.dc(28,"translate"),S.Rb(),S.Sb(29,"p"),S.Ec(30),S.dc(31,"translate"),S.Rb(),S.Rb(),S.Sb(32,"button",4),S.Ec(33),S.dc(34,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb()),2&t){var e=S.cc().ngIf,n=S.cc();S.Ab(7),S.Fc(S.ec(8,9,"deposit_cancel_imposition_title")),S.Ab(3),S.Fc(S.ec(11,11,null==e.deposit?null:e.deposit.IBAN)),S.Ab(4),S.Fc(S.ec(15,13,"deposit_cancel_imposition_amount")),S.Ab(3),S.Fc(S.ec(18,15,S.ec(19,17,n.imposition$).importeNominal)),S.Ab(7),S.Fc(S.ec(25,19,"deposit_cancel_impositon_congrats")),S.Ab(3),S.Fc(S.ec(28,21,"deposit_cancel_impositon_success_operation")),S.Ab(3),S.Fc(S.ec(31,23,"deposit_cancel_impositon_success_money")),S.Ab(2),S.jc("routerLink",S.mc(27,ki)),S.Ab(1),S.Gc(" ",S.ec(34,25,"deposit_cancel_impositon_success_button")," ")}}function Ei(t,i){if(1&t&&(S.Sb(0,"div",1),S.Cc(1,Ai,35,28,"div",2),S.Sb(2,"div",3),S.Sb(3,"button",4),S.Ec(4),S.dc(5,"translate"),S.Rb(),S.Rb(),S.Rb()),2&t){var e=i.ngIf;S.Ab(1),S.jc("ngIf",e.globalPosition),S.Ab(2),S.jc("routerLink",S.mc(5,ki)),S.Ab(1),S.Gc(" ",S.ec(5,3,"deposit_cancel_impositon_success_button")," ")}}var wi=function(){return[".."]},Oi=["otpModal"];function Pi(t,i){1&t&&(S.Sb(0,"div",4),S.Sb(1,"div",5),S.Sb(2,"div",6),S.Sb(3,"div",7),S.Sb(4,"div",8),S.Sb(5,"div",9),S.Sb(6,"h1"),S.Ec(7),S.dc(8,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(9,"div",10),S.Sb(10,"p",11),S.Ec(11),S.dc(12,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb()),2&t&&(S.Ab(7),S.Fc(S.ec(8,2,"deposit_hire_title")),S.Ab(4),S.Fc(S.ec(12,4,"deposit_hire_loading_sign_response")))}function ji(t,i){if(1&t){var e=S.Tb();S.Sb(0,"div",4),S.Sb(1,"div",5),S.Sb(2,"div",6),S.Sb(3,"div",7),S.Sb(4,"div",8),S.Sb(5,"div",9),S.Sb(6,"h1"),S.Ec(7),S.dc(8,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(9,"div",10),S.Sb(10,"app-new-imposition-form",12),S.ac("makeImposition",(function(t){return S.wc(e),S.cc(2).onMakeImposition(t)})),S.dc(11,"async"),S.Rb(),S.Rb(),S.Rb(),S.Sb(12,"div",13),S.Nb(13,"app-hire-deposit-status-bar",14),S.Rb(),S.Rb()}if(2&t){var n=S.cc().ngIf,o=S.cc();S.Ab(7),S.Fc(S.ec(8,5,"deposit_hire_title")),S.Ab(3),S.jc("account",null==n?null:n.account)("deposit",null==n?null:n.deposit)("impositionConditions",S.ec(11,7,o.impositionConditions$)),S.Ab(3),S.jc("step",2)}}function Mi(t,i){if(1&t){var e=S.Tb();S.Sb(0,"app-otp-form",15),S.ac("send",(function(t){return S.wc(e),S.cc(2).createImposition(t)}))("repeat",(function(){return S.wc(e),S.cc(2).generateOtp()}))("hide",(function(){return S.wc(e),S.cc(2).closeModal()})),S.Rb()}if(2&t){var n=S.cc(2);S.jc("invalidCode",n.invalidImpositionOtpCode)}}function Di(t,i){if(1&t&&(S.Qb(0),S.Sb(1,"div",1),S.Cc(2,Pi,13,6,"div",2),S.Cc(3,ji,14,9,"div",2),S.Rb(),S.Cc(4,Mi,1,1,"ng-template",null,3,S.Dc),S.Pb()),2&t){var e=i.ngIf,n=S.cc();S.Ab(2),S.jc("ngIf",n.isPendingSignResponse),S.Ab(1),S.jc("ngIf",!n.isPendingSignResponse&&n.canMakeFirstImposition&&e.globalPosition)}}var Ti,Fi,Gi,Ni,Bi,xi=function(){return[".."]},Li=[{path:"",component:Rt},{path:"new-imposition",component:Kt},{path:"refund-success",component:(Ni=function(){function t(i,e,n){_classCallCheck(this,t),this.globalPositionService=i,this.activatedRoute=e,this.router=n,this.state$=this.createStateStream(),this.imposition$=this.createImpositionStream()}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"createStateStream",value:function(){return Object(gt.a)(this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(l.e)())).pipe(Object(r.a)((function(t){var i=_slicedToArray(t,2);return{globalPosition:i[0],deposit:i[1]}})))}},{key:"createImpositionStream",value:function(){var t=this;return this.activatedRoute.queryParams.pipe(Object(s.a)((function(i){isNaN(parseFloat(i.importeNominal))&&t.router.navigate([".."],{relativeTo:t.activatedRoute})})))}}]),t}(),Ni.\u0275fac=function(t){return new(t||Ni)(S.Mb(w.a),S.Mb(P.a),S.Mb(P.d))},Ni.\u0275cmp=S.Gb({type:Ni,selectors:[["app-success-refund"]],decls:2,vars:3,consts:[["class","max-size deposit",4,"ngIf"],[1,"max-size","deposit"],["class","main",4,"ngIf"],[1,"main__button"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"]],template:function(t,i){1&t&&(S.Cc(0,Ei,6,6,"div",0),S.dc(1,"async")),2&t&&S.jc("ngIf",S.ec(1,1,i.state$))},directives:[D.p,P.e],pipes:[D.b,G.d,K.a,D.d],encapsulation:2}),Ni)},{path:"new-imposition-success",component:(Gi=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Gi.\u0275fac=function(t){return new(t||Gi)},Gi.\u0275cmp=S.Gb({type:Gi,selectors:[["app-success-new-imposition"]],decls:29,vars:22,consts:[[1,"max-size","deposit"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main__button"]],template:function(t,i){1&t&&(S.Sb(0,"div",0),S.Sb(1,"div",1),S.Sb(2,"div",2),S.Sb(3,"div",3),S.Sb(4,"div",4),S.Sb(5,"div",5),S.Sb(6,"div",6),S.Sb(7,"h1"),S.Ec(8),S.dc(9,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(10,"div",7),S.Sb(11,"div",8),S.Nb(12,"span",9),S.Sb(13,"h2"),S.Ec(14),S.dc(15,"translate"),S.Rb(),S.Sb(16,"h2"),S.Ec(17),S.dc(18,"translate"),S.Rb(),S.Sb(19,"p"),S.Ec(20),S.dc(21,"translate"),S.Rb(),S.Rb(),S.Sb(22,"button",10),S.Ec(23),S.dc(24,"translate"),S.Rb(),S.Sb(25,"div",11),S.Sb(26,"button",10),S.Ec(27),S.dc(28,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb()),2&t&&(S.Ab(8),S.Fc(S.ec(9,8,"deposit_new_imposition_title")),S.Ab(6),S.Fc(S.ec(15,10,"deposit_new_impositon_congrats")),S.Ab(3),S.Fc(S.ec(18,12,"deposit_new_impositon_success_process")),S.Ab(3),S.Fc(S.ec(21,14,"deposit_new_impositon_success_balance")),S.Ab(2),S.jc("routerLink",S.mc(20,wi)),S.Ab(1),S.Gc(" ",S.ec(24,16,"deposit_new_impositon_success_button")," "),S.Ab(3),S.jc("routerLink",S.mc(21,wi)),S.Ab(1),S.Gc(" ",S.ec(28,18,"deposit_new_impositon_success_button")," "))},directives:[P.e],pipes:[G.d],encapsulation:2,changeDetection:0}),Gi)},{path:"hire",component:Ii},{path:"first-imposition",component:(Fi=function(){function t(i,e,n,c,a,s){_classCallCheck(this,t),this.modalService=i,this.router=e,this.route=n,this.errorHandler=c,this.impositionService=a,this.depositService=s,this.state$=this.impositionService.state$,this.impositionConditions$=this.impositionService.impositionConditions$,this.isPendingSignResponse=!0,this.canMakeFirstImposition=!1,this.invalidImpositionOtpCode=!1,this.subs=new o.a}return _createClass(t,[{key:"ngOnInit",value:function(){this.getRequiredDoc()}},{key:"ngOnDestroy",value:function(){this.closeModal(),this.impositionService.destroy(),this.subs.unsubscribe()}},{key:"openModal",value:function(t){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(t))}},{key:"closeModal",value:function(){var t;null===(t=this.modalRef)||void 0===t||t.hide()}},{key:"getRequiredDoc",value:function(){var t,i=this;this.subs.add(this.depositService.getRequiredDoc().pipe(Object(r.a)(this.mapInProgressClient),(t=25,function(i){return i.pipe(si((function(i){return i.pipe(Object(ei.a)((function(i){var e;return"OB_GET_REQUIRED_DOC_IN_PROGRESS"===(null===(e=i)||void 0===e?void 0:e.errorCode)?t-- >0?Object(y.a)(i).pipe(Object(ni.a)(7500)):Object(Yt.a)({errorCode:"MAX_RETRIES_EXCEEDED"}):(t=5,Object(Yt.a)(i))})))})))}),Object(ii.a)((function(){i.isPendingSignResponse=!1}))).subscribe((function(){i.impositionService.fetchGlobalPosition(),i.canMakeFirstImposition=!0}),(function(t){i.errorHandler.showError(t,(function(){i.router.navigate([".."],{relativeTo:i.route})}))})))}},{key:"onMakeImposition",value:function(t){this.impositionService.initImposition(t),this.generateOtp()}},{key:"generateOtp",value:function(){var t=this;this.invalidImpositionOtpCode=!1,this.impositionService.generateOtp((function(){t.openModal(t.otpModal)}),(function(i){t.errorHandler.showError(i)}))}},{key:"createImposition",value:function(t){var i=this;this.impositionService.createImposition(t,(function(){i.closeModal(),i.navigateToSuccessPage()}),(function(t){Object(l.j)(t)?i.invalidImpositionOtpCode=!0:(i.closeModal(),i.errorHandler.showError(t))}))}},{key:"mapInProgressClient",value:function(t){if("OB_GET_REQUIRED_DOC_IN_PROGRESS"===t.code)throw{message:"OB_GET_REQUIRED_DOC_IN_PROGRESS",errorCode:"OB_GET_REQUIRED_DOC_IN_PROGRESS"};if("OB_GET_REQUIRED_DOC_NOT_APPROVED"===t.code)throw{message:"OB_GET_REQUIRED_DOC_NOT_APPROVED",errorCode:"OB_GET_REQUIRED_DOC_NOT_APPROVED"};return t}},{key:"navigateToSuccessPage",value:function(){this.router.navigate(["../hire-deposit-success"],{skipLocationChange:!0,relativeTo:this.route})}}]),t}(),Fi.\u0275fac=function(t){return new(t||Fi)(S.Mb(O.b),S.Mb(P.d),S.Mb(P.a),S.Mb(k.a),S.Mb(Ct,2),S.Mb(A))},Fi.\u0275cmp=S.Gb({type:Fi,selectors:[["app-first-imposition"]],viewQuery:function(t,i){var e;1&t&&S.Ic(Oi,!0),2&t&&S.sc(e=S.bc())&&(i.otpModal=e.first)},features:[S.zb([Ct])],decls:2,vars:3,consts:[[4,"ngIf"],[1,"max-size","deposit-form"],["class","main",4,"ngIf"],["otpModal",""],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"info-text"],[3,"account","deposit","impositionConditions","makeImposition"],[1,"aside-col"],[3,"step"],[3,"invalidCode","send","repeat","hide"]],template:function(t,i){1&t&&(S.Cc(0,Di,6,2,"ng-container",0),S.dc(1,"async")),2&t&&S.jc("ngIf",S.ec(1,1,i.state$))},directives:[D.p,Ut,fi,J.a],pipes:[D.b,G.d],encapsulation:2}),Fi)},{path:"hire-deposit-success",component:(Ti=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}(),Ti.\u0275fac=function(t){return new(t||Ti)},Ti.\u0275cmp=S.Gb({type:Ti,selectors:[["app-hire-deposit-success"]],decls:31,vars:23,consts:[[1,"max-size","deposit","deposit-form"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main__button"],[1,"aside-col"],[3,"step"]],template:function(t,i){1&t&&(S.Sb(0,"div",0),S.Sb(1,"div",1),S.Sb(2,"div",2),S.Sb(3,"div",3),S.Sb(4,"div",4),S.Sb(5,"div",5),S.Sb(6,"div",6),S.Sb(7,"h1"),S.Ec(8),S.dc(9,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(10,"div",7),S.Sb(11,"div",8),S.Nb(12,"span",9),S.Sb(13,"h2"),S.Ec(14),S.dc(15,"translate"),S.Rb(),S.Sb(16,"h2"),S.Ec(17),S.dc(18,"translate"),S.Rb(),S.Sb(19,"p"),S.Ec(20),S.dc(21,"translate"),S.Rb(),S.Rb(),S.Sb(22,"button",10),S.Ec(23),S.dc(24,"translate"),S.Rb(),S.Sb(25,"div",11),S.Sb(26,"button",10),S.Ec(27),S.dc(28,"translate"),S.Rb(),S.Rb(),S.Rb(),S.Rb(),S.Sb(29,"div",12),S.Nb(30,"app-hire-deposit-status-bar",13),S.Rb(),S.Rb(),S.Rb()),2&t&&(S.Ab(8),S.Fc(S.ec(9,9,"deposit_hire_title")),S.Ab(6),S.Fc(S.ec(15,11,"deposit_hire_congrats")),S.Ab(3),S.Fc(S.ec(18,13,"deposit_hire_process_success")),S.Ab(3),S.Fc(S.ec(21,15,"deposit_hire_deposit_ready_caption")),S.Ab(2),S.jc("routerLink",S.mc(21,xi)),S.Ab(1),S.Gc(" ",S.ec(24,17,"deposit_hire_button_understand")," "),S.Ab(3),S.jc("routerLink",S.mc(22,xi)),S.Ab(1),S.Gc(" ",S.ec(28,19,"deposit_hire_button_understand")," "),S.Ab(3),S.jc("step",3))},directives:[P.e,fi],pipes:[G.d],encapsulation:2}),Ti)}],$i=((Bi=function t(){_classCallCheck(this,t)}).\u0275mod=S.Kb({type:Bi}),Bi.\u0275inj=S.Jb({factory:function(t){return new(t||Bi)},imports:[[P.h.forChild(Li)],P.h]}),Bi),Hi=e("PCNd");e.d(i,"DepositModule",(function(){return Ui}));var qi,Ui=((qi=function t(){_classCallCheck(this,t)}).\u0275mod=S.Kb({type:qi}),qi.\u0275inj=S.Jb({factory:function(t){return new(t||qi)},imports:[[Hi.a,$i]]}),qi)}}]);