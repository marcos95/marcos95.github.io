(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{fx87:function(i,t,e){"use strict";e.r(t);var o=e("quSY"),n=e("itXk"),c=e("pLZG"),s=e("vkgz"),a=e("lJxs"),r=e("eIep"),d=e("a+Vh"),l=e("SLWe"),b=e("eApZ"),p=e("v3IF"),u=e("bU05"),m=e("OMSe"),h=e("9H/N"),_=e("wd/R"),f=e("wxx3"),v=e("8Y7J"),S=e("AytR"),R=e("JIr8"),g=e("LRne"),I=e("3Ym9"),C=e("IheW"),A=e("v98y");let E=(()=>{class i{constructor(i,t){this.http=i,this.errorHandlerService=t}getImpositions(i){const t=`${S.a.apiBasePath}${S.a.endpoints.deposit.getImpositions}`,e={acuerdo:(+i).toString(),estadoImposicion:"TODAS",codigoEntidad:"1508",subacuerdo:"0"};return this.http.get(t,{params:e}).pipe(Object(a.a)(i=>{var t,e,o,n;return null===(n=null===(o=null===(e=null===(t=i)||void 0===t?void 0:t.data[0])||void 0===e?void 0:e.EE_O_ConsultaImposicionesBE)||void 0===o?void 0:o.Respuesta)||void 0===n?void 0:n.ListaImposicionesCliente}),Object(R.a)(i=>i.errorCode===I.a.IMP_NOT_FOUND?Object(g.a)([]):this.errorHandlerService.redirectErrorPage(i)))}createImposition(i){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.deposit.createImposition}`,i)}refundImposition(i){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.deposit.refund}`,i)}generateCreateImpositionOTP(i){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.deposit.createImpositionOTP}`,i)}generateRefundImpositionOTP(i){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.deposit.refundOTP}`,i)}getPdfImposition(i,t){return this.http.get(`${S.a.apiBasePath}${S.a.endpoints.deposit.getPdfImposition}`,{params:{acuerdo:i,subacuerdo:t}}).pipe(Object(a.a)(i=>{var t,e;return null===(e=null===(t=i.data)||void 0===t?void 0:t[0])||void 0===e?void 0:e.strMessage}))}getRequiredDoc(){return this.http.get(`${S.a.apiBasePath}${S.a.endpoints.deposit.getRequiredDoc}`)}}return i.\u0275fac=function(t){return new(t||i)(v.Wb(C.b),v.Wb(A.a))},i.\u0275prov=v.Ib({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var y=e("vHNk"),w=e("2PZR"),O=e("LqlI"),P=e("iInd"),j=e("Gy/1"),M=e("9yxR"),k=e("SVse"),D=e("0rpK"),T=e("YonX"),F=e("TSSN");function G(i,t){if(1&i&&(v.Sb(0,"div",7),v.Sb(1,"p"),v.Ec(2),v.dc(3,"translate"),v.Rb(),v.Sb(4,"p"),v.Ec(5),v.Rb(),v.Rb()),2&i){const i=v.cc(2);v.Ab(2),v.Fc(v.ec(3,2,"deposit_imposition_detail_number")),v.Ab(3),v.Fc(null==i.imposition?null:i.imposition.subacuerdo)}}function N(i,t){if(1&i&&(v.Sb(0,"div",7),v.Sb(1,"p"),v.Ec(2),v.dc(3,"translate"),v.Rb(),v.Sb(4,"p"),v.Ec(5),v.dc(6,"date"),v.Rb(),v.Rb()),2&i){const i=v.cc(2);v.Ab(2),v.Fc(v.ec(3,2,"deposit_imposition_detail_expiration")),v.Ab(3),v.Fc(v.fc(6,4,null==i.imposition?null:i.imposition.fechaVencimiento,"dd/MM/yyyy"))}}function $(i,t){if(1&i&&(v.Sb(0,"div",7),v.Sb(1,"p"),v.Ec(2),v.dc(3,"translate"),v.Rb(),v.Sb(4,"p"),v.Ec(5),v.dc(6,"number"),v.Rb(),v.Rb()),2&i){const i=v.cc(2);v.Ab(2),v.Fc(v.ec(3,2,"deposit_imposition_detail_interest")),v.Ab(3),v.Gc("",v.fc(6,4,null==i.imposition?null:i.imposition.tin,"1.2-4")," %")}}function B(i,t){if(1&i&&(v.Sb(0,"div",7),v.Sb(1,"p"),v.Ec(2),v.dc(3,"translate"),v.Rb(),v.Sb(4,"p"),v.Ec(5),v.dc(6,"date"),v.Rb(),v.Rb()),2&i){const i=v.cc(2);v.Ab(2),v.Fc(v.ec(3,2,"deposit_imposition_detail_liquidation")),v.Ab(3),v.Fc(v.fc(6,4,null==i.imposition?null:i.imposition.fechaProximaLiquidacion,"dd/MM/yyyy"))}}function x(i,t){if(1&i){const i=v.Tb();v.Sb(0,"button",9),v.ac("click",(function(){return v.wc(i),v.cc(2).refundImposition()})),v.Ec(1),v.dc(2,"translate"),v.Rb()}2&i&&(v.Ab(1),v.Gc(" ",v.ec(2,1,"deposit_cancel_imposition_button")," "))}function L(i,t){if(1&i){const i=v.Tb();v.Sb(0,"button",9),v.ac("click",(function(){v.wc(i);const t=v.cc(2);return t.showReceipt.emit(t.imposition)})),v.Ec(1),v.dc(2,"translate"),v.Rb()}2&i&&(v.Ab(1),v.Gc(" ",v.ec(2,1,"deposit_show_imposition_receipt_button")," "))}function H(i,t){if(1&i&&(v.Sb(0,"div",5),v.Cc(1,G,6,4,"div",6),v.Cc(2,N,7,7,"div",6),v.Cc(3,$,7,7,"div",6),v.Cc(4,B,7,7,"div",6),v.Sb(5,"div",7),v.Cc(6,x,3,3,"button",8),v.Cc(7,L,3,3,"button",8),v.Rb(),v.Rb()),2&i){const i=v.cc();v.Ab(1),v.jc("ngIf",null==i.imposition?null:i.imposition.subacuerdo),v.Ab(1),v.jc("ngIf",null==i.imposition?null:i.imposition.fechaVencimiento),v.Ab(1),v.jc("ngIf",null==i.imposition?null:i.imposition.tin),v.Ab(1),v.jc("ngIf",null==i.imposition?null:i.imposition.fechaProximaLiquidacion),v.Ab(2),v.jc("ngIf",i.isActive&&i.canRefundImposition),v.Ab(1),v.jc("ngIf",i.isActive)}}const q=function(i){return{term:i}};let U=(()=>{class i{constructor(){this.askRefundImposition=new v.n,this.waitToRefundImposition=new v.n,this.showReceipt=new v.n,this.showDetails=!1}toggleDetails(){this.showDetails=!this.showDetails}refundImposition(){_().isSame(_(this.imposition.fechaValor),"day")?this.waitToRefundImposition.emit():this.askRefundImposition.emit(this.imposition)}get canRefundImposition(){const i=_(this.imposition.fechaVencimiento),t=this.clientType===f.a.Employee;return t||!t&&_().isSameOrAfter(i)}get isActive(){var i;return(null===(i=this.imposition)||void 0===i?void 0:i.descripcionEstadoImposicion)===l.d.Activo}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=v.Gb({type:i,selectors:[["app-imposition-item"]],inputs:{imposition:"imposition",clientType:"clientType"},outputs:{askRefundImposition:"askRefundImposition",waitToRefundImposition:"waitToRefundImposition",showReceipt:"showReceipt"},decls:19,vars:20,consts:[[1,"table__body__row",3,"ngClass","click"],[1,"table__body__title"],[1,"table__body__title__group"],[1,"table__body__title__group__col"],["class","table__body__detail",4,"ngIf"],[1,"table__body__detail"],["class","table__body__detail__row",4,"ngIf"],[1,"table__body__detail__row"],[3,"click",4,"ngIf"],[3,"click"]],template:function(i,t){1&i&&(v.Sb(0,"div",0),v.ac("click",(function(){return t.toggleDetails()})),v.Sb(1,"div",1),v.Sb(2,"div",2),v.Sb(3,"p",3),v.Ec(4),v.dc(5,"date"),v.Rb(),v.Rb(),v.Sb(6,"div",2),v.Sb(7,"p",3),v.Ec(8),v.dc(9,"translate"),v.dc(10,"lowercase"),v.Rb(),v.Sb(11,"p",3),v.Ec(12),v.dc(13,"translate"),v.Rb(),v.Rb(),v.Sb(14,"div",2),v.Sb(15,"p",3),v.Ec(16),v.dc(17,"currency"),v.Rb(),v.Rb(),v.Rb(),v.Cc(18,H,8,6,"div",4),v.Rb()),2&i&&(v.jc("ngClass",t.isActive?"active":"inactive"),v.Ab(4),v.Gc(" ",v.fc(5,6,null==t.imposition?null:t.imposition.fechaValor,"dd/MM/yyyy")," "),v.Ab(4),v.Gc(" ",v.ec(9,9,v.ec(10,11,"deposit_imposition_detail_status_"+(null==t.imposition?null:t.imposition.descripcionEstadoImposicion)))," "),v.Ab(4),v.Gc(" ",v.fc(13,13,"deposit_imposition_detail_term_web",v.nc(18,q,(null==t.imposition?null:t.imposition.duracion)||0))," "),v.Ab(4),v.Gc(" ",v.ec(17,16,null==t.imposition?null:t.imposition.importeNominal)," "),v.Ab(2),v.jc("ngIf",t.showDetails))},directives:[k.n,k.p],pipes:[k.f,F.d,k.m,k.d,k.g],styles:[""],changeDetection:0}),i})();var Q=e("PQaN"),z=e("d2bA"),W=e("zcjR"),V=e("tepA"),J=e("nxmR"),K=e("kktJ");const X=["refundOtpModal"],Y=["confirmRefundModal"],Z=["confirmCancelDepositModal"],ii=["invalidCancelationModal"],ti=["successCancelDeposit"];function ei(i,t){if(1&i){const i=v.Tb();v.Sb(0,"button",30),v.ac("click",(function(){v.wc(i);const t=v.cc(2).ngIf;return v.cc().askCancelDeposit(null==t?null:t.impositions)})),v.Ec(1),v.dc(2,"translate"),v.Rb()}2&i&&(v.Ab(1),v.Gc(" ",v.ec(2,1,"deposit_cancel_deposit")," "))}function oi(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-imposition-item",36),v.ac("askRefundImposition",(function(t){return v.wc(i),v.cc(5).askRefundImposition(t)}))("waitToRefundImposition",(function(){v.wc(i),v.cc(4);const t=v.tc(12);return v.cc().openModal(t)}))("showReceipt",(function(t){v.wc(i);const e=v.cc(4).ngIf;return v.cc().onShowReceipt(null==e?null:e.deposit,t)})),v.Rb()}if(2&i){const i=t.$implicit,e=v.cc(4).ngIf;v.jc("imposition",i)("clientType",null==e?null:null==e.currentCustomer?null:null==e.currentCustomer.DatosPersonales?null:e.currentCustomer.DatosPersonales.clientType)}}function ni(i,t){if(1&i&&(v.Sb(0,"div",33),v.Sb(1,"p",34),v.Ec(2),v.dc(3,"date"),v.Rb(),v.Cc(4,oi,1,2,"app-imposition-item",35),v.Rb()),2&i){const i=t.$implicit;v.Ab(2),v.Gc(" ",v.fc(3,2,i.key,"dd/MM/yyyy")," "),v.Ab(2),v.jc("ngForOf",i.value)}}function ci(i,t){if(1&i&&(v.Sb(0,"div",31),v.Cc(1,ni,5,5,"div",32),v.dc(2,"sortBy"),v.dc(3,"keyvalue"),v.dc(4,"groupBy"),v.Rb()),2&i){const i=v.cc(2).ngIf,t=v.cc();v.Ab(1),v.jc("ngForOf",v.gc(2,2,v.ec(3,6,v.fc(4,8,i.impositions,"fechaValor")),"desc","key"))("ngForTrackBy",t.trackByDates)}}function si(i,t){1&i&&(v.Sb(0,"div",31),v.Sb(1,"div",37),v.Sb(2,"p",38),v.Ec(3),v.dc(4,"translate"),v.Rb(),v.Rb(),v.Rb()),2&i&&(v.Ab(3),v.Gc(" ",v.ec(4,1,"deposit_empty_impositions_list_message")," "))}function ai(i,t){if(1&i&&(v.Sb(0,"div",15),v.Sb(1,"div",16),v.Sb(2,"div",17),v.Sb(3,"div",18),v.Sb(4,"div",19),v.Sb(5,"h1"),v.Ec(6),v.dc(7,"translate"),v.Rb(),v.Sb(8,"p"),v.Ec(9),v.dc(10,"formatIban"),v.Rb(),v.Rb(),v.Sb(11,"div",19),v.Sb(12,"p"),v.Ec(13),v.dc(14,"translate"),v.Rb(),v.Sb(15,"h1"),v.Ec(16),v.dc(17,"currency"),v.Rb(),v.Rb(),v.Rb(),v.Sb(18,"div",20),v.Sb(19,"button",21),v.Ec(20),v.dc(21,"translate"),v.Rb(),v.Cc(22,ei,3,3,"button",22),v.Rb(),v.Rb(),v.Sb(23,"div",23),v.Sb(24,"div",24),v.Sb(25,"h1"),v.Ec(26),v.dc(27,"currency"),v.Rb(),v.Sb(28,"a",25),v.Ec(29),v.dc(30,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(31,"div",26),v.Sb(32,"div",27),v.Sb(33,"div",28),v.Sb(34,"p"),v.Ec(35),v.dc(36,"translate"),v.Rb(),v.Sb(37,"p"),v.Ec(38),v.dc(39,"translate"),v.Rb(),v.Sb(40,"p"),v.Ec(41),v.dc(42,"translate"),v.Rb(),v.Sb(43,"p"),v.Ec(44),v.dc(45,"translate"),v.Rb(),v.Rb(),v.Cc(46,ci,5,11,"div",29),v.Cc(47,si,5,3,"div",29),v.Rb(),v.Rb(),v.Rb()),2&i){const i=v.cc().ngIf,t=v.cc();v.Ab(6),v.Fc(v.ec(7,14,"deposit_title")),v.Ab(3),v.Fc(v.ec(10,16,null==i.deposit?null:i.deposit.IBAN)),v.Ab(4),v.Fc(v.ec(14,18,"deposit_balance")),v.Ab(3),v.Fc(v.ec(17,20,null==i.deposit?null:i.deposit.Balance)),v.Ab(4),v.Gc(" ",v.ec(21,22,"deposit_new_imposition_title")," "),v.Ab(2),v.jc("ngIf",t.canShowCancelDeposit(null==i?null:i.impositions,null==i?null:null==i.currentCustomer?null:null==i.currentCustomer.DatosPersonales?null:i.currentCustomer.DatosPersonales.clientType)),v.Ab(4),v.Fc(v.ec(27,24,null==i.deposit?null:i.deposit.Balance)),v.Ab(3),v.Fc(v.ec(30,26,"deposit_go_to_asociated_account")),v.Ab(6),v.Fc(v.ec(36,28,"deposit_imposition_date")),v.Ab(3),v.Fc(v.ec(39,30,"deposit_imposition_description")),v.Ab(3),v.Fc(v.ec(42,32,"deposit_imposition_term")),v.Ab(3),v.Fc(v.ec(45,34,"deposit_imposition_amount")),v.Ab(2),v.jc("ngIf",!t.emptyImpositions(i.impositions)),v.Ab(1),v.jc("ngIf",t.emptyImpositions(i.impositions))}}function ri(i,t){if(1&i){const i=v.Tb();v.Sb(0,"button",39),v.ac("click",(function(){v.wc(i);const t=v.cc().ngIf;return v.cc().askCancelDeposit(null==t?null:t.impositions)})),v.Ec(1),v.dc(2,"translate"),v.Rb()}2&i&&(v.Ab(1),v.Gc(" ",v.ec(2,1,"deposit_cancel_deposit")," "))}function di(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-info-modal",40),v.ac("hide",(function(){return v.wc(i),v.cc(2).closeModal()})),v.Rb()}}function li(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-info-modal",41),v.ac("hide",(function(){return v.wc(i),v.cc(2).closeModal()})),v.Rb()}}function bi(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-info-modal",42),v.ac("hide",(function(){return v.wc(i),v.cc(2).closeModal()})),v.Rb()}}function pi(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-confirm-modal",43),v.ac("confirm",(function(t){v.wc(i);const e=v.cc().ngIf;return v.cc().onCancelDeposit(t,null==e?null:e.deposit)})),v.Rb()}}function ui(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-confirm-modal",44),v.ac("confirm",(function(t){v.wc(i);const e=v.cc().ngIf;return v.cc().confirmRefundImposition(t,e.deposit.Acuerdo)})),v.Rb()}}function mi(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-otp-form",45),v.ac("repeat",(function(){v.wc(i);const t=v.cc().ngIf;return v.cc().generateRefundOtp(t.deposit.Acuerdo)}))("send",(function(t){v.wc(i);const e=v.cc().ngIf;return v.cc().refundImposition(t,e.deposit.Acuerdo)}))("hide",(function(){return v.wc(i),v.cc(2).closeModal()})),v.Rb()}if(2&i){const i=v.cc(2);v.jc("invalidCode",i.invalidRefundOtpCode)}}function hi(i,t){if(1&i&&(v.Qb(0),v.Sb(1,"div",1),v.Sb(2,"div",2),v.Cc(3,ai,48,36,"div",3),v.Sb(4,"div",4),v.Nb(5,"app-aside-banner",5),v.Rb(),v.Rb(),v.Rb(),v.Sb(6,"div",6),v.Cc(7,ri,3,3,"button",7),v.Sb(8,"button",8),v.Ec(9),v.dc(10,"translate"),v.Rb(),v.Rb(),v.Cc(11,di,1,0,"ng-template",null,9,v.Dc),v.Cc(13,li,1,0,"ng-template",null,10,v.Dc),v.Cc(15,bi,1,0,"ng-template",null,11,v.Dc),v.Cc(17,pi,1,0,"ng-template",null,12,v.Dc),v.Cc(19,ui,1,0,"ng-template",null,13,v.Dc),v.Cc(21,mi,1,1,"ng-template",null,14,v.Dc),v.Pb()),2&i){const i=t.ngIf,e=v.cc();v.Ab(3),v.jc("ngIf",i.globalPosition),v.Ab(1),v.jc("appBannerBackground",e.banners.deposit),v.Ab(1),v.jc("globalPosition",i.globalPosition),v.Ab(2),v.jc("ngIf",e.canShowCancelDeposit(null==i?null:i.impositions,null==i?null:null==i.currentCustomer?null:null==i.currentCustomer.DatosPersonales?null:i.currentCustomer.DatosPersonales.clientType)),v.Ab(2),v.Gc(" ",v.ec(10,5,"deposit_new_imposition_title")," ")}}let _i=(()=>{class i{constructor(i,t,e,n,c,s,a,r,d,l){this.depositService=i,this.headerService=t,this.globalPositionService=e,this.modalService=n,this.errorHandler=c,this.router=s,this.activatedRoute=a,this.caseService=r,this.accountService=d,this.banners=l,this.state$=this.createStateStream(),this.invalidRefundOtpCode=!1,this.subs=new o.a}ngOnInit(){this.headerService.updateTitle("menu_deposits_web"),this.globalPositionService.fetchGlobalPosition()}ngOnDestroy(){this.subs.unsubscribe(),this.closeModal()}openModal(i){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(i))}closeModal(){var i;null===(i=this.modalRef)||void 0===i||i.hide()}askCancelDeposit(i){var t;const e=null===(t=i)||void 0===t?void 0:t.filter(i=>i.descripcionEstadoImposicion===l.d.Activo).length;this.openModal(0===e?this.confirmCancelDepositModal:this.invalidCancelationModal)}onCancelDeposit(i,t){this.closeModal(),i&&this.cancelDeposit(t)}askRefundImposition(i){this.selectedImposition=i,this.openModal(this.confirmRefundModal)}onShowReceipt(i,t){var e,o;const n=`imposition-receipt-${i.Acuerdo}-${t.subacuerdo}.pdf`;this.subs.add(this.depositService.getPdfImposition(null===(e=i)||void 0===e?void 0:e.Acuerdo,null===(o=t)||void 0===o?void 0:o.subacuerdo).pipe(Object(m.a)()).subscribe(i=>{const t=document.createElement("a");t.href=URL.createObjectURL(i),t.download=n,t.click()},i=>{this.errorHandler.showError(i)}))}confirmRefundImposition(i,t){this.closeModal(),i&&this.generateRefundOtp(t)}generateRefundOtp(i){var t,e;this.invalidRefundOtpCode=!1,this.refundOtpId=null,this.subs.add(this.depositService.generateRefundImpositionOTP({depositAgreement:i,impositionAgreement:null===(t=this.selectedImposition)||void 0===t?void 0:t.subacuerdo,nominalAmount:String(parseFloat(null===(e=this.selectedImposition)||void 0===e?void 0:e.importeNominal))}).subscribe(({otpId:i})=>{this.openModal(this.refundOtpModal),this.refundOtpId=i},i=>{this.errorHandler.showError(i)}))}refundImposition(i,t){var e,o;this.subs.add(this.depositService.refundImposition({depositAgreement:t,impositionAgreement:null===(e=this.selectedImposition)||void 0===e?void 0:e.subacuerdo,nominalAmount:null===(o=this.selectedImposition)||void 0===o?void 0:o.importeNominal,otp:{otpId:this.refundOtpId,secretKey:i}}).subscribe(()=>{var i;this.closeModal(),this.router.navigate(["./refund-success"],{queryParams:{importeNominal:null===(i=this.selectedImposition)||void 0===i?void 0:i.importeNominal},skipLocationChange:!0,relativeTo:this.activatedRoute})},i=>{Object(d.j)(i)?this.invalidRefundOtpCode=!0:(this.closeModal(),this.errorHandler.showError(i))}))}onConfirmRefundSuccessModal(){this.globalPositionService.fetchGlobalPosition(),this.closeModal()}trackByDates(i){return i.date}trackByImposition(i){return i.subacuerdo}emptyImpositions(i){return i&&0===i.length}canShowCancelDeposit(i,t){var e;const o=null===(e=i)||void 0===e?void 0:e.map(i=>_(i.fechaVencimiento)),n=_.max(o),c=t===f.a.Employee;return c||!c&&_().isSameOrAfter(n)}cancelDeposit(i){var t;const e=new b.a;e.type=p.a.TOTAL_CANCELLATION_OF_THE_TERM_DEPOSIT,e.recordTypeDeveloperName=u.a.CANCELLATIONS,e.description="Cancelaci\xf3n de dep\xf3sito",e.subject="Cancelaci\xf3n de dep\xf3sito",e.newIBAN=null===(t=i)||void 0===t?void 0:t.IBAN,this.subs.add(this.caseService.createCase({caseList:[e]}).subscribe(()=>{this.closeModal(),this.openModal(this.successCancelDepositModal)},i=>{this.errorHandler.showError(i)}))}createStateStream(){const i=this.globalPositionService.globalPosition$.pipe(Object(c.a)(i=>!!i));return Object(n.a)([i,i.pipe(Object(d.e)()).pipe(Object(s.a)(i=>{i||this.router.navigate(["./hire"],{relativeTo:this.activatedRoute})})),i.pipe(Object(d.d)()),this.createImpositionsStream(),this.accountService.currentCustomer$]).pipe(Object(a.a)(([i,t,e,o,n])=>({globalPosition:i,deposit:t,account:e,impositions:o,currentCustomer:n})))}createImpositionsStream(){return this.globalPositionService.globalPosition$.pipe(Object(d.e)(),Object(c.a)(i=>{var t;return!!(null===(t=i)||void 0===t?void 0:t.Acuerdo)}),Object(r.a)(i=>{var t;return this.depositService.getImpositions(null===(t=i)||void 0===t?void 0:t.Acuerdo)}))}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(E),v.Mb(y.a),v.Mb(w.a),v.Mb(O.b),v.Mb(A.a),v.Mb(P.d),v.Mb(P.a),v.Mb(j.a),v.Mb(M.a),v.Mb(h.a))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-deposit"]],viewQuery:function(i,t){var e;1&i&&(v.Ic(X,!0),v.Ic(Y,!0),v.Ic(Z,!0),v.Ic(ii,!0),v.Ic(ti,!0)),2&i&&(v.sc(e=v.bc())&&(t.refundOtpModal=e.first),v.sc(e=v.bc())&&(t.confirmRefundModal=e.first),v.sc(e=v.bc())&&(t.confirmCancelDepositModal=e.first),v.sc(e=v.bc())&&(t.invalidCancelationModal=e.first),v.sc(e=v.bc())&&(t.successCancelDepositModal=e.first))},decls:2,vars:3,consts:[[4,"ngIf"],[1,"max-size","deposit"],[1,"main"],["class","main-col",4,"ngIf"],[1,"aside-col",3,"appBannerBackground"],[3,"globalPosition"],[1,"main__button","group-button"],["type","button","class","btn--secondary",3,"click",4,"ngIf"],["type","button","routerLink","./new-imposition",1,"btn--primary"],["waitToRefundModal",""],["invalidCancelationModal",""],["successCancelDeposit",""],["confirmCancelDepositModal",""],["confirmRefundModal",""],["refundOtpModal",""],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__header__buttons"],["type","button","routerLink","./new-imposition",1,"btn--primary-small"],["type","button","class","btn--terciary-small",3,"click",4,"ngIf"],[1,"main__header__mobile"],[1,"main__header__mobile__col"],["href","javascript:;","routerLink","../../transactions"],[1,"main__body"],[1,"table"],[1,"table__header"],["class","table__body",4,"ngIf"],["type","button",1,"btn--terciary-small",3,"click"],[1,"table__body"],["class","table__body__section",4,"ngFor","ngForOf","ngForTrackBy"],[1,"table__body__section"],[1,"table__body__section__date"],[3,"imposition","clientType","askRefundImposition","waitToRefundImposition","showReceipt",4,"ngFor","ngForOf"],[3,"imposition","clientType","askRefundImposition","waitToRefundImposition","showReceipt"],[1,"table__body__title"],[1,"table__body__title__group__col"],["type","button",1,"btn--secondary",3,"click"],["head","deposit_cancel_imposition_title","description","deposit_cancel_imposition_wait_text","type","warning",3,"hide"],["head","deposit_cancel_title","description","deposit_cancel_subtitle","type","warning",3,"hide"],["head","deposit_cancel_success_title","description","deposit_cancel_success_description","type","success",3,"hide"],["description","deposit_cancel2_subtitle_web",3,"confirm"],["description","deposit_cancel_imposition_text_web",3,"confirm"],[3,"invalidCode","repeat","send","hide"]],template:function(i,t){1&i&&(v.Cc(0,hi,23,7,"ng-container",0),v.dc(1,"async")),2&i&&v.jc("ngIf",v.ec(1,1,t.state$))},directives:[k.p,D.a,T.a,P.e,P.g,k.o,U,Q.a,z.a,W.a],pipes:[k.b,F.d,V.a,k.d,J.a,k.i,K.a,k.f],encapsulation:2,changeDetection:0}),i})();var fi=e("1uah"),vi=e("i9jL");let Si=(()=>{class i{constructor(i,t,e){this.depositService=i,this.globalPositionService=t,this.dictionaryService=e,this.state$=this.createState(),this.impositionConditions$=this.dictionaryService.getImpositionConditions(),this.subs=new o.a}initImposition(i){this.imposition=i}fetchGlobalPosition(){this.globalPositionService.fetchGlobalPosition()}generateOtp(i,t){this.referenceOTP=null;const e=i=>this.depositService.generateCreateImpositionOTP(Object.assign({},i));this.subs.add(this.state$.pipe(Object(r.a)(i=>{var t,o;return e(Object.assign(Object.assign({},this.imposition),{depositAgreement:null===(o=null===(t=i)||void 0===t?void 0:t.deposit)||void 0===o?void 0:o.Acuerdo}))})).subscribe(({otpId:t})=>{var e;this.referenceOTP=t,null===(e=i)||void 0===e||e()},i=>{var e;return null===(e=t)||void 0===e?void 0:e(i)}))}createImposition(i,t,e){this.subs.add(this.state$.pipe(Object(r.a)(t=>{var e;return this.depositService.createImposition(Object.assign(Object.assign({},this.imposition),{depositAgreement:null===(e=t)||void 0===e?void 0:e.deposit.Acuerdo,otp:{secretKey:i,otpId:this.referenceOTP}}))})).subscribe(()=>{var i;null===(i=t)||void 0===i||i()},i=>{var t;null===(t=e)||void 0===t||t(i)}))}destroy(){this.subs.unsubscribe()}createState(){return Object(fi.a)(this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(d.e)()),this.globalPositionService.globalPosition$.pipe(Object(d.d)())).pipe(Object(a.a)(([i,t,e])=>({globalPosition:i,deposit:t,account:e})))}}return i.\u0275fac=function(t){return new(t||i)(v.Wb(E),v.Wb(w.a),v.Wb(vi.a))},i.\u0275prov=v.Ib({token:i,factory:i.\u0275fac}),i})();var Ri=e("s7LF"),gi=e("dZRt");function Ii(i){var t,e;const o=i.get("impositionCondition"),n=i.get("amount"),c=o.value,s=Object(gi.b)(n.value);return c?(null===(t=c)||void 0===t?void 0:t.maximum)<s?{maxImposition:!0}:(null===(e=c)||void 0===e?void 0:e.minimum)>s?{minImposition:!0}:null:null}const Ci=S.a.applications.documents,Ai={impositionConditions:`${Ci}/documentacion-legal/condiciones-imposicion-RenaultBank.pdf`,particularConditions:`${Ci}/documentacion-legal/informacion-precontractual-deposito-RenaultBank.pdf`},Ei={impositionConditions:`${Ci}/documentacion-legal/condiciones-imposicion-publico-RenaultBank.pdf`,particularConditions:`${Ci}/documentacion-legal/informacion-precontractual-deposito-publico-RenaultBank.pdf`},yi=new v.q("EXTERNAL_DOCUMENTS",{providedIn:"root",factory:()=>{var i,t;return(null===(t=null===(i=Object(v.T)(M.a).currentCustomer)||void 0===i?void 0:i.DatosPersonales)||void 0===t?void 0:t.clientType)===f.a.Employee?Ai:Ei}});var wi=e("wTG2");function Oi(i,t){1&i&&(v.Sb(0,"p",19),v.Nb(1,"span",20),v.Ec(2),v.dc(3,"translate"),v.Rb()),2&i&&(v.Ab(2),v.Gc(" ",v.ec(3,1,"deposit_hire_amount_account_insufficient")," "))}const Pi=function(i){return{amount:i}};function ji(i,t){if(1&i&&(v.Sb(0,"p",19),v.Nb(1,"span",20),v.Ec(2),v.dc(3,"translate"),v.dc(4,"currency"),v.Rb()),2&i){const i=v.cc(2);v.Ab(2),v.Gc(" ",v.fc(3,1,"deposit_hire_minnimum_import_web",v.nc(6,Pi,v.ec(4,4,null==i.impositionCondition?null:i.impositionCondition.minimum)))," ")}}function Mi(i,t){if(1&i&&(v.Sb(0,"p",19),v.Nb(1,"span",20),v.Ec(2),v.dc(3,"translate"),v.dc(4,"currency"),v.Rb()),2&i){const i=v.cc(2);v.Ab(2),v.Gc(" ",v.fc(3,1,"deposit_hire_maximum_import_web",v.nc(6,Pi,v.ec(4,4,null==i.impositionCondition?null:i.impositionCondition.maximum)))," ")}}const ki=function(i){return{time:i}};function Di(i,t){1&i&&(v.Ec(0),v.dc(1,"translate")),2&i&&v.Gc(" ",v.fc(1,1,"deposit_time_options_web",v.nc(4,ki,t.item.duration))," ")}function Ti(i,t){1&i&&(v.Sb(0,"p",19),v.Nb(1,"span",20),v.Ec(2),v.dc(3,"translate"),v.Rb()),2&i&&(v.Ab(2),v.Gc("",v.ec(3,1,"deposit_new_imposition_must_read_conditions")," "))}const Fi=function(i){return{error:i}};function Gi(i,t){if(1&i){const i=v.Tb();v.Sb(0,"form",2),v.ac("submit",(function(){return v.wc(i),v.cc().onSubmit()})),v.Sb(1,"div",3),v.Sb(2,"label"),v.Ec(3),v.dc(4,"translate"),v.Rb(),v.Sb(5,"p",4),v.Ec(6),v.dc(7,"formatIban"),v.Rb(),v.Rb(),v.Sb(8,"div",3),v.Sb(9,"label"),v.Ec(10),v.dc(11,"translate"),v.Rb(),v.Sb(12,"p",4),v.Ec(13),v.dc(14,"formatIban"),v.Rb(),v.Rb(),v.Sb(15,"div",3),v.Sb(16,"label"),v.Ec(17),v.dc(18,"translate"),v.Rb(),v.Sb(19,"p",4),v.Ec(20),v.dc(21,"number"),v.Rb(),v.Rb(),v.Sb(22,"div",3),v.Sb(23,"label"),v.Ec(24),v.dc(25,"translate"),v.Rb(),v.Nb(26,"input",5),v.Cc(27,Oi,4,3,"p",6),v.Cc(28,ji,5,8,"p",6),v.Cc(29,Mi,5,8,"p",6),v.Rb(),v.Sb(30,"div",7),v.Sb(31,"label"),v.Ec(32),v.dc(33,"translate"),v.Rb(),v.Sb(34,"ng-select",8),v.dc(35,"translate"),v.Cc(36,Di,2,6,"ng-template",9),v.Rb(),v.Rb(),v.Sb(37,"div",10),v.Nb(38,"input",11),v.Sb(39,"label",12),v.Ec(40),v.dc(41,"translate"),v.Sb(42,"a",13),v.ac("click",(function(){return v.wc(i),v.cc().readConditions()})),v.Ec(43),v.dc(44,"translate"),v.Rb(),v.Rb(),v.Nb(45,"span",14),v.Cc(46,Ti,4,3,"p",6),v.Rb(),v.Sb(47,"div",15),v.Sb(48,"button",16),v.Ec(49),v.dc(50,"translate"),v.Rb(),v.Sb(51,"button",17),v.Ec(52),v.dc(53,"translate"),v.Rb(),v.Rb(),v.Sb(54,"div",18),v.Sb(55,"button",17),v.Ec(56),v.dc(57,"translate"),v.Rb(),v.Sb(58,"button",16),v.Ec(59),v.dc(60,"translate"),v.Rb(),v.Rb(),v.Rb()}if(2&i){const i=v.cc();v.jc("formGroup",i.form),v.Ab(3),v.Fc(v.ec(4,27,"deposit_sender_account")),v.Ab(3),v.Fc(v.ec(7,29,null==i.account?null:i.account.IBAN)),v.Ab(4),v.Fc(v.ec(11,31,"deposit_receiver_account")),v.Ab(3),v.Fc(v.ec(14,33,null==i.deposit?null:i.deposit.IBAN)),v.Ab(4),v.Fc(v.ec(18,35,"deposit_new_imposition_account_balance")),v.Ab(3),v.Fc(v.fc(21,37,(null==i.account?null:i.account.Balance)||0,"1.2-2")),v.Ab(4),v.Fc(v.ec(25,40,"deposit_amount")),v.Ab(2),v.jc("allowDecimal",!1)("ngClass",v.nc(58,Fi,i.hasError(i.form.get("amount"))||i.hasMaxAmountError||i.hasMinAmountError)),v.Ab(1),v.jc("ngIf",i.hasBalanceError&&!i.hasMinAmountError&&!i.hasMaxAmountError),v.Ab(1),v.jc("ngIf",i.hasMinAmountError),v.Ab(1),v.jc("ngIf",i.hasMaxAmountError),v.Ab(3),v.Fc(v.ec(33,42,"deposit_time")),v.Ab(2),v.jc("items",i.impositionConditions)("placeholder",v.ec(35,44,"deposit_time_election"))("ngClass",v.nc(60,Fi,i.hasError(i.form.get("impositionCondition"))))("searchable",!1)("clearable",!1),v.Ab(4),v.jc("ngClass",v.nc(62,Fi,i.hasError(i.form.get("conditions")))),v.Ab(2),v.Gc("",v.ec(41,46,"deposit_new_imposition_condition_1_web"),"\xa0 "),v.Ab(3),v.Gc(" ",v.ec(44,48,"deposit_new_imposition_condition_2_web"),""),v.Ab(3),v.jc("ngIf",!i.conditionsRead&&i.submitted),v.Ab(3),v.Gc(" ",v.ec(50,50,"generic_continue_button")," "),v.Ab(3),v.Gc(" ",v.ec(53,52,"deposit_cancel")," "),v.Ab(4),v.Gc(" ",v.ec(57,54,"deposit_cancel")," "),v.Ab(3),v.Gc(" ",v.ec(60,56,"deposit_continue")," ")}}const Ni=function(i){return{term:i}};function $i(i,t){if(1&i){const i=v.Tb();v.Sb(0,"div",21),v.Sb(1,"div",3),v.Sb(2,"label"),v.Ec(3),v.dc(4,"translate"),v.Rb(),v.Sb(5,"p"),v.Ec(6),v.dc(7,"formatIban"),v.Rb(),v.Rb(),v.Sb(8,"div",3),v.Sb(9,"label"),v.Ec(10),v.dc(11,"translate"),v.Rb(),v.Sb(12,"p"),v.Ec(13),v.dc(14,"formatIban"),v.Rb(),v.Rb(),v.Sb(15,"div",3),v.Sb(16,"label"),v.Ec(17),v.dc(18,"translate"),v.Rb(),v.Sb(19,"p"),v.Ec(20),v.dc(21,"currency"),v.Rb(),v.Rb(),v.Sb(22,"div",3),v.Sb(23,"label"),v.Ec(24),v.dc(25,"translate"),v.Rb(),v.Sb(26,"p"),v.Ec(27),v.dc(28,"translate"),v.dc(29,"number"),v.Rb(),v.Rb(),v.Sb(30,"div",3),v.Sb(31,"label"),v.Ec(32),v.dc(33,"translate"),v.Rb(),v.Sb(34,"p"),v.Ec(35,"0,00 %"),v.Rb(),v.Rb(),v.Sb(36,"div",15),v.Sb(37,"button",22),v.ac("click",(function(){v.wc(i);const t=v.cc();return t.makeImposition.emit(t.imposition)})),v.Ec(38),v.dc(39,"translate"),v.Rb(),v.Rb(),v.Sb(40,"div",23),v.Sb(41,"button",24),v.ac("click",(function(){v.wc(i);const t=v.cc();return t.makeImposition.emit(t.imposition)})),v.Ec(42),v.dc(43,"translate"),v.Rb(),v.Rb(),v.Rb()}if(2&i){const i=v.cc();v.Ab(3),v.Fc(v.ec(4,11,"deposit_sender_account")),v.Ab(3),v.Fc(v.ec(7,13,null==i.account?null:i.account.IBAN)),v.Ab(4),v.Fc(v.ec(11,15,"deposit_receiver_account")),v.Ab(3),v.Fc(v.ec(14,17,null==i.deposit?null:i.deposit.IBAN)),v.Ab(4),v.Fc(v.ec(18,19,"deposit_new_impositon_amount")),v.Ab(3),v.Fc(v.ec(21,21,null==i.imposition?null:i.imposition.nominalAmount)),v.Ab(4),v.Fc(v.ec(25,23,"deposit_imposition_term")),v.Ab(3),v.Gc(" ",v.fc(28,25,"deposit_new_imposition_term_value_web",v.nc(36,Ni,v.ec(29,28,null==i.impositionCondition?null:i.impositionCondition.duration)))," "),v.Ab(5),v.Fc(v.ec(33,30,"deposit_new_imposition_fee")),v.Ab(6),v.Gc(" ",v.ec(39,32,"generic_confirm_button")," "),v.Ab(4),v.Gc(" ",v.ec(43,34,"generic_confirm_button")," ")}}let Bi=(()=>{class i{constructor(i,t){this.fb=i,this.externalDocuments=t,this.makeImposition=new v.n,this.submitted=!1,this.showConfirm=!1,this.conditionsRead=!1}get hasBalanceError(){const i=this.form.get("amount");return this.hasError(i)&&i.hasError("balanceError")}get hasMinAmountError(){return this.form.hasError("minImposition")}get hasMaxAmountError(){return this.form.hasError("maxImposition")}get impositionCondition(){var i;return null===(i=this.form)||void 0===i?void 0:i.get("impositionCondition").value}ngOnInit(){this.createForm()}onSubmit(){var i,t;if(this.submitted=!0,this.form.markAllAsTouched(),this.form.valid&&this.conditionsRead){const e=this.form.value.impositionCondition;this.imposition={nominalAmount:Object(gi.b)(this.form.value.amount).toString(),duration:null===(i=e)||void 0===i?void 0:i.duration,frecuency:null===(t=e)||void 0===t?void 0:t.settFrequency},this.showConfirm=!0}}hasError(i){return i.touched&&i.invalid}readConditions(){var i;this.conditionsRead=!0,null===(i=window)||void 0===i||i.open(this.externalDocuments.impositionConditions)}createForm(){var i,t;this.form=this.fb.group({amount:["",[Ri.r.required,(t=null===(i=this.account)||void 0===i?void 0:i.Balance,i=>{var e;return Object(gi.b)(null===(e=i)||void 0===e?void 0:e.value)>t?{balanceError:!0}:null})]],impositionCondition:[null,Ri.r.required],conditions:[!1,[Ri.r.requiredTrue]]},{validators:Ii})}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(Ri.c),v.Mb(yi))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-new-imposition-form"]],inputs:{impositionConditions:"impositionConditions",account:"account",deposit:"deposit"},outputs:{makeImposition:"makeImposition"},decls:3,vars:2,consts:[[3,"formGroup","submit",4,"ngIf","ngIfElse"],["confirm",""],[3,"formGroup","submit"],[1,"group-input"],[1,"input"],["formControlName","amount","type","text","appParseCurrency","","maxlength","10",3,"allowDecimal","ngClass"],["class","error-text",4,"ngIf"],[1,"group-input","input-select"],["formControlName","impositionCondition",3,"items","placeholder","ngClass","searchable","clearable"],["ng-label-tmp","","ng-option-tmp",""],[1,"group-input","input-checkbox"],["type","checkbox","formControlName","conditions","id","conditions",3,"ngClass"],["for","conditions"],["href","javascript:;",3,"click"],[1,"check","ico-check-2"],[1,"group-button"],["type","submit",1,"btn--primary"],["routerLink","../..","type","button",1,"btn--secondary"],[1,"main__button","group-button"],[1,"error-text"],[1,"ico-alert"],[1,"deposit-confirm"],["type","button",1,"btn--primary",3,"click"],[1,"main__button"],["type","submit",1,"btn--primary",3,"click"]],template:function(i,t){if(1&i&&(v.Cc(0,Gi,61,64,"form",0),v.Cc(1,$i,44,38,"ng-template",null,1,v.Dc)),2&i){const i=v.tc(2);v.jc("ngIf",!t.showConfirm)("ngIfElse",i)}},directives:[k.p,Ri.s,Ri.o,Ri.g,Ri.b,Ri.n,Ri.f,gi.a,Ri.i,k.n,wi.a,wi.d,wi.c,Ri.a,P.e],pipes:[F.d,V.a,k.g,k.d],encapsulation:2,changeDetection:0}),i})();const xi=["otpModal"];function Li(i,t){if(1&i){const i=v.Tb();v.Sb(0,"div",3),v.Sb(1,"div",4),v.Sb(2,"div",5),v.Sb(3,"div",6),v.Sb(4,"div",7),v.Sb(5,"div",8),v.Sb(6,"div",9),v.Sb(7,"h1"),v.Ec(8),v.dc(9,"translate"),v.Rb(),v.Sb(10,"p"),v.Ec(11),v.dc(12,"formatIban"),v.Rb(),v.Rb(),v.Sb(13,"div",9),v.Sb(14,"p"),v.Ec(15),v.dc(16,"translate"),v.Rb(),v.Sb(17,"h1"),v.Ec(18),v.dc(19,"currency"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(20,"div",10),v.Sb(21,"app-new-imposition-form",11),v.ac("makeImposition",(function(t){return v.wc(i),v.cc(2).onMakeImposition(t)})),v.dc(22,"async"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb()}if(2&i){const i=v.cc().ngIf,t=v.cc();v.Ab(8),v.Fc(v.ec(9,7,"deposit_new_imposition_title")),v.Ab(3),v.Fc(v.ec(12,9,null==i.deposit?null:i.deposit.IBAN)),v.Ab(4),v.Fc(v.ec(16,11,"deposit_new_imposition_account_balance")),v.Ab(3),v.Fc(v.ec(19,13,null==i.account?null:i.account.Balance)),v.Ab(3),v.jc("account",null==i?null:i.account)("deposit",null==i?null:i.deposit)("impositionConditions",v.ec(22,15,t.impositionConditions$))}}function Hi(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-otp-form",12),v.ac("send",(function(t){return v.wc(i),v.cc(2).createImposition(t)}))("repeat",(function(){return v.wc(i),v.cc(2).generateOtp()}))("hide",(function(){return v.wc(i),v.cc(2).closeModal()})),v.Rb()}if(2&i){const i=v.cc(2);v.jc("invalidCode",i.invalidImpositionOtpCode)}}function qi(i,t){if(1&i&&(v.Qb(0),v.Cc(1,Li,23,17,"div",1),v.Cc(2,Hi,1,1,"ng-template",null,2,v.Dc),v.Pb()),2&i){const i=t.ngIf;v.Ab(1),v.jc("ngIf",i.globalPosition)}}let Ui=(()=>{class i{constructor(i,t,e,o,n){this.modalService=i,this.router=t,this.route=e,this.errorHandler=o,this.impositionService=n,this.state$=this.impositionService.state$,this.impositionConditions$=this.impositionService.impositionConditions$,this.invalidImpositionOtpCode=!1}ngOnInit(){}ngOnDestroy(){this.closeModal(),this.impositionService.destroy()}openModal(i){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(i))}closeModal(){var i;null===(i=this.modalRef)||void 0===i||i.hide()}onMakeImposition(i){this.impositionService.initImposition(i),this.generateOtp()}generateOtp(){this.invalidImpositionOtpCode=!1,this.impositionService.generateOtp(()=>{this.openModal(this.otpModal)},i=>{this.errorHandler.showError(i)})}createImposition(i){this.impositionService.createImposition(i,()=>{this.closeModal(),this.navigateToSuccessPage()},i=>{Object(d.j)(i)?this.invalidImpositionOtpCode=!0:(this.closeModal(),this.errorHandler.showError(i))})}navigateToSuccessPage(){this.router.navigate(["../new-imposition-success"],{skipLocationChange:!0,relativeTo:this.route})}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(O.b),v.Mb(P.d),v.Mb(P.a),v.Mb(A.a),v.Mb(Si,2))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-new-imposition"]],viewQuery:function(i,t){var e;1&i&&v.Ic(xi,!0),2&i&&v.sc(e=v.bc())&&(t.otpModal=e.first)},features:[v.zb([Si])],decls:2,vars:3,consts:[[4,"ngIf"],["class","max-size deposit-form",4,"ngIf"],["otpModal",""],[1,"max-size","deposit-form"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[3,"account","deposit","impositionConditions","makeImposition"],[3,"invalidCode","send","repeat","hide"]],template:function(i,t){1&i&&(v.Cc(0,qi,4,1,"ng-container",0),v.dc(1,"async")),2&i&&v.jc("ngIf",v.ec(1,1,t.state$))},directives:[k.p,Bi,W.a],pipes:[k.b,F.d,V.a,k.d],encapsulation:2,changeDetection:0}),i})();var Qi=e("mrSG"),zi=e("z6cu"),Wi=e("wO+i"),Vi=e("aGrj"),Ji=e("nYR2"),Ki=e("5+tZ"),Xi=e("3E0/"),Yi=e("XNiG"),Zi=e("l7GE"),it=e("ZUHj");function tt(i){return t=>t.lift(new et(i,t))}class et{constructor(i,t){this.notifier=i,this.source=t}call(i,t){return t.subscribe(new ot(i,this.notifier,this.source))}}class ot extends Zi.a{constructor(i,t,e){super(i),this.notifier=t,this.source=e}error(i){if(!this.isStopped){let e=this.errors,o=this.retries,n=this.retriesSubscription;if(o)this.errors=null,this.retriesSubscription=null;else{e=new Yi.a;try{const{notifier:i}=this;o=i(e)}catch(t){return super.error(t)}n=Object(it.a)(this,o)}this._unsubscribeAndRecycle(),this.errors=e,this.retries=o,this.retriesSubscription=n,e.next(i)}}_unsubscribe(){const{errors:i,retriesSubscription:t}=this;i&&(i.unsubscribe(),this.errors=null),t&&(t.unsubscribe(),this.retriesSubscription=null),this.retries=null}notifyNext(i,t,e,o,n){const{_unsubscribe:c}=this;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=c,this.source.subscribe(this)}}let nt=(()=>{class i{constructor(i){this.http=i}newHiring(i){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.deposit.newHiring}`,null,{params:{productid:i}})}getPdfContract(){return this.http.get(`${S.a.apiBasePath}${S.a.endpoints.deposit.getPdfContract}`)}startSignProcessSubmit(){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.sign.startSignProcessSubmit}`,null).pipe(Object(a.a)(i=>{var t,e,o,n,c;if((null===(t=i)||void 0===t?void 0:t.code)===I.a.ERROR_SUBMIT)throw{errorCode:null===(e=i)||void 0===e?void 0:e.code,message:null===(o=i)||void 0===o?void 0:o.code};return null===(c=null===(n=i)||void 0===n?void 0:n.data[0])||void 0===c?void 0:c.uniqueId}))}startSignProcessBulkSign(){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.sign.startSignProcessBulkSign}`,null).pipe(Object(a.a)(i=>{var t,e,o,n,c;if((null===(t=i)||void 0===t?void 0:t.code)===I.a.ERROR_BULKSIGN||(null===(e=i)||void 0===e?void 0:e.code)===I.a.ERROR_BULKSIGN_REQUESTNEWSUBMIT)throw{errorCode:null===(o=i)||void 0===o?void 0:o.code,message:null===(n=i)||void 0===n?void 0:n.code};return null===(c=i)||void 0===c?void 0:c.data[0]}))}querySignProcess(){return this.http.post(`${S.a.apiBasePath}${S.a.endpoints.sign.querySignProcess}`,null)}}return i.\u0275fac=function(t){return new(t||i)(v.Wb(C.b))},i.\u0275prov=v.Ib({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var ct=e("/BtI");let st=(()=>{class i{constructor(){this.step=0}get firstStepClass(){return{completed:this.step>0,active:0===this.step}}get secondStepClass(){return{completed:this.step>1,active:1===this.step}}get thirdStepClass(){return{completed:this.step>2,active:2===this.step}}get lineClass(){return{partial:1===this.step,completed:this.step>1}}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=v.Gb({type:i,selectors:[["app-hire-deposit-status-bar"]],inputs:{step:"step"},decls:26,vars:13,consts:[[1,"status-bar"],[1,"step",3,"ngClass"],[1,"step__circle"],[1,"step__number"],[1,"step__icon","ico-check-2"],[1,"line","partial",3,"ngClass"]],template:function(i,t){1&i&&(v.Sb(0,"div",0),v.Sb(1,"div",1),v.Sb(2,"div",2),v.Sb(3,"span",3),v.Ec(4,"1"),v.Rb(),v.Nb(5,"span",4),v.Rb(),v.Sb(6,"p"),v.Ec(7),v.dc(8,"translate"),v.Rb(),v.Rb(),v.Sb(9,"div",1),v.Sb(10,"div",2),v.Sb(11,"span",3),v.Ec(12,"2"),v.Rb(),v.Nb(13,"span",4),v.Rb(),v.Sb(14,"p"),v.Ec(15),v.dc(16,"translate"),v.Rb(),v.Rb(),v.Sb(17,"div",1),v.Sb(18,"div",2),v.Sb(19,"span",3),v.Ec(20,"3"),v.Rb(),v.Nb(21,"span",4),v.Rb(),v.Sb(22,"p"),v.Ec(23),v.dc(24,"translate"),v.Rb(),v.Rb(),v.Nb(25,"div",5),v.Rb()),2&i&&(v.Ab(1),v.jc("ngClass",t.firstStepClass),v.Ab(6),v.Fc(v.ec(8,7,"deposit_hire_step_one")),v.Ab(2),v.jc("ngClass",t.secondStepClass),v.Ab(6),v.Fc(v.ec(16,9,"deposit_hire_step_two")),v.Ab(2),v.jc("ngClass",t.thirdStepClass),v.Ab(6),v.Fc(v.ec(24,11,"deposit_hire_step_three")),v.Ab(2),v.jc("ngClass",t.lineClass))},directives:[k.n],pipes:[F.d],encapsulation:2,changeDetection:0}),i})();function at(i,t){1&i&&(v.Sb(0,"p",13),v.Nb(1,"span",14),v.Ec(2),v.dc(3,"translate"),v.Rb()),2&i&&(v.Ab(2),v.Gc("",v.ec(3,1,"hire_deposit_must_read_particular_conditions")," "))}const rt=function(i){return{error:i}};let dt=(()=>{class i{constructor(i,t){this.formBuilder=i,this.externalDocuments=t,this.hireDeposit=new v.n,this.submitted=!1,this.readPdf={particularConditions:!1}}ngOnInit(){this.createForm()}onSubmit(){this.submitted=!0,this.form.markAllAsTouched(),this.form.valid&&this.readPdf.particularConditions&&this.hireDeposit.emit()}readParticularConditions(){var i;this.readPdf.particularConditions=!0,null===(i=window)||void 0===i||i.open(this.externalDocuments.particularConditions)}hasError(i){return i.touched&&i.invalid}createForm(){this.form=this.formBuilder.group({particularConditions:[!1,[Ri.r.requiredTrue]]})}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(Ri.c),v.Mb(yi))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-hire-deposit-form"]],inputs:{account:"account"},outputs:{hireDeposit:"hireDeposit"},decls:30,vars:26,consts:[[3,"formGroup","submit"],[1,"group-input"],[1,"input"],[1,"description"],[1,"group-input","input-checkbox"],["type","checkbox","formControlName","particularConditions","id","particularConditions",3,"ngClass"],["for","particularConditions"],["href","javascript:;",3,"click"],[1,"check","ico-check-2"],["class","error-text",4,"ngIf"],[1,"group-button"],["type","submit",1,"btn--primary"],[1,"main__button"],[1,"error-text"],[1,"ico-alert"]],template:function(i,t){1&i&&(v.Sb(0,"form",0),v.ac("submit",(function(){return t.onSubmit()})),v.Sb(1,"div",1),v.Sb(2,"label"),v.Ec(3),v.dc(4,"translate"),v.Rb(),v.Sb(5,"p",2),v.Ec(6),v.dc(7,"formatIban"),v.Rb(),v.Rb(),v.Sb(8,"div",3),v.Sb(9,"label"),v.Ec(10),v.dc(11,"translate"),v.Rb(),v.Rb(),v.Sb(12,"div",4),v.Nb(13,"input",5),v.Sb(14,"label",6),v.Ec(15),v.dc(16,"translate"),v.Sb(17,"a",7),v.ac("click",(function(){return t.readParticularConditions()})),v.Ec(18),v.dc(19,"translate"),v.Rb(),v.Rb(),v.Nb(20,"span",8),v.Cc(21,at,4,3,"p",9),v.Rb(),v.Sb(22,"div",10),v.Sb(23,"button",11),v.Ec(24),v.dc(25,"translate"),v.Rb(),v.Rb(),v.Sb(26,"div",12),v.Sb(27,"button",11),v.Ec(28),v.dc(29,"translate"),v.Rb(),v.Rb(),v.Rb()),2&i&&(v.jc("formGroup",t.form),v.Ab(3),v.Fc(v.ec(4,10,"transfer_sender_account")),v.Ab(3),v.Fc(v.ec(7,12,null==t.account?null:t.account.IBAN)),v.Ab(4),v.Fc(v.ec(11,14,"deposit_hire_conditions_description")),v.Ab(3),v.jc("ngClass",v.nc(24,rt,t.hasError(t.form.get("particularConditions")))),v.Ab(2),v.Gc("",v.ec(16,16,"deposit_hire_conditions_web")," "),v.Ab(3),v.Gc(" ",v.ec(19,18,"deposit_hire_particular_conditions_web"),""),v.Ab(3),v.jc("ngIf",!t.readPdf.particularConditions&&t.submitted),v.Ab(3),v.Gc(" ",v.ec(25,20,"deposit_continue")," "),v.Ab(4),v.Gc(" ",v.ec(29,22,"deposit_continue")," "))},directives:[Ri.s,Ri.o,Ri.g,Ri.a,Ri.n,Ri.f,k.n,k.p],pipes:[F.d,V.a],encapsulation:2}),i})();function lt(i,t){1&i&&(v.Sb(0,"p",13),v.Ec(1),v.dc(2,"translate"),v.Rb()),2&i&&(v.Ab(1),v.Gc(" ",v.ec(2,1,"deposit_hire_loading_contract_response")," "))}function bt(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-hire-deposit-form",14),v.ac("hireDeposit",(function(){return v.wc(i),v.cc(3).onHireDeposit()})),v.Rb()}if(2&i){const i=v.cc(2).ngIf;v.jc("account",i.account)}}function pt(i,t){if(1&i&&(v.Sb(0,"div",2),v.Sb(1,"div",3),v.Sb(2,"div",4),v.Sb(3,"div",5),v.Sb(4,"div",6),v.Sb(5,"div",7),v.Sb(6,"div",8),v.Sb(7,"h1"),v.Ec(8),v.dc(9,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(10,"div",9),v.Cc(11,lt,3,3,"p",10),v.Cc(12,bt,1,1,"app-hire-deposit-form",11),v.Rb(),v.Rb(),v.Sb(13,"div",12),v.Nb(14,"app-hire-deposit-status-bar"),v.Rb(),v.Rb(),v.Rb()),2&i){const i=v.cc(2);v.Ab(8),v.Fc(v.ec(9,3,"deposit_hire_title")),v.Ab(3),v.jc("ngIf",i.isWorking),v.Ab(1),v.jc("ngIf",!i.isWorking)}}function ut(i,t){if(1&i&&(v.Qb(0),v.Cc(1,pt,15,5,"div",1),v.Pb()),2&i){const i=t.ngIf;v.Ab(1),v.jc("ngIf",i.globalPosition)}}let mt=(()=>{class i{constructor(i,t,e,n,c,s,a){this.document=i,this.globalPositionService=t,this.hireDepositService=e,this.errorHandler=n,this.dictionaryService=c,this.activatedRoute=s,this.loadingService=a,this.state$=this.createState(),this.isWorking=!1,this.subs=new o.a}ngOnInit(){this.checkPendingHiring()}ngOnDestroy(){this.subs.unsubscribe()}onHireDeposit(){this.hiringProcess(this.availablePodructId)}checkPendingHiring(){return Object(Qi.a)(this,void 0,void 0,(function*(){const i=this.activatedRoute.snapshot.queryParams.id;if(i)this.availablePodructId=i;else try{this.availablePodructId=yield this.getProductId()}catch(t){this.errorHandler.redirectErrorPage(t)}}))}getProductId(){return Object(Qi.a)(this,void 0,void 0,(function*(){let i=yield this.globalPositionService.pendingHirings().pipe(Object(a.a)(i=>{var t,e,o;return null===(o=null===(e=null===(t=i.data)||void 0===t?void 0:t[0])||void 0===e?void 0:e.RCI_Product__r)||void 0===o?void 0:o.ProductCode})).toPromise();return i||(i=yield this.getProducts().pipe(Object(Wi.a)("externalId")).toPromise()),i}))}createState(){return Object(fi.a)(this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(d.d)())).pipe(Object(a.a)(([i,t])=>({globalPosition:i,account:t})))}hiringProcess(i){this.loadingService.show(),this.isWorking=!0,this.subs.add(this.hireDepositService.newHiring(i).pipe(Object(Vi.a)(this.hireDepositService.getPdfContract()),Object(Vi.a)(this.signDeposit())).pipe(Object(Ji.a)(()=>{this.loadingService.hide(),this.isWorking=!1})).subscribe(i=>{this.handleSignResponse(i)},i=>{this.errorHandler.showError(i)}))}handleSignResponse(i){var t;try{const e=new URL(null===(t=i)||void 0===t?void 0:t.url);this.document.location.href=e.href}catch(e){console.error(e)}}getProducts(){return this.dictionaryService.getProducts().pipe(Object(a.a)(i=>{var t;return null===(t=i.productList)||void 0===t?void 0:t[0]}))}signDeposit(){return this.hireDepositService.querySignProcess().pipe(Object(a.a)(i=>{var t;return null===(t=i)||void 0===t?void 0:t.data}),Object(c.a)(i=>{var t;return!i||0===(null===(t=i)||void 0===t?void 0:t.length)}),Object(Ki.a)(()=>this.hireDepositService.startSignProcessSubmit()),Object(Xi.a)(5e3),Object(Ki.a)(()=>this.hireDepositService.startSignProcessBulkSign().pipe(function(){let i=3;return t=>t.pipe(tt(t=>t.pipe(Object(Ki.a)(t=>{var e;return(null===(e=t)||void 0===e?void 0:e.errorCode)===I.a.KO_RETRY?i-- >0?Object(g.a)(t).pipe(Object(Xi.a)(5e3)):Object(zi.a)({errorCode:"MAX_RETRIES_EXCEEDED"}):(i=5,Object(zi.a)(t))}))))}())))}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(k.e),v.Mb(w.a),v.Mb(nt),v.Mb(A.a),v.Mb(vi.a),v.Mb(P.a),v.Mb(ct.a))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-hire-deposit"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","max-size deposit-form",4,"ngIf"],[1,"max-size","deposit-form"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],["class","info-text",4,"ngIf"],[3,"account","hireDeposit",4,"ngIf"],[1,"aside-col"],[1,"info-text"],[3,"account","hireDeposit"]],template:function(i,t){1&i&&(v.Cc(0,ut,2,1,"ng-container",0),v.dc(1,"async")),2&i&&v.jc("ngIf",v.ec(1,1,t.state$))},directives:[k.p,st,dt],pipes:[k.b,F.d],encapsulation:2}),i})();const ht=function(){return[".."]};function _t(i,t){if(1&i&&(v.Sb(0,"div",5),v.Sb(1,"div",6),v.Sb(2,"div",7),v.Sb(3,"div",8),v.Sb(4,"div",9),v.Sb(5,"div",10),v.Sb(6,"h1"),v.Ec(7),v.dc(8,"translate"),v.Rb(),v.Sb(9,"p"),v.Ec(10),v.dc(11,"formatIban"),v.Rb(),v.Rb(),v.Sb(12,"div",10),v.Sb(13,"p"),v.Ec(14),v.dc(15,"translate"),v.Rb(),v.Sb(16,"h1"),v.Ec(17),v.dc(18,"currency"),v.dc(19,"async"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(20,"div",11),v.Sb(21,"div",12),v.Nb(22,"span",13),v.Sb(23,"h2"),v.Ec(24),v.dc(25,"translate"),v.Rb(),v.Sb(26,"h2"),v.Ec(27),v.dc(28,"translate"),v.Rb(),v.Sb(29,"p"),v.Ec(30),v.dc(31,"translate"),v.Rb(),v.Rb(),v.Sb(32,"button",4),v.Ec(33),v.dc(34,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb()),2&i){const i=v.cc().ngIf,t=v.cc();v.Ab(7),v.Fc(v.ec(8,9,"deposit_cancel_imposition_title")),v.Ab(3),v.Fc(v.ec(11,11,null==i.deposit?null:i.deposit.IBAN)),v.Ab(4),v.Fc(v.ec(15,13,"deposit_cancel_imposition_amount")),v.Ab(3),v.Fc(v.ec(18,15,v.ec(19,17,t.imposition$).importeNominal)),v.Ab(7),v.Fc(v.ec(25,19,"deposit_cancel_impositon_congrats")),v.Ab(3),v.Fc(v.ec(28,21,"deposit_cancel_impositon_success_operation")),v.Ab(3),v.Fc(v.ec(31,23,"deposit_cancel_impositon_success_money")),v.Ab(2),v.jc("routerLink",v.mc(27,ht)),v.Ab(1),v.Gc(" ",v.ec(34,25,"deposit_cancel_impositon_success_button")," ")}}function ft(i,t){if(1&i&&(v.Sb(0,"div",1),v.Cc(1,_t,35,28,"div",2),v.Sb(2,"div",3),v.Sb(3,"button",4),v.Ec(4),v.dc(5,"translate"),v.Rb(),v.Rb(),v.Rb()),2&i){const i=t.ngIf;v.Ab(1),v.jc("ngIf",i.globalPosition),v.Ab(2),v.jc("routerLink",v.mc(5,ht)),v.Ab(1),v.Gc(" ",v.ec(5,3,"deposit_cancel_impositon_success_button")," ")}}const vt=function(){return[".."]},St=["otpModal"];function Rt(i,t){1&i&&(v.Sb(0,"div",4),v.Sb(1,"div",5),v.Sb(2,"div",6),v.Sb(3,"div",7),v.Sb(4,"div",8),v.Sb(5,"div",9),v.Sb(6,"h1"),v.Ec(7),v.dc(8,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(9,"div",10),v.Sb(10,"p",11),v.Ec(11),v.dc(12,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb()),2&i&&(v.Ab(7),v.Fc(v.ec(8,2,"deposit_hire_title")),v.Ab(4),v.Fc(v.ec(12,4,"deposit_hire_loading_sign_response")))}function gt(i,t){if(1&i){const i=v.Tb();v.Sb(0,"div",4),v.Sb(1,"div",5),v.Sb(2,"div",6),v.Sb(3,"div",7),v.Sb(4,"div",8),v.Sb(5,"div",9),v.Sb(6,"h1"),v.Ec(7),v.dc(8,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(9,"div",10),v.Sb(10,"app-new-imposition-form",12),v.ac("makeImposition",(function(t){return v.wc(i),v.cc(2).onMakeImposition(t)})),v.dc(11,"async"),v.Rb(),v.Rb(),v.Rb(),v.Sb(12,"div",13),v.Nb(13,"app-hire-deposit-status-bar",14),v.Rb(),v.Rb()}if(2&i){const i=v.cc().ngIf,t=v.cc();v.Ab(7),v.Fc(v.ec(8,5,"deposit_hire_title")),v.Ab(3),v.jc("account",null==i?null:i.account)("deposit",null==i?null:i.deposit)("impositionConditions",v.ec(11,7,t.impositionConditions$)),v.Ab(3),v.jc("step",2)}}function It(i,t){if(1&i){const i=v.Tb();v.Sb(0,"app-otp-form",15),v.ac("send",(function(t){return v.wc(i),v.cc(2).createImposition(t)}))("repeat",(function(){return v.wc(i),v.cc(2).generateOtp()}))("hide",(function(){return v.wc(i),v.cc(2).closeModal()})),v.Rb()}if(2&i){const i=v.cc(2);v.jc("invalidCode",i.invalidImpositionOtpCode)}}function Ct(i,t){if(1&i&&(v.Qb(0),v.Sb(1,"div",1),v.Cc(2,Rt,13,6,"div",2),v.Cc(3,gt,14,9,"div",2),v.Rb(),v.Cc(4,It,1,1,"ng-template",null,3,v.Dc),v.Pb()),2&i){const i=t.ngIf,e=v.cc();v.Ab(2),v.jc("ngIf",e.isPendingSignResponse),v.Ab(1),v.jc("ngIf",!e.isPendingSignResponse&&e.canMakeFirstImposition&&i.globalPosition)}}const At=function(){return[".."]},Et=[{path:"",component:_i},{path:"new-imposition",component:Ui},{path:"refund-success",component:(()=>{class i{constructor(i,t,e){this.globalPositionService=i,this.activatedRoute=t,this.router=e,this.state$=this.createStateStream(),this.imposition$=this.createImpositionStream()}ngOnInit(){}createStateStream(){return Object(fi.a)(this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(d.e)())).pipe(Object(a.a)(([i,t])=>({globalPosition:i,deposit:t})))}createImpositionStream(){return this.activatedRoute.queryParams.pipe(Object(s.a)(i=>{isNaN(parseFloat(i.importeNominal))&&this.router.navigate([".."],{relativeTo:this.activatedRoute})}))}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(w.a),v.Mb(P.a),v.Mb(P.d))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-success-refund"]],decls:2,vars:3,consts:[["class","max-size deposit",4,"ngIf"],[1,"max-size","deposit"],["class","main",4,"ngIf"],[1,"main__button"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"]],template:function(i,t){1&i&&(v.Cc(0,ft,6,6,"div",0),v.dc(1,"async")),2&i&&v.jc("ngIf",v.ec(1,1,t.state$))},directives:[k.p,P.e],pipes:[k.b,F.d,V.a,k.d],encapsulation:2}),i})()},{path:"new-imposition-success",component:(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=v.Gb({type:i,selectors:[["app-success-new-imposition"]],decls:29,vars:22,consts:[[1,"max-size","deposit"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main__button"]],template:function(i,t){1&i&&(v.Sb(0,"div",0),v.Sb(1,"div",1),v.Sb(2,"div",2),v.Sb(3,"div",3),v.Sb(4,"div",4),v.Sb(5,"div",5),v.Sb(6,"div",6),v.Sb(7,"h1"),v.Ec(8),v.dc(9,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(10,"div",7),v.Sb(11,"div",8),v.Nb(12,"span",9),v.Sb(13,"h2"),v.Ec(14),v.dc(15,"translate"),v.Rb(),v.Sb(16,"h2"),v.Ec(17),v.dc(18,"translate"),v.Rb(),v.Sb(19,"p"),v.Ec(20),v.dc(21,"translate"),v.Rb(),v.Rb(),v.Sb(22,"button",10),v.Ec(23),v.dc(24,"translate"),v.Rb(),v.Sb(25,"div",11),v.Sb(26,"button",10),v.Ec(27),v.dc(28,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb()),2&i&&(v.Ab(8),v.Fc(v.ec(9,8,"deposit_new_imposition_title")),v.Ab(6),v.Fc(v.ec(15,10,"deposit_new_impositon_congrats")),v.Ab(3),v.Fc(v.ec(18,12,"deposit_new_impositon_success_process")),v.Ab(3),v.Fc(v.ec(21,14,"deposit_new_impositon_success_balance")),v.Ab(2),v.jc("routerLink",v.mc(20,vt)),v.Ab(1),v.Gc(" ",v.ec(24,16,"deposit_new_impositon_success_button")," "),v.Ab(3),v.jc("routerLink",v.mc(21,vt)),v.Ab(1),v.Gc(" ",v.ec(28,18,"deposit_new_impositon_success_button")," "))},directives:[P.e],pipes:[F.d],encapsulation:2,changeDetection:0}),i})()},{path:"hire",component:mt},{path:"first-imposition",component:(()=>{class i{constructor(i,t,e,n,c,s){this.modalService=i,this.router=t,this.route=e,this.errorHandler=n,this.impositionService=c,this.depositService=s,this.state$=this.impositionService.state$,this.impositionConditions$=this.impositionService.impositionConditions$,this.isPendingSignResponse=!0,this.canMakeFirstImposition=!1,this.invalidImpositionOtpCode=!1,this.subs=new o.a}ngOnInit(){this.getRequiredDoc()}ngOnDestroy(){this.closeModal(),this.impositionService.destroy(),this.subs.unsubscribe()}openModal(i){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(i))}closeModal(){var i;null===(i=this.modalRef)||void 0===i||i.hide()}getRequiredDoc(){this.subs.add(this.depositService.getRequiredDoc().pipe(Object(a.a)(this.mapInProgressClient),function(){let i=25;return t=>t.pipe(tt(t=>t.pipe(Object(Ki.a)(t=>{var e;return"OB_GET_REQUIRED_DOC_IN_PROGRESS"===(null===(e=t)||void 0===e?void 0:e.errorCode)?i-- >0?Object(g.a)(t).pipe(Object(Xi.a)(7500)):Object(zi.a)({errorCode:"MAX_RETRIES_EXCEEDED"}):(i=5,Object(zi.a)(t))}))))}(),Object(Ji.a)(()=>{this.isPendingSignResponse=!1})).subscribe(()=>{this.impositionService.fetchGlobalPosition(),this.canMakeFirstImposition=!0},i=>{this.errorHandler.showError(i,()=>{this.router.navigate([".."],{relativeTo:this.route})})}))}onMakeImposition(i){this.impositionService.initImposition(i),this.generateOtp()}generateOtp(){this.invalidImpositionOtpCode=!1,this.impositionService.generateOtp(()=>{this.openModal(this.otpModal)},i=>{this.errorHandler.showError(i)})}createImposition(i){this.impositionService.createImposition(i,()=>{this.closeModal(),this.navigateToSuccessPage()},i=>{Object(d.j)(i)?this.invalidImpositionOtpCode=!0:(this.closeModal(),this.errorHandler.showError(i))})}mapInProgressClient(i){if("OB_GET_REQUIRED_DOC_IN_PROGRESS"===i.code)throw{message:"OB_GET_REQUIRED_DOC_IN_PROGRESS",errorCode:"OB_GET_REQUIRED_DOC_IN_PROGRESS"};if("OB_GET_REQUIRED_DOC_NOT_APPROVED"===i.code)throw{message:"OB_GET_REQUIRED_DOC_NOT_APPROVED",errorCode:"OB_GET_REQUIRED_DOC_NOT_APPROVED"};return i}navigateToSuccessPage(){this.router.navigate(["../hire-deposit-success"],{skipLocationChange:!0,relativeTo:this.route})}}return i.\u0275fac=function(t){return new(t||i)(v.Mb(O.b),v.Mb(P.d),v.Mb(P.a),v.Mb(A.a),v.Mb(Si,2),v.Mb(E))},i.\u0275cmp=v.Gb({type:i,selectors:[["app-first-imposition"]],viewQuery:function(i,t){var e;1&i&&v.Ic(St,!0),2&i&&v.sc(e=v.bc())&&(t.otpModal=e.first)},features:[v.zb([Si])],decls:2,vars:3,consts:[[4,"ngIf"],[1,"max-size","deposit-form"],["class","main",4,"ngIf"],["otpModal",""],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"info-text"],[3,"account","deposit","impositionConditions","makeImposition"],[1,"aside-col"],[3,"step"],[3,"invalidCode","send","repeat","hide"]],template:function(i,t){1&i&&(v.Cc(0,Ct,6,2,"ng-container",0),v.dc(1,"async")),2&i&&v.jc("ngIf",v.ec(1,1,t.state$))},directives:[k.p,Bi,st,W.a],pipes:[k.b,F.d],encapsulation:2}),i})()},{path:"hire-deposit-success",component:(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=v.Gb({type:i,selectors:[["app-hire-deposit-success"]],decls:31,vars:23,consts:[[1,"max-size","deposit","deposit-form"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main__button"],[1,"aside-col"],[3,"step"]],template:function(i,t){1&i&&(v.Sb(0,"div",0),v.Sb(1,"div",1),v.Sb(2,"div",2),v.Sb(3,"div",3),v.Sb(4,"div",4),v.Sb(5,"div",5),v.Sb(6,"div",6),v.Sb(7,"h1"),v.Ec(8),v.dc(9,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(10,"div",7),v.Sb(11,"div",8),v.Nb(12,"span",9),v.Sb(13,"h2"),v.Ec(14),v.dc(15,"translate"),v.Rb(),v.Sb(16,"h2"),v.Ec(17),v.dc(18,"translate"),v.Rb(),v.Sb(19,"p"),v.Ec(20),v.dc(21,"translate"),v.Rb(),v.Rb(),v.Sb(22,"button",10),v.Ec(23),v.dc(24,"translate"),v.Rb(),v.Sb(25,"div",11),v.Sb(26,"button",10),v.Ec(27),v.dc(28,"translate"),v.Rb(),v.Rb(),v.Rb(),v.Rb(),v.Sb(29,"div",12),v.Nb(30,"app-hire-deposit-status-bar",13),v.Rb(),v.Rb(),v.Rb()),2&i&&(v.Ab(8),v.Fc(v.ec(9,9,"deposit_hire_title")),v.Ab(6),v.Fc(v.ec(15,11,"deposit_hire_congrats")),v.Ab(3),v.Fc(v.ec(18,13,"deposit_hire_process_success")),v.Ab(3),v.Fc(v.ec(21,15,"deposit_hire_deposit_ready_caption")),v.Ab(2),v.jc("routerLink",v.mc(21,At)),v.Ab(1),v.Gc(" ",v.ec(24,17,"deposit_hire_button_understand")," "),v.Ab(3),v.jc("routerLink",v.mc(22,At)),v.Ab(1),v.Gc(" ",v.ec(28,19,"deposit_hire_button_understand")," "),v.Ab(3),v.jc("step",3))},directives:[P.e,st],pipes:[F.d],encapsulation:2}),i})()}];let yt=(()=>{class i{}return i.\u0275mod=v.Kb({type:i}),i.\u0275inj=v.Jb({factory:function(t){return new(t||i)},imports:[[P.h.forChild(Et)],P.h]}),i})();var wt=e("PCNd");e.d(t,"DepositModule",(function(){return Ot}));let Ot=(()=>{class i{}return i.\u0275mod=v.Kb({type:i}),i.\u0275inj=v.Jb({factory:function(t){return new(t||i)},imports:[[wt.a,yt]]}),i})()}}]);