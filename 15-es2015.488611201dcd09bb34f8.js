(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{VInJ:function(e,t,a){"use strict";a.r(t);var s=a("PCNd"),o=a("ofXK"),r=a("tyNb"),i=a("mrSG"),n=a("9yxR"),c=a("pLZG"),d=a("quSY"),b=a("a+Vh"),l=a("fXoL"),p=a("vHNk"),h=a("K3ix"),u=a("AytR"),m=a("tk/3");let f=(()=>{class e{constructor(e){this.http=e}changePassword(e){return this.http.post(`${u.a.apiBasePath}${u.a.endpoints.passwordRegeneration}`,e)}confirmChangePassword(e){return this.http.put(`${u.a.apiBasePath}${u.a.endpoints.passwordRegeneration}`,e)}}return e.\u0275fac=function(t){return new(t||e)(l.Wb(m.b))},e.\u0275prov=l.Ib({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=a("v98y"),S=a("44PX"),_=a("SLWe"),v=a("3Pt+"),R=a("cZP2"),g=a("iFvM"),P=a("SMdK"),C=a("i9jL"),E=a("sYmb");function A(e,t){if(1&e){const e=l.Tb();l.Sb(0,"div",1),l.Sb(1,"div",2),l.Sb(2,"div",3),l.Sb(3,"p"),l.Ec(4),l.dc(5,"translate"),l.Rb(),l.Rb(),l.Sb(6,"div",3),l.Sb(7,"p"),l.Ec(8),l.dc(9,"titlecase"),l.Rb(),l.Rb(),l.Rb(),l.Sb(10,"div",2),l.Sb(11,"div",3),l.Sb(12,"p"),l.Ec(13),l.dc(14,"translate"),l.Rb(),l.Rb(),l.Sb(15,"div",3),l.Sb(16,"p"),l.Ec(17),l.dc(18,"titlecase"),l.dc(19,"titlecase"),l.Rb(),l.Rb(),l.Rb(),l.Sb(20,"div",2),l.Sb(21,"div",3),l.Sb(22,"p"),l.Ec(23),l.dc(24,"translate"),l.Rb(),l.Rb(),l.Sb(25,"div",3),l.Sb(26,"p"),l.Ec(27),l.Rb(),l.Rb(),l.Rb(),l.Sb(28,"div",2),l.Sb(29,"div",3),l.Sb(30,"p"),l.Ec(31),l.dc(32,"translate"),l.Rb(),l.Rb(),l.Sb(33,"div",3),l.Sb(34,"p"),l.Ec(35),l.dc(36,"titlecase"),l.dc(37,"titlecase"),l.Rb(),l.Rb(),l.Rb(),l.Sb(38,"div",2),l.Sb(39,"div",3),l.Sb(40,"p"),l.Ec(41),l.dc(42,"translate"),l.Rb(),l.Rb(),l.Sb(43,"div",3),l.Sb(44,"p"),l.Ec(45),l.Rb(),l.Rb(),l.Rb(),l.Sb(46,"div",2),l.Sb(47,"div",3),l.Sb(48,"p"),l.Ec(49),l.dc(50,"translate"),l.Rb(),l.Rb(),l.Sb(51,"div",3),l.Sb(52,"p"),l.Ec(53),l.Rb(),l.Rb(),l.Rb(),l.Sb(54,"div",2),l.Sb(55,"div",3),l.Sb(56,"p"),l.Ec(57),l.dc(58,"translate"),l.Rb(),l.Rb(),l.Sb(59,"div",3),l.Sb(60,"p"),l.Ec(61),l.dc(62,"titlecase"),l.Rb(),l.Rb(),l.Rb(),l.Sb(63,"div",2),l.Sb(64,"div",3),l.Sb(65,"p"),l.Ec(66),l.dc(67,"translate"),l.Rb(),l.Rb(),l.Sb(68,"div",3),l.Sb(69,"div",4),l.Sb(70,"p",5),l.Ec(71,"********"),l.Rb(),l.Sb(72,"span",6),l.ac("click",(function(){return l.wc(e),l.cc().changePassword.emit()})),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Rb()}if(2&e){const e=l.cc();l.Ab(4),l.Fc(l.ec(5,17,"profile_name_label")),l.Ab(4),l.Fc(l.ec(9,19,e.customer.name)),l.Ab(5),l.Fc(l.ec(14,21,"profile_lastnames_label")),l.Ab(4),l.Hc("",l.ec(18,23,e.customer.firstSurname)," ",l.ec(19,25,e.customer.secondarySurname),""),l.Ab(6),l.Fc(l.ec(24,27,"profile_dni_label")),l.Ab(4),l.Fc(e.customer.identificationNumber),l.Ab(4),l.Fc(l.ec(32,29,"profile_address_label")),l.Ab(4),l.Hc("",l.ec(36,31,e.addressConcat)," ",l.ec(37,33,e.postalCodeAndLocation),""),l.Ab(6),l.Fc(l.ec(42,35,"profile_phone_label")),l.Ab(4),l.Fc(e.customer.mobilePhone),l.Ab(4),l.Fc(l.ec(50,37,"profile_email_label")),l.Ab(4),l.Fc(e.customer.email),l.Ab(4),l.Fc(l.ec(58,39,"profile_laboral_situation_label")),l.Ab(4),l.Fc(l.ec(62,41,e.getOptionsNameLaboralSituation(e.customer.laboralSituationCode))),l.Ab(5),l.Fc(l.ec(67,43,"profile_password_label"))}}function O(e,t){1&e&&(l.Sb(0,"div",1),l.Sb(1,"div",2),l.Sb(2,"div",3),l.Sb(3,"p"),l.Ec(4,"Los datos del perfil no han podido ser consultados."),l.Rb(),l.Sb(5,"p"),l.Ec(6,"Por favor int\xe9ntelo m\xe1s tarde."),l.Rb(),l.Sb(7,"p"),l.Ec(8,"Disculpe las molestias."),l.Rb(),l.Rb(),l.Rb(),l.Rb())}var y=function(e){return e.TYPE_CASE="typeCase",e.CATEGORY="category",e.COMENTS="coments",e.EMAIL="email",e.PHONE="phone",e.STREET_TYPE="streetType",e.STREET_NAME="streetName",e.STREET_NUMBER="streetNumber",e.PORTAL="portal",e.FLOOR="floor",e.DOOR="door",e.POSTAL_CODE="postalCode",e.LOCATION_CODE="locationCode",e.ADDRESS="address",e.ADDRESS_LOCATION="addressLocation",e.EMPLOYMENT_SITUATION="employmentSituation",e}({});let M=(()=>{class e{constructor(e,t){this.dictionaryService=e,this.streetTypes=t,this.updateChange=new l.n,this.formError=new l.n,this.changePassword=new l.n,this.formCase=R.a,this.employmentSituation=[],this.locationList=[],this.updatePersonalDate=new Object,this.emailValidator=[v.r.required,v.r.pattern(g.b),P.b],this.phoneValidator=[v.r.required,v.r.pattern(g.e),P.b],this.addressValidator=[v.r.required,v.r.pattern(g.g)],this.postalCodeAndLocationValidation=[v.r.required,v.r.pattern(g.c)],this.validationRequired=[v.r.required]}ngOnInit(){this.customer&&(this.setLocationStream(this.customer.postalCode),this.addressConcat=this.concatAddress(),this.concatPostalCodeAndLocation(this.locationList),this.dictionaryService.getEmploymentStatus().subscribe(e=>{this.employmentSituation=e}))}concatAddress(){return`${this.streetTypes.find(e=>e.code===this.customer.streetTypes).name}, ${this.customer.streetName}, ${this.customer.streetNumber}`}setLocationStream(e){this.dictionaryService.getLocation(e).subscribe(e=>{this.locationList=e,this.concatPostalCodeAndLocation(this.locationList)})}concatPostalCodeAndLocation(e){this.postalCodeAndLocation=`${this.customer.postalCode}, ${this.customer.locationName}, ${this.customer.provinceName}`}getOptionsNameLaboralSituation(e){var t;return null===(t=this.employmentSituation.find(t=>t.code===e))||void 0===t?void 0:t.name}saveEditable(e,t){switch(t){case y.ADDRESS:this.addressConcat!==e?this.updatePersonalDate[t]=e:this.updatePersonalDate.hasOwnProperty(t)&&delete this.updatePersonalDate[t];break;case y.ADDRESS_LOCATION:this.postalCodeAndLocation!==e?this.updatePersonalDate[t]=e:this.updatePersonalDate.hasOwnProperty(t)&&delete this.updatePersonalDate[t];break;case y.EMPLOYMENT_SITUATION:this.postalCodeAndLocation!==e?this.updatePersonalDate[t]=this.employmentSituation.find(t=>t.code===e).name:this.updatePersonalDate.hasOwnProperty(t)&&delete this.updatePersonalDate[t];break;default:this.customer[t]!==e?this.updatePersonalDate[t]=e:this.updatePersonalDate.hasOwnProperty(t)&&delete this.updatePersonalDate[t]}this.updateChange.emit(this.updatePersonalDate)}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(C.a),l.Mb(_.f))},e.\u0275cmp=l.Gb({type:e,selectors:[["app-info-personal-data"]],inputs:{formControl:"formControl",customer:"customer"},outputs:{updateChange:"updateChange",formError:"formError",changePassword:"changePassword"},decls:2,vars:2,consts:[["class","tab__personal-data",4,"ngIf"],[1,"tab__personal-data"],[1,"tab__personal-data__row"],[1,"tab__personal-data__col"],[1,"tab__personal-data__edit"],[1,"tab__personal-data__edit__text"],[1,"ico-edit","tab__personal-data__edit__icon",3,"click"]],template:function(e,t){1&e&&(l.Cc(0,A,73,45,"div",0),l.Cc(1,O,9,0,"div",0)),2&e&&(l.jc("ngIf",t.customer),l.Ab(1),l.jc("ngIf",!t.customer))},directives:[o.p],pipes:[E.d,o.w],styles:[""]}),e})(),N=(()=>{class e{constructor(){this.disableCheck=!0}ngOnInit(){}get activeNoCesionEmpNoGrupo(){return"S"===this.customer.indPubliPe}get activeIndPubliPe(){return"N"===this.customer.indNoCesiEmpGrupo}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=l.Gb({type:e,selectors:[["app-data-protection"]],inputs:{customer:"customer"},decls:19,vars:10,consts:[[1,"data-protection"],[1,"data-protection__row"],[1,"switch"],["for","button-2",1,"switch__label"],["for","button-2",1,"switch__button"],["type","checkbox","id","button-2",3,"checked","disabled"],[1,"slider","round"],["for","button-3",1,"switch__label"],["for","button-3",1,"switch__button"],["type","checkbox","id","button-3",3,"checked","disabled"]],template:function(e,t){1&e&&(l.Sb(0,"div",0),l.Sb(1,"div",1),l.Sb(2,"div",2),l.Sb(3,"label",3),l.Sb(4,"p"),l.Ec(5),l.dc(6,"translate"),l.Rb(),l.Rb(),l.Sb(7,"label",4),l.Nb(8,"input",5),l.Nb(9,"span",6),l.Rb(),l.Rb(),l.Rb(),l.Sb(10,"div",1),l.Sb(11,"div",2),l.Sb(12,"label",7),l.Sb(13,"p"),l.Ec(14),l.dc(15,"translate"),l.Rb(),l.Rb(),l.Sb(16,"label",8),l.Nb(17,"input",9),l.Nb(18,"span",6),l.Rb(),l.Rb(),l.Rb(),l.Rb()),2&e&&(l.Ab(5),l.Gc(" ",l.ec(6,6,"profile_agree_offer_products_services")," "),l.Ab(3),l.jc("checked",t.activeNoCesionEmpNoGrupo)("disabled",t.disableCheck),l.Ab(6),l.Gc(" ",l.ec(15,8,"profile_agree_share_my_personal_data")," "),l.Ab(3),l.jc("checked",t.activeIndPubliPe)("disabled",t.disableCheck))},pipes:[E.d],styles:[""]}),e})();const D=function(e){return{error:e}};let T=(()=>{class e{constructor(e){this.formBuilder=e,this.changePassword=new l.n,this.hide=new l.n,this.submitted=!1}ngOnInit(){this.createForm()}onSubmit(){this.submitted=!0,this.form.markAllAsTouched(),this.form.valid&&this.changePassword.emit({password:this.form.value.password,newPassword:this.form.value.newPassword})}hasError(e){return e.touched&&e.invalid}hasMismatchError(){return this.form.get("newPasswordConfirm").touched&&this.form.hasError("mismatch")}createForm(){this.form=this.formBuilder.group({password:["",[v.r.required]],newPassword:["",[v.r.required,v.r.pattern(b.l)]],newPasswordConfirm:["",[v.r.required,v.r.pattern(b.l)]]},{validators:Object(b.k)("newPassword","newPasswordConfirm")})}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(v.c))},e.\u0275cmp=l.Gb({type:e,selectors:[["app-change-password-form"]],outputs:{changePassword:"changePassword",hide:"hide"},decls:26,vars:28,consts:[[1,"max-size-form",3,"formGroup","submit"],[1,"modal__close","ico-close",3,"click"],[1,"modal__title"],[1,"group-input"],["for","password"],["type","password","id","password","formControlName","password","maxlength","8",3,"ngClass"],["for","newPassword"],["type","password","id","newPassword","formControlName","newPassword","minlength","8","maxlength","8",3,"ngClass"],[1,"modal__text-info"],["for","newPasswordConfirm"],["type","password","id","newPasswordConfirm","formControlName","newPasswordConfirm","minlength","8","maxlength","8",3,"ngClass"],["type","submit",1,"modal__btn","btn--primary"]],template:function(e,t){1&e&&(l.Sb(0,"form",0),l.ac("submit",(function(){return t.onSubmit()})),l.Sb(1,"span",1),l.ac("click",(function(){return t.hide.emit()})),l.Rb(),l.Sb(2,"h2",2),l.Ec(3),l.dc(4,"translate"),l.Rb(),l.Sb(5,"div",3),l.Sb(6,"label",4),l.Ec(7),l.dc(8,"translate"),l.Rb(),l.Nb(9,"input",5),l.Rb(),l.Sb(10,"div",3),l.Sb(11,"label",6),l.Ec(12),l.dc(13,"translate"),l.Rb(),l.Nb(14,"input",7),l.Sb(15,"p",8),l.Ec(16),l.dc(17,"translate"),l.Rb(),l.Rb(),l.Sb(18,"div",3),l.Sb(19,"label",9),l.Ec(20),l.dc(21,"translate"),l.Rb(),l.Nb(22,"input",10),l.Rb(),l.Sb(23,"button",11),l.Ec(24),l.dc(25,"translate"),l.Rb(),l.Rb()),2&e&&(l.jc("formGroup",t.form),l.Ab(3),l.Fc(l.ec(4,10,"profile_change_password_title")),l.Ab(4),l.Fc(l.ec(8,12,"profile_change_password_current")),l.Ab(2),l.jc("ngClass",l.nc(22,D,t.hasError(t.form.get("password")))),l.Ab(3),l.Fc(l.ec(13,14,"profile_change_password_new")),l.Ab(2),l.jc("ngClass",l.nc(24,D,t.hasError(t.form.get("newPassword")))),l.Ab(2),l.Fc(l.ec(17,16,"activate_user_password_format")),l.Ab(4),l.Fc(l.ec(21,18,"profile_change_password_confirm")),l.Ab(2),l.jc("ngClass",l.nc(26,D,t.hasError(t.form.get("newPasswordConfirm"))||t.hasMismatchError())),l.Ab(2),l.Gc(" ",l.ec(25,20,"profile_change_password_submit")," "))},directives:[v.s,v.o,v.g,v.b,v.n,v.f,v.i,o.n,v.j],pipes:[E.d],encapsulation:2}),e})();var L=a("zcjR"),j=a("PQaN");const k=["changePasswordModal"],I=["otpModal"],F=["successChangePasswordModal"];function $(e,t){if(1&e){const e=l.Tb();l.Sb(0,"div",4),l.Sb(1,"div",5),l.Sb(2,"div",6),l.Sb(3,"div",7),l.Sb(4,"div",8),l.Sb(5,"div",9),l.Sb(6,"div",10),l.Sb(7,"h1"),l.Ec(8),l.dc(9,"translate"),l.Rb(),l.Sb(10,"p"),l.Ec(11),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Sb(12,"div",11),l.Sb(13,"div",12),l.Sb(14,"div",13),l.Sb(15,"tabset",null,14),l.Sb(17,"tab",15),l.dc(18,"translate"),l.Sb(19,"app-info-personal-data",16),l.ac("changePassword",(function(){return l.wc(e),l.cc().onClickChangePassword()})),l.Rb(),l.Rb(),l.Sb(20,"tab",15),l.dc(21,"translate"),l.Nb(22,"app-data-protection",17),l.Rb(),l.Rb(),l.Sb(23,"p",18),l.Ec(24),l.dc(25,"translate"),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Rb(),l.Rb()}if(2&e){const e=t.ngIf,a=l.cc();l.Ab(8),l.Fc(l.ec(9,7,"profile_title")),l.Ab(3),l.Fc(a.getUsername(e)),l.Ab(6),l.jc("heading",l.ec(18,9,"profile_tab_personal_data")),l.Ab(2),l.jc("customer",e),l.Ab(1),l.jc("heading",l.ec(21,11,"profile_tab_data_protection")),l.Ab(2),l.jc("customer",e),l.Ab(2),l.Fc(l.ec(25,13,"profile_modification_info"))}}function G(e,t){if(1&e){const e=l.Tb();l.Sb(0,"app-change-password-form",19),l.ac("changePassword",(function(t){return l.wc(e),l.cc().onChangePassword(t)}))("hide",(function(){return l.wc(e),l.cc().closeModal()})),l.Rb()}}function x(e,t){if(1&e){const e=l.Tb();l.Sb(0,"app-otp-form",20),l.ac("send",(function(t){return l.wc(e),l.cc().onSendOtp(t)}))("repeat",(function(){return l.wc(e),l.cc().generateOtp()}))("hide",(function(){return l.wc(e),l.cc().closeModal()})),l.Rb()}if(2&e){const e=l.cc();l.jc("invalidCode",e.invalidOtp)}}function q(e,t){if(1&e){const e=l.Tb();l.Sb(0,"app-info-modal",21),l.ac("hide",(function(){return l.wc(e),l.cc().closeModal()})),l.Rb()}}const H=[{path:"",component:(()=>{class e{constructor(e,t,a,s,o){this.headerService=e,this.accountService=t,this.modalService=a,this.passwordService=s,this.errorHandler=o,this.customer$=this.getCustomer(),this.invalidOtp=!1,this.subs=new d.a}ngOnInit(){this.headerService.updateTitle("menu_profile")}openModal(e){this.modalRef=this.modalService.show(e)}closeModal(){this.modalRef&&this.modalRef.hide()}getUsername(e){var t;return`${e.name} ${null===(t=e)||void 0===t?void 0:t.firstSurname} ${e.secondarySurname}`}onClickChangePassword(){this.openModal(this.changePasswordModal)}onChangePassword(e){var t,a;return Object(i.a)(this,void 0,void 0,(function*(){const s=yield Object(b.c)(null===(t=e)||void 0===t?void 0:t.password,b.b,b.a),o=yield Object(b.c)(null===(a=e)||void 0===a?void 0:a.newPassword,b.b,b.a);this.changePasswordData={password:s,newPpassword:o,confirmNewPassword:o},this.closeModal(),this.generateOtp()}))}generateOtp(){this.invalidOtp=!1,this.subs.add(this.passwordService.changePassword(this.changePasswordData).subscribe(({otpId:e})=>{this.changePasswordOtpId=e,this.openModal(this.otpModal)},e=>{this.closeModal(),this.errorHandler.showError(e)}))}onSendOtp(e){this.invalidOtp=!1,this.subs.add(this.passwordService.confirmChangePassword(Object.assign(Object.assign({},this.changePasswordData),{otp:{secretKey:e,reference:this.changePasswordOtpId}})).subscribe(()=>{this.closeModal(),this.openModal(this.successChangePasswordModal)},e=>{Object(b.j)(e)?this.invalidOtp=!0:(this.closeModal(),this.errorHandler.showError(e))}))}getCustomer(){return this.accountService.currentCustomer$.pipe(Object(c.a)(e=>!!e),Object(n.b)())}}return e.\u0275fac=function(t){return new(t||e)(l.Mb(p.a),l.Mb(n.a),l.Mb(h.b),l.Mb(f),l.Mb(w.a))},e.\u0275cmp=l.Gb({type:e,selectors:[["app-personal-data"]],viewQuery:function(e,t){var a;1&e&&(l.Ic(k,!0),l.Ic(I,!0),l.Ic(F,!0)),2&e&&(l.sc(a=l.bc())&&(t.changePasswordModal=a.first),l.sc(a=l.bc())&&(t.otpModal=a.first),l.sc(a=l.bc())&&(t.successChangePasswordModal=a.first))},decls:8,vars:3,consts:[["class","max-size personal-data",4,"ngIf"],["changePasswordModal",""],["otpModal",""],["successChangePasswordModal",""],[1,"max-size","personal-data"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"tabs-block-size"],[1,"tabs-block--desktop"],["staticTabs",""],[3,"heading"],[3,"customer","changePassword"],[3,"customer"],[1,"mt-5"],[3,"changePassword","hide"],[3,"invalidCode","send","repeat","hide"],["head","change_password_success_title","description","change_password_success_desc","type","success",3,"hide"]],template:function(e,t){1&e&&(l.Cc(0,$,26,15,"div",0),l.dc(1,"async"),l.Cc(2,G,1,0,"ng-template",null,1,l.Dc),l.Cc(4,x,1,1,"ng-template",null,2,l.Dc),l.Cc(6,q,1,0,"ng-template",null,3,l.Dc)),2&e&&l.jc("ngIf",l.ec(1,1,t.customer$))},directives:[o.p,S.c,S.a,M,N,T,L.a,j.a],pipes:[o.b,E.d],encapsulation:2}),e})()}];let Y=(()=>{class e{}return e.\u0275mod=l.Kb({type:e}),e.\u0275inj=l.Jb({factory:function(t){return new(t||e)},imports:[[r.h.forChild(H)],r.h]}),e})();a.d(t,"PersonalDataModule",(function(){return K}));let K=(()=>{class e{}return e.\u0275mod=l.Kb({type:e}),e.\u0275inj=l.Jb({factory:function(t){return new(t||e)},imports:[[o.c,Y,s.a]]}),e})()}}]);