function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_unsupportedIterableToArray(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(a):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,n=new Array(e);a<e;a++)n[a]=t[a];return n}function _iterableToArrayLimit(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var a=[],n=!0,r=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(n=(o=c.next()).done)&&(a.push(o.value),!e||a.length!==e);n=!0);}catch(s){r=!0,i=s}finally{try{n||null==c.return||c.return()}finally{if(r)throw i}}return a}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,a){return e&&_defineProperties(t.prototype,e),a&&_defineProperties(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{"M+7o":function(t,e,a){"use strict";a.r(e);var n,r,i=a("PCNd"),o=a("ofXK"),c=a("9yxR"),s=a("pLZG"),l=a("lJxs"),u=a("1uah"),b=a("a+Vh"),d=a("3Pt+"),m=a("wd/R"),f=a("fXoL"),h=a("hzby"),p=a("vHNk"),v=a("wO+i"),_=a("JIr8"),y=a("AytR"),C=a("LRne"),g=a("tk/3"),S=a("v98y"),k=((n=function(){function t(e,a){_classCallCheck(this,t),this.httpClient=e,this.errorHandlerService=a}return _createClass(t,[{key:"checkCorrespondence",value:function(t,e){var a=this;return this.httpClient.get("".concat(y.a.apiBasePath).concat(y.a.endpoints.virtualMailbox.checkCorrespondence,"?since=").concat(t,"&until=").concat(e)).pipe(Object(v.a)("data"),Object(_.a)((function(t){return t.errorCode?Object(C.a)([]):a.errorHandlerService.redirectErrorPage(t)})))}},{key:"getCorrespondence",value:function(t){return this.httpClient.get("".concat(y.a.apiBasePath).concat(y.a.endpoints.virtualMailbox.getCorrespondence,"?visualized=").concat(t.visualizado,"&formcode=").concat(t.codigoFormulario,"&date=").concat(t.fecha,"&documentid=").concat(t.idDocumento,"&account=").concat(t.cuenta,"&externalid=").concat(t.idExterno)).pipe(Object(l.a)((function(t){var e,a;return null===(a=null===(e=t)||void 0===e?void 0:e.data)||void 0===a?void 0:a[0]})))}}]),t}()).\u0275fac=function(t){return new(t||n)(f.Wb(g.b),f.Wb(S.a))},n.\u0275prov=f.Ib({token:n,factory:n.\u0275fac,providedIn:"root"}),n),R=a("44PX"),w=a("quSY"),x=a("OMSe"),A=a("sYmb"),D=((r=function(){function t(e){_classCallCheck(this,t),this.mailboxService=e,this.subs=new w.a}return _createClass(t,[{key:"ngOnInit",value:function(){}},{key:"download",value:function(t){var e=this;this.subs.add(this.mailboxService.getCorrespondence(t).pipe(Object(s.a)((function(t){return!!t})),Object(x.a)()).subscribe((function(t){var a=document.createElement("a");a.href=URL.createObjectURL(t),a.download=e.item.nomDoc,a.click()})))}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe()}}]),t}()).\u0275fac=function(t){return new(t||r)(f.Mb(k))},r.\u0275cmp=f.Gb({type:r,selectors:[["app-mailbox-items"]],inputs:{type:"type",item:"item"},decls:9,vars:7,consts:[[1,"tabs-block--desktop__body__row"],[1,"tabs-block--desktop__body__row__title"],[1,"date"],[1,"name"],[1,"ico-download",3,"click"]],template:function(t,e){1&t&&(f.Sb(0,"div",0),f.Sb(1,"div",1),f.Sb(2,"p",2),f.Ec(3),f.dc(4,"date"),f.Rb(),f.Sb(5,"p",3),f.Ec(6),f.dc(7,"translate"),f.Rb(),f.Sb(8,"span",4),f.ac("click",(function(){return e.download(e.item)})),f.Rb(),f.Rb(),f.Rb()),2&t&&(f.Ab(3),f.Fc(f.fc(4,2,e.item.fecha,"dd/MM/yyyy")),f.Ab(3),f.Fc(f.ec(7,5,e.item.nomDoc)))},pipes:[o.f,A.d],styles:[""]}),r);function j(t,e){1&t&&f.Nb(0,"app-mailbox-items",26),2&t&&f.jc("item",e.$implicit)}function F(t,e){if(1&t&&(f.Sb(0,"div"),f.Cc(1,j,1,1,"app-mailbox-items",25),f.Rb()),2&t){var a=f.cc(2);f.Ab(1),f.jc("ngForOf",a.notifications)}}var T=function(t,e){return{since:t,until:e}};function O(t,e){if(1&t&&(f.Sb(0,"div",27),f.Sb(1,"p"),f.Ec(2),f.dc(3,"translate"),f.Rb(),f.Rb()),2&t){var a=f.cc(2);f.Ab(2),f.Gc(" ",f.fc(3,1,"virtual_mb_mailing_not_found_range_date",f.oc(4,T,a.since,a.until))," ")}}var I=function(){return{dateInputFormat:"DD/MM/YYYY"}},E=function(t){return{error:t}};function M(t,e){if(1&t){var a=f.Tb();f.Sb(0,"div",1),f.Sb(1,"div",2),f.Sb(2,"div",3),f.Sb(3,"div",4),f.Sb(4,"div",5),f.Sb(5,"div",6),f.Sb(6,"div",7),f.Sb(7,"h1"),f.Ec(8),f.dc(9,"translate"),f.Rb(),f.Sb(10,"p"),f.Ec(11),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Sb(12,"div",8),f.Sb(13,"form",9),f.ac("submit",(function(){return f.wc(a),f.cc().searchNotification()})),f.Sb(14,"div",10),f.dc(15,"translate"),f.Sb(16,"label",11),f.Ec(17),f.dc(18,"translate"),f.Rb(),f.Nb(19,"span",12),f.Nb(20,"input",13),f.dc(21,"translate"),f.Rb(),f.Sb(22,"div",10),f.dc(23,"translate"),f.Sb(24,"label",14),f.Ec(25),f.dc(26,"translate"),f.Rb(),f.Nb(27,"span",12),f.Nb(28,"input",15),f.dc(29,"translate"),f.Rb(),f.Sb(30,"div",16),f.Sb(31,"button",17),f.Ec(32),f.dc(33,"translate"),f.Rb(),f.Rb(),f.Sb(34,"div",18),f.Sb(35,"button",19),f.Ec(36),f.dc(37,"translate"),f.Rb(),f.Rb(),f.Rb(),f.Sb(38,"div",20),f.Sb(39,"tabset",null,21),f.Sb(41,"tab",22),f.dc(42,"translate"),f.Cc(43,F,2,1,"div",23),f.Cc(44,O,4,7,"div",24),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb()}if(2&t){var n=e.ngIf,r=f.cc();f.Ab(8),f.Fc(f.ec(9,24,"virtual_mb_title")),f.Ab(3),f.Fc(r.getUsername(null==n?null:n.customer)),f.Ab(2),f.jc("formGroup",r.searchForm),f.Ab(1),f.jc("title",f.ec(15,26,"virtual_mb_range_max_60")),f.Ab(3),f.Fc(f.ec(18,28,"virtual_mb_date_from")),f.Ab(3),f.jc("minDate",r.minDateFrom)("maxDate",r.maxDateFrom)("bsConfig",f.mc(44,I))("placeholder",f.ec(21,30,"dd/mm/aaaa"))("ngClass",f.nc(45,E,r.hasError(r.searchForm.get("since"))))("dateCustomClasses",r.dateCustomClasses),f.Ab(2),f.jc("title",f.ec(23,32,"virtual_mb_range_max_60")),f.Ab(3),f.Fc(f.ec(26,34,"virtual_mb_date_to")),f.Ab(3),f.jc("minDate",r.minDateTo)("maxDate",r.maxDateTo)("bsConfig",f.mc(47,I))("placeholder",f.ec(29,36,"dd/mm/aaaa"))("ngClass",f.nc(48,E,r.hasError(r.searchForm.get("dateTo"))))("dateCustomClasses",r.dateCustomClasses),f.Ab(4),f.Gc(" ",f.ec(33,38,"virtual_mb_btn_search")," "),f.Ab(4),f.Gc(" ",f.ec(37,40,"virtual_mb_btn_search")," "),f.Ab(5),f.jc("heading",f.ec(42,42,"virtual_mb_tab_mailing")),f.Ab(2),f.jc("ngIf",r.notifications.length&&r.showResult),f.Ab(1),f.jc("ngIf",!r.notifications.length&&r.showResult)}}var L,N,P=((L=function(){function t(e,a,n,r,i){_classCallCheck(this,t),this.formBuilder=e,this.bsLocaleService=a,this.headerService=n,this.accountService=r,this.mailboxService=i,this.state$=this.createState(),this.maxDateTo=new Date,this.minDateFrom=new Date(m().subtract(60,"days").format("L")),this.showResult=!1}return _createClass(t,[{key:"ngOnInit",value:function(){this.headerService.updateTitle("menu_mailbox"),this.bsLocaleService.use("es"),this.createForm(),this.searchNotification()}},{key:"getUsername",value:function(t){var e,a,n;return"".concat(null===(e=t)||void 0===e?void 0:e.name," ").concat(null===(a=t)||void 0===a?void 0:a.firstSurname," ").concat(null===(n=t)||void 0===n?void 0:n.secondarySurname)}},{key:"createState",value:function(){return Object(u.a)(this.accountService.currentCustomer$.pipe(Object(s.a)((function(t){return!!t})),Object(c.b)())).pipe(Object(l.a)((function(t){return{customer:_slicedToArray(t,1)[0]}})))}},{key:"createForm",value:function(){var t=new Date(m().subtract(60,"days").format("L")),e=new Date;this.searchForm=this.formBuilder.group({dateFrom:[t,[d.r.required]],dateTo:[e,[d.r.required]]})}},{key:"searchNotification",value:function(){var t=this;this.showResult=!1,this.notifications=this.documents=[],this.since=Object(b.f)(this.f.dateFrom.value),this.until=Object(b.f)(this.f.dateTo.value),this.mailboxService.checkCorrespondence(this.since,this.until).subscribe((function(e){t.showResult=!0,t.notifications=t.documents=e}))}},{key:"hasError",value:function(t){return this.formSubmit&&t.invalid}},{key:"maxDateFrom",get:function(){return this.f.dateTo.value?new Date(this.f.dateTo.value):new Date}},{key:"minDateTo",get:function(){return this.f.dateFrom.value?new Date(this.f.dateFrom.value):new Date(m().subtract(60,"days").format("L"))}},{key:"f",get:function(){return this.searchForm.controls}}]),t}()).\u0275fac=function(t){return new(t||L)(f.Mb(d.c),f.Mb(h.d),f.Mb(p.a),f.Mb(c.a),f.Mb(k))},L.\u0275cmp=f.Gb({type:L,selectors:[["app-virtual-mailbox"]],decls:2,vars:3,consts:[["class","max-size virtual-mailbox",4,"ngIf"],[1,"max-size","virtual-mailbox"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[3,"formGroup","submit"],[1,"group-input","input-text",3,"title"],["for","dateFrom"],[1,"ico-calendary","icon-input","yellow"],["id","dateFrom","type","text","bsDatepicker","","formControlName","dateFrom",3,"minDate","maxDate","bsConfig","placeholder","ngClass","dateCustomClasses"],["for","dateTo"],["id","dateTo","type","text","bsDatepicker","","formControlName","dateTo",3,"minDate","maxDate","bsConfig","placeholder","ngClass","dateCustomClasses"],[1,"group-button"],["type","submit",1,"btn--primary-small"],[1,"main__button"],["type","submit",1,"btn--primary"],[1,"tabs-block--desktop"],["staticTabs",""],[3,"heading"],[4,"ngIf"],["class","tabs-block--desktop__no-data",4,"ngIf"],["type","notification",3,"item",4,"ngFor","ngForOf"],["type","notification",3,"item"],[1,"tabs-block--desktop__no-data"]],template:function(t,e){1&t&&(f.Cc(0,M,45,50,"div",0),f.dc(1,"async")),2&t&&f.jc("ngIf",f.ec(1,1,e.state$))},directives:[o.p,d.s,d.o,d.g,h.b,d.b,h.a,d.n,d.f,o.n,R.c,R.a,o.o,D],pipes:[o.b,A.d],encapsulation:2}),L),G=a("tyNb"),J=[{path:"",component:P}],Y=((N=function t(){_classCallCheck(this,t)}).\u0275mod=f.Kb({type:N}),N.\u0275inj=f.Jb({factory:function(t){return new(t||N)},imports:[[G.h.forChild(J)],G.h]}),N);a.d(e,"VirtualMailboxModule",(function(){return H}));var z,H=((z=function t(){_classCallCheck(this,t)}).\u0275mod=f.Kb({type:z}),z.\u0275inj=f.Jb({factory:function(t){return new(t||z)},imports:[[o.c,Y,i.a]]}),z)}}]);
//# sourceMappingURL=20-es5.dab2887e1e4e1688b897.js.map