function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,a=!1,c=void 0;try{for(var i,o=e[Symbol.iterator]();!(r=(i=o.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(s){a=!0,c=s}finally{try{r||null==o.return||o.return()}finally{if(a)throw c}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{uqTW:function(e,t,n){"use strict";n.r(t);var r,a=n("tyNb"),c=n("quSY"),i=n("itXk"),o=n("dZRt"),s=n("eIep"),b=n("lJxs"),u=n("a+Vh"),l=n("9H/N"),f=n("fXoL"),d=n("vHNk"),p=n("AytR"),m=n("tk/3"),v=((r=function(){function e(t){_classCallCheck(this,e),this.http=t}return _createClass(e,[{key:"simulate",value:function(e){return this.http.post("".concat(p.a.apiBasePath).concat(p.a.endpoints.transfer.simulate),e)}},{key:"otp",value:function(e){return this.http.post("".concat(p.a.apiBasePath).concat(p.a.endpoints.transfer.otp),e)}},{key:"confirm",value:function(e){return this.http.post("".concat(p.a.apiBasePath).concat(p.a.endpoints.transfer.confirm),e)}}]),e}()).\u0275fac=function(e){return new(e||r)(f.Wb(m.b))},r.\u0275prov=f.Ib({token:r,factory:r.\u0275fac,providedIn:"root"}),r),h=n("9yxR"),_=n("v98y"),S=n("K3ix"),y=n("2PZR"),g=n("ofXK"),R=n("0rpK"),A=n("YonX"),E=n("3Pt+");function k(e){var t=Object(o.b)(e.value);return isNaN(t)?{invalidAmount:!0}:t<=0?{minAmountError:!0}:null}var I=n("sYmb"),C=n("tepA");function O(e,t){1&e&&(f.Sb(0,"p",9),f.Nb(1,"span",10),f.Ec(2),f.dc(3,"translate"),f.Rb()),2&e&&(f.Ab(2),f.Gc("",f.ec(3,1,"transfer_balance_error")," "))}function P(e,t){1&e&&(f.Sb(0,"p",9),f.Nb(1,"span",10),f.Ec(2),f.dc(3,"translate"),f.Rb()),2&e&&(f.Ab(2),f.Gc("",f.ec(3,1,"transfer_min_amount_error")," "))}var T,F=function(e){return{error:e}},j=((T=function(){function e(t){_classCallCheck(this,e),this.formBuilder=t,this.submitForm=new f.n,this.submitted=!1}return _createClass(e,[{key:"ngOnInit",value:function(){this.createForm()}},{key:"onSubmit",value:function(){this.submitted=!0,this.form.markAllAsTouched(),this.form.valid&&this.submitForm.emit({amount:this.form.value.amount,concept:this.form.value.concept})}},{key:"hasError",value:function(e){return e.touched&&e.invalid}},{key:"createForm",value:function(){var e;this.form=this.formBuilder.group({amount:["",[E.r.required,(e=this.balance,function(t){var n;return Object(o.b)(null===(n=t)||void 0===n?void 0:n.value)>e?{balanceError:!0}:null}),k]],concept:["",E.r.required]})}},{key:"hasAmountError",get:function(){var e=this.form.get("amount");return this.hasError(e)&&e.hasError("balanceError")}},{key:"hasMinAmountError",get:function(){var e=this.form.get("amount");return this.hasError(e)&&e.hasError("minAmountError")}}]),e}()).\u0275fac=function(e){return new(e||T)(f.Mb(E.c))},T.\u0275cmp=f.Gb({type:T,selectors:[["app-transfer-form"]],inputs:{senderIban:"senderIban",receiverIban:"receiverIban",balance:"balance"},outputs:{submitForm:"submitForm"},decls:42,vars:39,consts:[[3,"formGroup","submit"],[1,"group-input"],[1,"input"],["formControlName","amount","type","text","appParseCurrency","","maxlength","10",3,"ngClass"],["class","error-text",4,"ngIf"],["formControlName","concept","type","text","maxlength","250",3,"ngClass"],[1,"group-button"],["type","submit",1,"btn--primary"],[1,"main__button"],[1,"error-text"],[1,"ico-alert"]],template:function(e,t){1&e&&(f.Sb(0,"form",0),f.ac("submit",(function(){return t.onSubmit()})),f.Sb(1,"div",1),f.Sb(2,"label"),f.Ec(3),f.dc(4,"translate"),f.Rb(),f.Sb(5,"p",2),f.Ec(6),f.dc(7,"formatIban"),f.Rb(),f.Rb(),f.Sb(8,"div",1),f.Sb(9,"label"),f.Ec(10),f.dc(11,"translate"),f.Rb(),f.Sb(12,"p",2),f.Ec(13),f.dc(14,"formatIban"),f.Rb(),f.Rb(),f.Sb(15,"div",1),f.Sb(16,"label"),f.Ec(17),f.dc(18,"translate"),f.Rb(),f.Sb(19,"p",2),f.Ec(20),f.dc(21,"currency"),f.Rb(),f.Rb(),f.Sb(22,"div",1),f.Sb(23,"label"),f.Ec(24),f.dc(25,"translate"),f.Rb(),f.Nb(26,"input",3),f.Cc(27,O,4,3,"p",4),f.Cc(28,P,4,3,"p",4),f.Rb(),f.Sb(29,"div",1),f.Sb(30,"label"),f.Ec(31),f.dc(32,"translate"),f.Rb(),f.Nb(33,"input",5),f.Rb(),f.Sb(34,"div",6),f.Sb(35,"button",7),f.Ec(36),f.dc(37,"translate"),f.Rb(),f.Rb(),f.Sb(38,"div",8),f.Sb(39,"button",7),f.Ec(40),f.dc(41,"translate"),f.Rb(),f.Rb(),f.Rb()),2&e&&(f.jc("formGroup",t.form),f.Ab(3),f.Fc(f.ec(4,15,"transfer_sender_account")),f.Ab(3),f.Fc(f.ec(7,17,t.senderIban)),f.Ab(4),f.Fc(f.ec(11,19,"transfer_receiver_account")),f.Ab(3),f.Fc(f.ec(14,21,t.receiverIban)),f.Ab(4),f.Fc(f.ec(18,23,"transfer_balance")),f.Ab(3),f.Fc(f.ec(21,25,t.balance||0)),f.Ab(4),f.Fc(f.ec(25,27,"transfer_amount")),f.Ab(2),f.jc("ngClass",f.nc(35,F,t.hasError(t.form.get("amount")))),f.Ab(1),f.jc("ngIf",t.hasAmountError),f.Ab(1),f.jc("ngIf",t.hasMinAmountError),f.Ab(3),f.Fc(f.ec(32,29,"transfer_concept")),f.Ab(2),f.jc("ngClass",f.nc(37,F,t.hasError(t.form.get("concept")))),f.Ab(3),f.Fc(f.ec(37,31,"transfer_continue")),f.Ab(4),f.Fc(f.ec(41,33,"transfer_continue")))},directives:[E.s,E.o,E.g,E.b,E.n,E.f,o.a,E.i,g.n,g.p],pipes:[I.d,C.a,g.d],encapsulation:2}),T),w=n("zcjR"),M=["otpModal"];function N(e,t){if(1&e){var n=f.Tb();f.Qb(0),f.Sb(1,"app-transfer-form",15),f.ac("submitForm",(function(e){return f.wc(n),f.cc(3).simulateTranfer(e)})),f.Rb(),f.Pb()}if(2&e){var r=f.cc(2).ngIf;f.Ab(1),f.jc("senderIban",r.account.IBAN)("receiverIban",r.globalPosition.OriginIBAN)("balance",r.account.Balance)}}function B(e,t){if(1&e&&(f.Sb(0,"div",4),f.Sb(1,"div",5),f.Sb(2,"div",6),f.Sb(3,"div",7),f.Sb(4,"div",8),f.Sb(5,"div",9),f.Sb(6,"div",10),f.Sb(7,"h1"),f.Ec(8),f.dc(9,"translate"),f.Rb(),f.Sb(10,"p"),f.Ec(11),f.dc(12,"formatIban"),f.Rb(),f.Rb(),f.Sb(13,"div",10),f.Sb(14,"p"),f.Ec(15),f.dc(16,"translate"),f.Rb(),f.Sb(17,"h1"),f.Ec(18),f.dc(19,"currency"),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Sb(20,"div",11),f.Cc(21,N,2,3,"ng-container",12),f.Rb(),f.Rb(),f.Sb(22,"div",13),f.Nb(23,"app-aside-banner",14),f.Rb(),f.Rb(),f.Rb()),2&e){var n=f.cc().ngIf,r=f.tc(3),a=f.cc();f.Ab(8),f.Fc(f.ec(9,8,"transfer_title")),f.Ab(3),f.Fc(f.ec(12,10,n.account.IBAN)),f.Ab(4),f.Fc(f.ec(16,12,"transfer_balance")),f.Ab(3),f.Fc(f.ec(19,14,n.account.Balance)),f.Ab(3),f.jc("ngIf",!a.simulateOutput)("ngIfElse",r),f.Ab(1),f.jc("appBannerBackground",a.banners.transfer),f.Ab(1),f.jc("globalPosition",n.globalPosition)}}function x(e,t){if(1&e){var n=f.Tb();f.Sb(0,"div",16),f.Sb(1,"div",17),f.Sb(2,"label"),f.Ec(3),f.dc(4,"translate"),f.Rb(),f.Sb(5,"p"),f.Ec(6),f.dc(7,"formatIban"),f.Rb(),f.Rb(),f.Sb(8,"div",17),f.Sb(9,"label"),f.Ec(10),f.dc(11,"translate"),f.Rb(),f.Sb(12,"p"),f.Ec(13),f.dc(14,"formatIban"),f.Rb(),f.Rb(),f.Sb(15,"div",17),f.Sb(16,"label"),f.Ec(17),f.dc(18,"translate"),f.Rb(),f.Sb(19,"p"),f.Ec(20),f.dc(21,"currency"),f.Rb(),f.Rb(),f.Sb(22,"div",17),f.Sb(23,"label"),f.Ec(24),f.dc(25,"translate"),f.Rb(),f.Sb(26,"p"),f.Ec(27),f.Rb(),f.Rb(),f.Sb(28,"div",17),f.Sb(29,"label"),f.Ec(30),f.dc(31,"translate"),f.Rb(),f.Sb(32,"p"),f.Ec(33),f.dc(34,"currency"),f.Rb(),f.Rb(),f.Sb(35,"div",18),f.Sb(36,"button",19),f.ac("click",(function(){return f.wc(n),f.cc(2).generateOtp()})),f.Ec(37),f.dc(38,"translate"),f.Rb(),f.Rb(),f.Sb(39,"div",20),f.Sb(40,"button",19),f.ac("click",(function(){return f.wc(n),f.cc(2).generateOtp()})),f.Ec(41),f.dc(42,"translate"),f.Rb(),f.Rb(),f.Rb()}if(2&e){var r=f.cc().ngIf,a=f.cc();f.Ab(3),f.Fc(f.ec(4,12,"transfer_sender_account")),f.Ab(3),f.Fc(f.ec(7,14,r.account.IBAN)),f.Ab(4),f.Fc(f.ec(11,16,"transfer_receiver_account")),f.Ab(3),f.Fc(f.ec(14,18,r.globalPosition.OriginIBAN)),f.Ab(4),f.Fc(f.ec(18,20,"transfer_amount")),f.Ab(3),f.Fc(f.ec(21,22,null==a.currentTransfer?null:a.currentTransfer.amount)),f.Ab(4),f.Fc(f.ec(25,24,"transfer_concept")),f.Ab(3),f.Fc(null==a.currentTransfer?null:a.currentTransfer.concept),f.Ab(3),f.Fc(f.ec(31,26,"transfer_fee")),f.Ab(3),f.Fc(f.ec(34,28,null==a.simulateOutput?null:a.simulateOutput.fee)),f.Ab(4),f.Gc(" ",f.ec(38,30,"transfer_confirm")," "),f.Ab(4),f.Gc(" ",f.ec(42,32,"transfer_confirm")," ")}}function G(e,t){if(1&e){var n=f.Tb();f.Sb(0,"app-otp-form",21),f.ac("send",(function(e){return f.wc(n),f.cc(2).makeTransfer(e)}))("repeat",(function(){return f.wc(n),f.cc(2).generateOtp()}))("hide",(function(){return f.wc(n),f.cc(2).closeModal()})),f.Rb()}if(2&e){var r=f.cc(2);f.jc("invalidCode",r.invalidOtp)}}function L(e,t){if(1&e&&(f.Qb(0),f.Cc(1,B,24,16,"div",1),f.Cc(2,x,43,34,"ng-template",null,2,f.Dc),f.Cc(4,G,1,1,"ng-template",null,3,f.Dc),f.Pb()),2&e){var n=t.ngIf;f.Ab(1),f.jc("ngIf",(null==n?null:n.globalPosition)&&(null==n?null:n.account))}}var H,$,D,J=function(){return["../../transactions"]},K=[{path:"",component:($=function(){function e(t,n,r,a,i,o,s,b,u){_classCallCheck(this,e),this.headerService=t,this.transferService=n,this.accountService=r,this.errorHandler=a,this.modalService=i,this.globalPositionService=o,this.router=s,this.route=b,this.banners=u,this.state$=this.createState(),this.invalidOtp=!1,this.subs=new c.a}return _createClass(e,[{key:"ngOnInit",value:function(){this.globalPositionService.fetchGlobalPosition(),this.headerService.updateTitle("transfer_title")}},{key:"ngOnDestroy",value:function(){this.subs.unsubscribe(),this.closeModal()}},{key:"openModal",value:function(e){this.modalService.getModalsCount()||(this.modalRef=this.modalService.show(e))}},{key:"closeModal",value:function(){var e;null===(e=this.modalRef)||void 0===e||e.hide()}},{key:"generateOtp",value:function(){var e=this;this.invalidOtp=!1,this.referenceOTP=null,this.subs.add(this.transferService.otp(this.currentTransfer).subscribe((function(t){var n=t.referenceOTP;e.referenceOTP=n,e.openModal(e.otpModal)}),(function(t){e.errorHandler.showError(t)})))}},{key:"simulateTranfer",value:function(e){var t=this,n=e.amount,r=e.concept;this.subs.add(this.state$.pipe(Object(s.a)((function(e){var a,c,i,s,b,u;return t.currentTransfer={amount:Object(o.b)(n).toString(),concept:r,sender:{iban:null===(c=null===(a=e)||void 0===a?void 0:a.account)||void 0===c?void 0:c.IBAN,name:null===(i=e)||void 0===i?void 0:i.customerName},receiver:{iban:null===(b=null===(s=e)||void 0===s?void 0:s.globalPosition)||void 0===b?void 0:b.OriginIBAN,name:null===(u=e)||void 0===u?void 0:u.customerName}},t.transferService.simulate(t.currentTransfer)}))).subscribe((function(e){t.simulateOutput=e}),(function(e){t.errorHandler.showError(e)})))}},{key:"makeTransfer",value:function(e){var t=this;this.subs.add(this.transferService.confirm(Object.assign(Object.assign({},this.currentTransfer),{otp:{keyOTP:e,referenceOTP:this.referenceOTP}})).subscribe((function(){t.navigateTouSuccessPage(),t.closeModal()}),(function(e){Object(u.j)(e)?t.invalidOtp=!0:(t.closeModal(),t.errorHandler.showError(e))})))}},{key:"clearCurrentTranfer",value:function(){this.currentTransfer=null,this.simulateOutput=null}},{key:"getCustomerName",value:function(){return this.accountService.currentCustomer$.pipe(Object(b.a)((function(e){var t,n,r,a;return(null===(t=e)||void 0===t?void 0:t.DatosPersonales)?"".concat(null===(n=e.DatosPersonales)||void 0===n?void 0:n.nombreCliente," ")+"".concat(null===(r=e.DatosPersonales)||void 0===r?void 0:r.apellido1Cliente," ")+"".concat(null===(a=e.DatosPersonales)||void 0===a?void 0:a.apellido2Cliente):""})))}},{key:"createState",value:function(){return Object(i.a)([this.globalPositionService.globalPosition$,this.globalPositionService.globalPosition$.pipe(Object(u.d)()),this.globalPositionService.globalPosition$.pipe(Object(u.e)()),this.getCustomerName()]).pipe(Object(b.a)((function(e){var t=_slicedToArray(e,4);return{globalPosition:t[0],account:t[1],deposit:t[2],customerName:t[3]}})))}},{key:"navigateTouSuccessPage",value:function(){this.router.navigate(["./transfer-success"],{skipLocationChange:!0,relativeTo:this.route})}}]),e}(),$.\u0275fac=function(e){return new(e||$)(f.Mb(d.a),f.Mb(v),f.Mb(h.a),f.Mb(_.a),f.Mb(S.b),f.Mb(y.a),f.Mb(a.d),f.Mb(a.a),f.Mb(l.a))},$.\u0275cmp=f.Gb({type:$,selectors:[["app-transfer"]],viewQuery:function(e,t){var n;1&e&&f.Ic(M,!0),2&e&&f.sc(n=f.bc())&&(t.otpModal=n.first)},decls:2,vars:3,consts:[[4,"ngIf"],["class","max-size transfer",4,"ngIf"],["confirmTransfer",""],["otpModal",""],[1,"max-size","transfer"],[1,"main"],[1,"main-col"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[4,"ngIf","ngIfElse"],[1,"aside-col",3,"appBannerBackground"],[3,"globalPosition"],[3,"senderIban","receiverIban","balance","submitForm"],[1,"confirm-transfer"],[1,"group-input"],[1,"group-button"],[1,"btn--primary",3,"click"],[1,"main__button"],[3,"invalidCode","send","repeat","hide"]],template:function(e,t){1&e&&(f.Cc(0,L,6,1,"ng-container",0),f.dc(1,"async")),2&e&&f.jc("ngIf",f.ec(1,1,t.state$))},directives:[g.p,R.a,A.a,j,w.a],pipes:[g.b,I.d,C.a,g.d],encapsulation:2}),$)},{path:"transfer-success",component:(H=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"ngOnInit",value:function(){}}]),e}(),H.\u0275fac=function(e){return new(e||H)},H.\u0275cmp=f.Gb({type:H,selectors:[["app-success-transfer"]],decls:29,vars:22,consts:[[1,"max-size","deposit"],[1,"main"],[1,"main-col","no-aside"],[1,"main__header"],[1,"main__header__desktop"],[1,"main__header__title"],[1,"main__header__title__col"],[1,"main__body"],[1,"main__body__confirm"],[1,"ico-check-filled"],["type","button",1,"btn--primary",3,"routerLink"],[1,"main__button"]],template:function(e,t){1&e&&(f.Sb(0,"div",0),f.Sb(1,"div",1),f.Sb(2,"div",2),f.Sb(3,"div",3),f.Sb(4,"div",4),f.Sb(5,"div",5),f.Sb(6,"div",6),f.Sb(7,"h1"),f.Ec(8),f.dc(9,"translate"),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Sb(10,"div",7),f.Sb(11,"div",8),f.Nb(12,"span",9),f.Sb(13,"h2"),f.Ec(14),f.dc(15,"translate"),f.Rb(),f.Sb(16,"h2"),f.Ec(17),f.dc(18,"translate"),f.Rb(),f.Sb(19,"p"),f.Ec(20),f.dc(21,"translate"),f.Rb(),f.Rb(),f.Sb(22,"button",10),f.Ec(23),f.dc(24,"translate"),f.Rb(),f.Sb(25,"div",11),f.Sb(26,"button",10),f.Ec(27),f.dc(28,"translate"),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb(),f.Rb()),2&e&&(f.Ab(8),f.Fc(f.ec(9,8,"transfer_title")),f.Ab(6),f.Fc(f.ec(15,10,"transfer_congrats")),f.Ab(3),f.Fc(f.ec(18,12,"transfer_success_process")),f.Ab(3),f.Fc(f.ec(21,14,"transfer_success_balance")),f.Ab(2),f.jc("routerLink",f.mc(20,J)),f.Ab(1),f.Gc(" ",f.ec(24,16,"transfer_success_button")," "),f.Ab(3),f.jc("routerLink",f.mc(21,J)),f.Ab(1),f.Gc(" ",f.ec(28,18,"transfer_success_button")," "))},directives:[a.e],pipes:[I.d],encapsulation:2}),H)}],q=((D=function e(){_classCallCheck(this,e)}).\u0275mod=f.Kb({type:D}),D.\u0275inj=f.Jb({factory:function(e){return new(e||D)},imports:[[a.h.forChild(K)],a.h]}),D),z=n("PCNd");n.d(t,"TransferModule",(function(){return X}));var W,X=((W=function e(){_classCallCheck(this,e)}).\u0275mod=f.Kb({type:W}),W.\u0275inj=f.Jb({factory:function(e){return new(e||W)},imports:[[z.a,q]]}),W)}}]);